<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>576</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    576
                    <a href="575.html">prev</a>
                    <a href="577.html">next</a>
                    <a href="576_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    Freeyourgadget/Gadgetbridge_86392dbf0677f3dd83e41aa2133f6ffdf3d63003_app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;86392dbf0677f3dd83e41aa2133f6ffdf3d63003:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;86392dbf0677f3dd83e41aa2133f6ffdf3d63003^1:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;86392dbf0677f3dd83e41aa2133f6ffdf3d63003^2:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\Freeyourgadget\Gadgetbridge show &quot;16cff936d37bd3ac5ecd1c13879a71550e8f746a:app/src/main/java/nodomain/freeyourgadget/gadgetbridge/GBApplication.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1 /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                 </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2     Gobbetti, Normano64                                                                                  </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18 package nodomain.freeyourgadget.gadgetbridge;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20 import android.annotation.TargetApi;                                                                     </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21 import android.app.Application;                                                                          </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22 import android.app.NotificationManager;                                                                  </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23 import android.app.NotificationManager.Policy;                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25 import android.content.Intent;                                                                           </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26 import android.content.SharedPreferences;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  27 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  28 import android.database.Cursor;                                                                          </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  29 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  30 import android.net.Uri;                                                                                  </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  31 import android.os.Build;                                                                                 </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  32 import android.os.Build.VERSION;                                                                         </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  33 import android.preference.PreferenceManager;                                                             </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  34 import android.provider.ContactsContract.PhoneLookup;                                                    </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  35 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  36 import android.util.Log;                                                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  37 import android.util.TypedValue;                                                                          </span>
<span  style="">  38                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  39 import java.io.File;                                                                                     </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  40 import java.io.IOException;                                                                              </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42 import java.util.List;                                                                                   </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  43 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  44 import java.util.concurrent.locks.Lock;                                                                  </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  45 import java.util.concurrent.locks.ReentrantLock;                                                         </span>
<span  style="">  46                                                                                                          </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="">  47 import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                        </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  48 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  49 import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                           </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  50 import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                       </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  51 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                       </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  52 import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                          </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  53 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  54 import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                        </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  55 import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                          </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  56 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style="">  57 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  58 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style="">  59 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  60 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  61 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style="">  62 =======                                                                                                  </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  63 import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                 </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style="">  64 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  65 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  66 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  67 import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  68 import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                           </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  69 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span  style="">  70                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  71 /**                                                                                                      </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  72  * Main Application class that initializes and provides access to certain things like                    </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  73  * logging and DB access.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  74  */                                                                                                      </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  75 public class GBApplication extends Application {                                                         </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  76     // Since this class must not log to slf4j, we use plain android.util.Log                             </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  77     private static final String TAG = &quot;GBApplication&quot;;                                                   </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  78     public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                           </span>
<span  style="">  79                                                                                                          </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  80     private static GBApplication context;                                                                </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  81     private static final Lock dbLock = new ReentrantLock();                                              </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  82     private static DeviceService deviceService;                                                          </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  83     private static SharedPreferences sharedPrefs;                                                        </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  84     private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                            </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  85     //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  85     //if preferences have to be migrated, increment the following and add the migration logic in migrateP🔵</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  86     private static final int CURRENT_PREFS_VERSION = 2;                                                  </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  87     private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                  </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  88     private static Prefs prefs;                                                                          </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  89     private static GBPrefs gbPrefs;                                                                      </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  90     private static LockHandler lockHandler;                                                              </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  91     /**                                                                                                  </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  92      * Note: is null on Lollipop and Kitkat                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  93      */                                                                                                  </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  94     private static NotificationManager notificationManager;                                              </span>
<span  style="">  95                                                                                                          </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style="">  96     public static final String ACTION_QUIT                                                               </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style="">  97             = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                          </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style="">  98     private static Logging logging = new Logging() {                                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  99         @Override                                                                                        </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style=""> 100         protected String createLogDirectory() throws IOException {                                       </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style=""> 101             File dir = FileUtils.getExternalFilesDir();                                                  </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style=""> 102             return dir.getAbsolutePath();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 104     };                                                                                                   </span>
<span  style=""> 105                                                                                                          </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 106     private DeviceManager deviceManager;                                                                 </span>
<span  style=""> 107                                                                                                          </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 108     public static void quit() {                                                                          </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 109         GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                               </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 110         Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                       </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 111         LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                            </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 112         GBApplication.deviceService().quit();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 113     }                                                                                                    </span>
<span  style=""> 114                                                                                                          </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 115     public GBApplication() {                                                                             </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 116         context = this;                                                                                  </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 117         // don&#x27;t do anything here, add it to onCreate instead                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118     }                                                                                                    </span>
<span  style=""> 119                                                                                                          </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 120     protected DeviceService createDeviceService() {                                                      </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 121         return new GBDeviceService(this);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122     }                                                                                                    </span>
<span  style=""> 123                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 124     @Override                                                                                            </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 125     public void onCreate() {                                                                             </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 126         super.onCreate();                                                                                </span>
<span  style=""> 127                                                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 128         if (lockHandler != null) {                                                                       </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 129             // guard against multiple invocations (robolectric)                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 130             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 131         }                                                                                                </span>
<span  style=""> 132                                                                                                          </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 133         sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                            </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 134         prefs = new Prefs(sharedPrefs);                                                                  </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 135         gbPrefs = new GBPrefs(prefs);                                                                    </span>
<span  style=""> 136                                                                                                          </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 137         // don&#x27;t do anything here before we set up logging, otherwise                                    </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 138         // slf4j may be implicitly initialized before we properly configured it.                         </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 139         setupLogging(isFileLoggingEnabled());                                                            </span>
<span  style=""> 140                                                                                                          </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 141         if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                            </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 142             migratePrefs(getPrefsFileVersion());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 143         }                                                                                                </span>
<span  style=""> 144                                                                                                          </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 145         setupExceptionHandler();                                                                         </span>
<span  style=""> 146                                                                                                          </span>
<span class="7918800930529116607" onmouseenter="enter('7918800930529116607');" onmouseout="out('7918800930529116607');" style=""> 147         GB.environment = GBEnvironment.createDeviceEnvironment();                                        </span>
<span  style=""> 148                                                                                                          </span>
<span class="-2534505263094918300" onmouseenter="enter('-2534505263094918300');" onmouseout="out('-2534505263094918300');" style=""> 149         setupDatabase(this);                                                                             </span>
<span  style=""> 150                                                                                                          </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 151         deviceManager = new DeviceManager(this);                                                         </span>
<span  style=""> 152                                                                                                          </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style=""> 153         createWebViewActivity();                                                                         </span>
<span  style=""> 154                                                                                                          </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 155         deviceService = createDeviceService();                                                           </span>
<span class="7488460081830320754" onmouseenter="enter('7488460081830320754');" onmouseout="out('7488460081830320754');" style=""> 156         loadBlackList();                                                                                 </span>
<span  style=""> 157                                                                                                          </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 158         if (isRunningMarshmallowOrLater()) {                                                             </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""><abbr title=" 159             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);"> 159             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SER🔵</abbr></span>
<span class="-3292367781642785183" onmouseenter="enter('-3292367781642785183');" onmouseout="out('-3292367781642785183');" style=""> 160             //the following will ensure the notification manager is kept alive                           </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 161             startService(new Intent(this, NotificationCollectorMonitorService.class));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163     }                                                                                                    </span>
<span  style=""> 164                                                                                                          </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style=""> 165     private void createWebViewActivity() {                                                               </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style=""> 166         if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                   </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style=""> 167             Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                   </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style=""> 168             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                              </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style=""> 169             startActivity(intent);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171     }                                                                                                    </span>
<span  style=""> 172                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 173     @Override                                                                                            </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 174     public void onTrimMemory(int level) {                                                                </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 175         super.onTrimMemory(level);                                                                       </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 176         if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                           </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 177             if (!hasBusyDevice()) {                                                                      </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 178                 DBHelper.clearSession();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 181     }                                                                                                    </span>
<span  style=""> 182                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 183     /**                                                                                                  </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 184      * Returns true if at least a single device is busy, e.g synchronizing activity data                 </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 185      * or something similar.                                                                             </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 186      * Note: busy is not the same as connected or initialized!                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 187      */                                                                                                  </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 188     private boolean hasBusyDevice() {                                                                    </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 189         List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                        </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 190         for (GBDevice device : devices) {                                                                </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 191             if (device.isBusy()) {                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 192                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 195         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196     }                                                                                                    </span>
<span  style=""> 197                                                                                                          </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 198     public static void setupLogging(boolean enabled) {                                                   </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 199         logging.setupLogging(enabled);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200     }                                                                                                    </span>
<span  style=""> 201                                                                                                          </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 202     private void setupExceptionHandler() {                                                               </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 203         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 203         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionH🔵</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 204         Thread.setDefaultUncaughtExceptionHandler(handler);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205     }                                                                                                    </span>
<span  style=""> 206                                                                                                          </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 207     public static boolean isFileLoggingEnabled() {                                                       </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 208         return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209     }                                                                                                    </span>
<span  style=""> 210                                                                                                          </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 211     public static boolean minimizeNotification() {                                                       </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 212         return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 213     }                                                                                                    </span>
<span  style=""> 214                                                                                                          </span>
<span class="-9123382081525140297" onmouseenter="enter('-9123382081525140297');" onmouseout="out('-9123382081525140297');" style=""> 215     static void setupDatabase(Context context) {                                                         </span>
<span class="495848848502583738" onmouseenter="enter('495848848502583738');" onmouseout="out('495848848502583738');" style=""> 216         DBOpenHelper helper = new DBOpenHelper(context, DATABASE_NAME, null);                            </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 217         SQLiteDatabase db = helper.getWritableDatabase();                                                </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 218         DaoMaster daoMaster = new DaoMaster(db);                                                         </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 219         if (lockHandler == null) {                                                                       </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 220             lockHandler = new LockHandler();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221         }                                                                                                </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 222         lockHandler.init(daoMaster, helper);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 223     }                                                                                                    </span>
<span  style=""> 224                                                                                                          </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 225     public static Context getContext() {                                                                 </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 226         return context;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 227     }                                                                                                    </span>
<span  style=""> 228                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 229     /**                                                                                                  </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 230      * Returns the facade for talking to devices. Devices are managed by                                 </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 231      * an Android Service and this facade provides access to its functionality.                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 232      *                                                                                                   </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 233      * @return the facade for talking to the service/devices.                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 234      */                                                                                                  </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 235     public static DeviceService deviceService() {                                                        </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 236         return deviceService;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 237     }                                                                                                    </span>
<span  style=""> 238                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 239     /**                                                                                                  </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 240      * Returns the DBHandler instance for reading/writing or throws GBException                          </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 241      * when that was not successful                                                                      </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 242      * If acquiring was successful, callers must call #releaseDB when they                               </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 243      * are done (from the same thread that acquired the lock!                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 244      * &lt;p&gt;                                                                                               </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 245      * Callers must not hold a reference to the returned instance because it                             </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 246      * will be invalidated at some point.                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 247      *                                                                                                   </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 248      * @return the DBHandler                                                                             </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 249      * @throws GBException                                                                               </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 250      * @see #releaseDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 251      */                                                                                                  </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 252     public static DBHandler acquireDB() throws GBException {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 253         try {                                                                                            </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 254             if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                  </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 255                 return lockHandler;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 256             }                                                                                            </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 257         } catch (InterruptedException ex) {                                                              </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 258             Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 259         }                                                                                                </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 260         throw new GBException(&quot;Unable to access the database.&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261     }                                                                                                    </span>
<span  style=""> 262                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 263     /**                                                                                                  </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 264      * Releases the database lock.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 265      *                                                                                                   </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 266      * @throws IllegalMonitorStateException if the current thread is not owning the lock                 </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 267      * @see #acquireDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 268      */                                                                                                  </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 269     public static void releaseDB() {                                                                     </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 270         dbLock.unlock();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 271     }                                                                                                    </span>
<span  style=""> 272                                                                                                          </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 273     public static boolean isRunningLollipopOrLater() {                                                   </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 274         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 275     }                                                                                                    </span>
<span  style=""> 276                                                                                                          </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 277     public static boolean isRunningMarshmallowOrLater() {                                                </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 278         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 279     }                                                                                                    </span>
<span  style=""> 280                                                                                                          </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 281     private static boolean isPrioritySender(int prioritySenders, String number) {                        </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 282         if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 283             return true;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 284         } else {                                                                                         </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 285             Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));          </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 286             String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                    </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 287             Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);       </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 288             boolean exists = false;                                                                      </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 289             int starred = 0;                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 290             try {                                                                                        </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 291                 if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                            </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 292                     exists = true;                                                                       </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 293                     starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 294                 }                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 295             } finally {                                                                                  </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 296                 if (cursor != null) {                                                                    </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 297                     cursor.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 299             }                                                                                            </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 300             if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 301                 return true;                                                                             </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 302             } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 303                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304             }                                                                                            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 305             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 307     }                                                                                                    </span>
<span  style=""> 308                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 309     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 310     public static boolean isPriorityNumber(int priorityType, String number) {                            </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 311         NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();     </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 312         if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                         </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 313             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 313             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRI🔵</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 314                 return isPrioritySender(notificationPolicy.priorityMessageSenders, number);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 315             }                                                                                            </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 316         } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                     </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 317             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 317             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORI🔵</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 318                 return isPrioritySender(notificationPolicy.priorityCallSenders, number);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 319             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 321         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322     }                                                                                                    </span>
<span  style=""> 323                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 324     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 325     public static int getGrantedInterruptionFilter() {                                                   </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""><abbr title=" 326         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {"> 326         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()🔵</abbr></span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 327             if (notificationManager.isNotificationPolicyAccessGranted()) {                               </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 328                 return notificationManager.getCurrentInterruptionFilter();                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 329             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 330         }                                                                                                </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 331         return NotificationManager.INTERRUPTION_FILTER_ALL;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332     }                                                                                                    </span>
<span  style=""> 333                                                                                                          </span>
<span class="504195764522846272" onmouseenter="enter('504195764522846272');" onmouseout="out('504195764522846272');" style=""> 334     public static HashSet&lt;String&gt; blacklist = null;                                                      </span>
<span  style=""> 335                                                                                                          </span>
<span class="3136809427715779853" onmouseenter="enter('3136809427715779853');" onmouseout="out('3136809427715779853');" style=""> 336     private static void loadBlackList() {                                                                </span>
<span class="-4165545423449523865" onmouseenter="enter('-4165545423449523865');" onmouseout="out('-4165545423449523865');" style=""> 337         blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(&quot;package_blacklist&quot;, null);               </span>
<span class="3710122947239011739" onmouseenter="enter('3710122947239011739');" onmouseout="out('3710122947239011739');" style=""> 338         if (blacklist == null) {                                                                         </span>
<span class="8704968985872011996" onmouseenter="enter('8704968985872011996');" onmouseout="out('8704968985872011996');" style=""> 339             blacklist = new HashSet&lt;&gt;();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 341     }                                                                                                    </span>
<span  style=""> 342                                                                                                          </span>
<span class="-481433286634482934" onmouseenter="enter('-481433286634482934');" onmouseout="out('-481433286634482934');" style=""> 343     private static void saveBlackList() {                                                                </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 344         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="4373063490515338158" onmouseenter="enter('4373063490515338158');" onmouseout="out('4373063490515338158');" style=""> 345         if (blacklist.isEmpty()) {                                                                       </span>
<span class="-7033385367321024850" onmouseenter="enter('-7033385367321024850');" onmouseout="out('-7033385367321024850');" style=""> 346             editor.putStringSet(&quot;package_blacklist&quot;, null);                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 347         } else {                                                                                         </span>
<span class="3909103545192669113" onmouseenter="enter('3909103545192669113');" onmouseout="out('3909103545192669113');" style=""> 348             editor.putStringSet(&quot;package_blacklist&quot;, blacklist);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 350         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351     }                                                                                                    </span>
<span  style=""> 352                                                                                                          </span>
<span class="-2779319696285586872" onmouseenter="enter('-2779319696285586872');" onmouseout="out('-2779319696285586872');" style=""> 353     public static void addToBlacklist(String packageName) {                                              </span>
<span class="-1871256217611316970" onmouseenter="enter('-1871256217611316970');" onmouseout="out('-1871256217611316970');" style=""> 354         if (!blacklist.contains(packageName)) {                                                          </span>
<span class="1292536329989809753" onmouseenter="enter('1292536329989809753');" onmouseout="out('1292536329989809753');" style=""> 355             blacklist.add(packageName);                                                                  </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 356             saveBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 358     }                                                                                                    </span>
<span  style=""> 359                                                                                                          </span>
<span class="616928146830467939" onmouseenter="enter('616928146830467939');" onmouseout="out('616928146830467939');" style=""> 360     public static synchronized void removeFromBlacklist(String packageName) {                            </span>
<span class="-8340158867305867611" onmouseenter="enter('-8340158867305867611');" onmouseout="out('-8340158867305867611');" style=""> 361         blacklist.remove(packageName);                                                                   </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 362         saveBlackList();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 363     }                                                                                                    </span>
<span  style=""> 364                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 365     /**                                                                                                  </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 366      * Deletes both the old Activity database and the new one recreates it with empty tables.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 367      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 368      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 369      */                                                                                                  </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 370     public static synchronized boolean deleteActivityDatabase(Context context) {                         </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 371         // TODO: flush, close, reopen db                                                                 </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 372         if (lockHandler != null) {                                                                       </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 373             lockHandler.closeDb();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374         }                                                                                                </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 375         boolean result = deleteOldActivityDatabase(context);                                             </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 376         result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                            </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 377         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 378     }                                                                                                    </span>
<span  style=""> 379                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 380     /**                                                                                                  </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 381      * Deletes the legacy (pre 0.12) Activity database                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 382      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 383      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 384      */                                                                                                  </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 385     public static synchronized boolean deleteOldActivityDatabase(Context context) {                      </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 386         DBHelper dbHelper = new DBHelper(context);                                                       </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 387         boolean result = true;                                                                           </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 388         if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                     </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 389             result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 390         }                                                                                                </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 391         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392     }                                                                                                    </span>
<span  style=""> 393                                                                                                          </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 394     private int getPrefsFileVersion() {                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 395         try {                                                                                            </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 396             return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 397         } catch (Exception e) {                                                                          </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 398             //in version 1 this was an int                                                               </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 399             return 1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 400         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401     }                                                                                                    </span>
<span  style=""> 402                                                                                                          </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 403     private void migratePrefs(int oldVersion) {                                                          </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 404         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 405         switch (oldVersion) {                                                                            </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 406             case 0:                                                                                      </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 407                 String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                     </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 408                 String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                  </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 409                 String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                  </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 410                 String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                 </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 411                 if (legacyGender != null) {                                                              </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 412                     int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;</span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 413                     editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));           </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 414                     editor.remove(&quot;mi_user_gender&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 415                 }                                                                                        </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 416                 if (legacyHeight != null) {                                                              </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 417                     editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                    </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 418                     editor.remove(&quot;mi_user_height_cm&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419                 }                                                                                        </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 420                 if (legacyWeigth != null) {                                                              </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 421                     editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                    </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 422                     editor.remove(&quot;mi_user_weight_kg&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 423                 }                                                                                        </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 424                 if (legacyYOB != null) {                                                                 </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 425                     editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                   </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 426                     editor.remove(&quot;mi_user_year_of_birth&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 427                 }                                                                                        </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 428                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 429                 break;                                                                                   </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 430             case 1:                                                                                      </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 431                 //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 431                 //migrate the integer version of gender introduced in version 1 to a string value, needed🔵</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 432                 int legacyGender_1 = 2;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 433                 try {                                                                                    </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 434                     legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 435                 } catch (Exception e) {                                                                  </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 436                     Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 437                 }                                                                                        </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 438                 editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));       </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 439                 //also silently migrate the version to a string value                                    </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 440                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 441                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 443         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 444     }                                                                                                    </span>
<span  style=""> 445                                                                                                          </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 446     public static LimitedQueue getIDSenderLookup() {                                                     </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 447         return mIDSenderLookup;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448     }                                                                                                    </span>
<span  style=""> 449                                                                                                          </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 450     public static boolean isDarkThemeEnabled() {                                                         </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 451         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 451         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equa🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452     }                                                                                                    </span>
<span  style=""> 453                                                                                                          </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 454     public static int getTextColor(Context context) {                                                    </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 455         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 456         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 457         theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                               </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 458         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 459     }                                                                                                    </span>
<span  style=""> 460                                                                                                          </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 461     public static int getBackgroundColor(Context context) {                                              </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 462         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 463         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 464         theme.resolveAttribute(android.R.attr.background, typedValue, true);                             </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 465         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 466     }                                                                                                    </span>
<span  style=""> 467                                                                                                          </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 468     public static Prefs getPrefs() {                                                                     </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 469         return prefs;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470     }                                                                                                    </span>
<span  style=""> 471                                                                                                          </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 472     public static GBPrefs getGBPrefs() {                                                                 </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 473         return gbPrefs;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 474     }                                                                                                    </span>
<span  style=""> 475                                                                                                          </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 476     public DeviceManager getDeviceManager() {                                                            </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 477         return deviceManager;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 478     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 479 }                                                                                                        </span></pre></td>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1 /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                 </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2     Gobbetti, Normano64                                                                                  </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18 package nodomain.freeyourgadget.gadgetbridge;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20 import android.annotation.TargetApi;                                                                     </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21 import android.app.Application;                                                                          </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22 import android.app.NotificationManager;                                                                  </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23 import android.app.NotificationManager.Policy;                                                           </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25 import android.content.Intent;                                                                           </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26 import android.content.SharedPreferences;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  27 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  28 import android.database.Cursor;                                                                          </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  29 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  30 import android.net.Uri;                                                                                  </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  31 import android.os.Build;                                                                                 </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  32 import android.os.Build.VERSION;                                                                         </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  33 import android.preference.PreferenceManager;                                                             </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  34 import android.provider.ContactsContract.PhoneLookup;                                                    </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  35 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  36 import android.util.Log;                                                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  37 import android.util.TypedValue;                                                                          </span>
<span  style="">  38                                                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  39 import java.io.File;                                                                                     </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  40 import java.io.IOException;                                                                              </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42 import java.util.List;                                                                                   </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  43 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  44 import java.util.concurrent.locks.Lock;                                                                  </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  45 import java.util.concurrent.locks.ReentrantLock;                                                         </span>
<span  style="">  46                                                                                                          </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="">  47 import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                        </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  48 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  49 import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                           </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  50 import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                       </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  51 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                       </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  52 import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                          </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  53 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  54 import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                        </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  55 import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                          </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  56 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  57 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                 </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  61 import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  62 import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                           </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  63 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span  style="">  64                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  65 /**                                                                                                      </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  66  * Main Application class that initializes and provides access to certain things like                    </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  67  * logging and DB access.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  68  */                                                                                                      </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  69 public class GBApplication extends Application {                                                         </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  70     // Since this class must not log to slf4j, we use plain android.util.Log                             </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  71     private static final String TAG = &quot;GBApplication&quot;;                                                   </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  72     public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                           </span>
<span  style="">  73                                                                                                          </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  74     private static GBApplication context;                                                                </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  75     private static final Lock dbLock = new ReentrantLock();                                              </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  76     private static DeviceService deviceService;                                                          </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  77     private static SharedPreferences sharedPrefs;                                                        </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  78     private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                            </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  79     //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  79     //if preferences have to be migrated, increment the following and add the migration logic in migrateP🔵</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  80     private static final int CURRENT_PREFS_VERSION = 2;                                                  </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  81     private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                  </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  82     private static Prefs prefs;                                                                          </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  83     private static GBPrefs gbPrefs;                                                                      </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  84     private static LockHandler lockHandler;                                                              </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  85     /**                                                                                                  </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  86      * Note: is null on Lollipop and Kitkat                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  87      */                                                                                                  </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  88     private static NotificationManager notificationManager;                                              </span>
<span  style="">  89                                                                                                          </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style="">  90     public static final String ACTION_QUIT                                                               </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style="">  91             = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                          </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style="">  92     private static Logging logging = new Logging() {                                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  93         @Override                                                                                        </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style="">  94         protected String createLogDirectory() throws IOException {                                       </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style="">  95             File dir = FileUtils.getExternalFilesDir();                                                  </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style="">  96             return dir.getAbsolutePath();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="">  98     };                                                                                                   </span>
<span  style="">  99                                                                                                          </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 100     private DeviceManager deviceManager;                                                                 </span>
<span  style=""> 101                                                                                                          </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 102     public static void quit() {                                                                          </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 103         GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                               </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 104         Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                       </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 105         LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                            </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 106         GBApplication.deviceService().quit();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 107     }                                                                                                    </span>
<span  style=""> 108                                                                                                          </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 109     public GBApplication() {                                                                             </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 110         context = this;                                                                                  </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 111         // don&#x27;t do anything here, add it to onCreate instead                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 112     }                                                                                                    </span>
<span  style=""> 113                                                                                                          </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 114     protected DeviceService createDeviceService() {                                                      </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 115         return new GBDeviceService(this);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 116     }                                                                                                    </span>
<span  style=""> 117                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 118     @Override                                                                                            </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 119     public void onCreate() {                                                                             </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 120         super.onCreate();                                                                                </span>
<span  style=""> 121                                                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 122         if (lockHandler != null) {                                                                       </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 123             // guard against multiple invocations (robolectric)                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 124             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125         }                                                                                                </span>
<span  style=""> 126                                                                                                          </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 127         sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                            </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 128         prefs = new Prefs(sharedPrefs);                                                                  </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 129         gbPrefs = new GBPrefs(prefs);                                                                    </span>
<span  style=""> 130                                                                                                          </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 131         // don&#x27;t do anything here before we set up logging, otherwise                                    </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 132         // slf4j may be implicitly initialized before we properly configured it.                         </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 133         setupLogging(isFileLoggingEnabled());                                                            </span>
<span  style=""> 134                                                                                                          </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 135         if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                            </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 136             migratePrefs(getPrefsFileVersion());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137         }                                                                                                </span>
<span  style=""> 138                                                                                                          </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 139         setupExceptionHandler();                                                                         </span>
<span  style=""> 140                                                                                                          </span>
<span class="7918800930529116607" onmouseenter="enter('7918800930529116607');" onmouseout="out('7918800930529116607');" style=""> 141         GB.environment = GBEnvironment.createDeviceEnvironment();                                        </span>
<span  style=""> 142                                                                                                          </span>
<span class="-2534505263094918300" onmouseenter="enter('-2534505263094918300');" onmouseout="out('-2534505263094918300');" style=""> 143         setupDatabase(this);                                                                             </span>
<span  style=""> 144                                                                                                          </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 145         deviceManager = new DeviceManager(this);                                                         </span>
<span  style=""> 146                                                                                                          </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style=""> 147         createWebViewActivity();                                                                         </span>
<span  style=""> 148                                                                                                          </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 149         deviceService = createDeviceService();                                                           </span>
<span class="7488460081830320754" onmouseenter="enter('7488460081830320754');" onmouseout="out('7488460081830320754');" style=""> 150         loadBlackList();                                                                                 </span>
<span  style=""> 151                                                                                                          </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 152         if (isRunningMarshmallowOrLater()) {                                                             </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""><abbr title=" 153             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);"> 153             notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SER🔵</abbr></span>
<span class="-3292367781642785183" onmouseenter="enter('-3292367781642785183');" onmouseout="out('-3292367781642785183');" style=""> 154             //the following will ensure the notification manager is kept alive                           </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 155             startService(new Intent(this, NotificationCollectorMonitorService.class));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style=""> 159     private void createWebViewActivity() {                                                               </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style=""> 160         if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                   </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style=""> 161             Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                   </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style=""> 162             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                              </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style=""> 163             startActivity(intent);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165     }                                                                                                    </span>
<span  style=""> 166                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 167     @Override                                                                                            </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 168     public void onTrimMemory(int level) {                                                                </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 169         super.onTrimMemory(level);                                                                       </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 170         if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                           </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 171             if (!hasBusyDevice()) {                                                                      </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 172                 DBHelper.clearSession();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175     }                                                                                                    </span>
<span  style=""> 176                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 177     /**                                                                                                  </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 178      * Returns true if at least a single device is busy, e.g synchronizing activity data                 </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 179      * or something similar.                                                                             </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 180      * Note: busy is not the same as connected or initialized!                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 181      */                                                                                                  </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 182     private boolean hasBusyDevice() {                                                                    </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 183         List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                        </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 184         for (GBDevice device : devices) {                                                                </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 185             if (device.isBusy()) {                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 186                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 189         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190     }                                                                                                    </span>
<span  style=""> 191                                                                                                          </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 192     public static void setupLogging(boolean enabled) {                                                   </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 193         logging.setupLogging(enabled);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 196     private void setupExceptionHandler() {                                                               </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 197         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 197         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionH🔵</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 198         Thread.setDefaultUncaughtExceptionHandler(handler);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 201     public static boolean isFileLoggingEnabled() {                                                       </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 202         return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203     }                                                                                                    </span>
<span  style=""> 204                                                                                                          </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 205     public static boolean minimizeNotification() {                                                       </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 206         return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="-9123382081525140297" onmouseenter="enter('-9123382081525140297');" onmouseout="out('-9123382081525140297');" style=""> 209     static void setupDatabase(Context context) {                                                         </span>
<span class="495848848502583738" onmouseenter="enter('495848848502583738');" onmouseout="out('495848848502583738');" style=""> 210         DBOpenHelper helper = new DBOpenHelper(context, DATABASE_NAME, null);                            </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 211         SQLiteDatabase db = helper.getWritableDatabase();                                                </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 212         DaoMaster daoMaster = new DaoMaster(db);                                                         </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 213         if (lockHandler == null) {                                                                       </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 214             lockHandler = new LockHandler();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215         }                                                                                                </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 216         lockHandler.init(daoMaster, helper);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217     }                                                                                                    </span>
<span  style=""> 218                                                                                                          </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 219     public static Context getContext() {                                                                 </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 220         return context;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221     }                                                                                                    </span>
<span  style=""> 222                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 223     /**                                                                                                  </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 224      * Returns the facade for talking to devices. Devices are managed by                                 </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 225      * an Android Service and this facade provides access to its functionality.                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 226      *                                                                                                   </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 227      * @return the facade for talking to the service/devices.                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 228      */                                                                                                  </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 229     public static DeviceService deviceService() {                                                        </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 230         return deviceService;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231     }                                                                                                    </span>
<span  style=""> 232                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 233     /**                                                                                                  </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 234      * Returns the DBHandler instance for reading/writing or throws GBException                          </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 235      * when that was not successful                                                                      </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 236      * If acquiring was successful, callers must call #releaseDB when they                               </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 237      * are done (from the same thread that acquired the lock!                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 238      * &lt;p&gt;                                                                                               </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 239      * Callers must not hold a reference to the returned instance because it                             </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 240      * will be invalidated at some point.                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 241      *                                                                                                   </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 242      * @return the DBHandler                                                                             </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 243      * @throws GBException                                                                               </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 244      * @see #releaseDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 245      */                                                                                                  </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 246     public static DBHandler acquireDB() throws GBException {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 247         try {                                                                                            </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 248             if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                  </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 249                 return lockHandler;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250             }                                                                                            </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 251         } catch (InterruptedException ex) {                                                              </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 252             Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253         }                                                                                                </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 254         throw new GBException(&quot;Unable to access the database.&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255     }                                                                                                    </span>
<span  style=""> 256                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 257     /**                                                                                                  </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 258      * Releases the database lock.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 259      *                                                                                                   </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 260      * @throws IllegalMonitorStateException if the current thread is not owning the lock                 </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 261      * @see #acquireDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 262      */                                                                                                  </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 263     public static void releaseDB() {                                                                     </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 264         dbLock.unlock();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265     }                                                                                                    </span>
<span  style=""> 266                                                                                                          </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 267     public static boolean isRunningLollipopOrLater() {                                                   </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 268         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269     }                                                                                                    </span>
<span  style=""> 270                                                                                                          </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 271     public static boolean isRunningMarshmallowOrLater() {                                                </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 272         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 275     private static boolean isPrioritySender(int prioritySenders, String number) {                        </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 276         if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 277             return true;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 278         } else {                                                                                         </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 279             Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));          </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 280             String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                    </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 281             Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);       </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 282             boolean exists = false;                                                                      </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 283             int starred = 0;                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 284             try {                                                                                        </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 285                 if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                            </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 286                     exists = true;                                                                       </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 287                     starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288                 }                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 289             } finally {                                                                                  </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 290                 if (cursor != null) {                                                                    </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 291                     cursor.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293             }                                                                                            </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 294             if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 295                 return true;                                                                             </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 296             } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 297                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298             }                                                                                            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 299             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 303     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 304     public static boolean isPriorityNumber(int priorityType, String number) {                            </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 305         NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();     </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 306         if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                         </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 307             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 307             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRI🔵</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 308                 return isPrioritySender(notificationPolicy.priorityMessageSenders, number);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309             }                                                                                            </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 310         } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                     </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 311             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 311             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORI🔵</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 312                 return isPrioritySender(notificationPolicy.priorityCallSenders, number);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 315         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 318     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 319     public static int getGrantedInterruptionFilter() {                                                   </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""><abbr title=" 320         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {"> 320         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()🔵</abbr></span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 321             if (notificationManager.isNotificationPolicyAccessGranted()) {                               </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 322                 return notificationManager.getCurrentInterruptionFilter();                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324         }                                                                                                </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 325         return NotificationManager.INTERRUPTION_FILTER_ALL;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326     }                                                                                                    </span>
<span  style=""> 327                                                                                                          </span>
<span class="504195764522846272" onmouseenter="enter('504195764522846272');" onmouseout="out('504195764522846272');" style=""> 328     public static HashSet&lt;String&gt; blacklist = null;                                                      </span>
<span  style=""> 329                                                                                                          </span>
<span class="3136809427715779853" onmouseenter="enter('3136809427715779853');" onmouseout="out('3136809427715779853');" style=""> 330     private static void loadBlackList() {                                                                </span>
<span class="-4165545423449523865" onmouseenter="enter('-4165545423449523865');" onmouseout="out('-4165545423449523865');" style=""> 331         blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(&quot;package_blacklist&quot;, null);               </span>
<span class="3710122947239011739" onmouseenter="enter('3710122947239011739');" onmouseout="out('3710122947239011739');" style=""> 332         if (blacklist == null) {                                                                         </span>
<span class="8704968985872011996" onmouseenter="enter('8704968985872011996');" onmouseout="out('8704968985872011996');" style=""> 333             blacklist = new HashSet&lt;&gt;();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335     }                                                                                                    </span>
<span  style=""> 336                                                                                                          </span>
<span class="-481433286634482934" onmouseenter="enter('-481433286634482934');" onmouseout="out('-481433286634482934');" style=""> 337     private static void saveBlackList() {                                                                </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 338         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="4373063490515338158" onmouseenter="enter('4373063490515338158');" onmouseout="out('4373063490515338158');" style=""> 339         if (blacklist.isEmpty()) {                                                                       </span>
<span class="-7033385367321024850" onmouseenter="enter('-7033385367321024850');" onmouseout="out('-7033385367321024850');" style=""> 340             editor.putStringSet(&quot;package_blacklist&quot;, null);                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 341         } else {                                                                                         </span>
<span class="3909103545192669113" onmouseenter="enter('3909103545192669113');" onmouseout="out('3909103545192669113');" style=""> 342             editor.putStringSet(&quot;package_blacklist&quot;, blacklist);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 344         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345     }                                                                                                    </span>
<span  style=""> 346                                                                                                          </span>
<span class="-2779319696285586872" onmouseenter="enter('-2779319696285586872');" onmouseout="out('-2779319696285586872');" style=""> 347     public static void addToBlacklist(String packageName) {                                              </span>
<span class="-1871256217611316970" onmouseenter="enter('-1871256217611316970');" onmouseout="out('-1871256217611316970');" style=""> 348         if (!blacklist.contains(packageName)) {                                                          </span>
<span class="1292536329989809753" onmouseenter="enter('1292536329989809753');" onmouseout="out('1292536329989809753');" style=""> 349             blacklist.add(packageName);                                                                  </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 350             saveBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352     }                                                                                                    </span>
<span  style=""> 353                                                                                                          </span>
<span class="616928146830467939" onmouseenter="enter('616928146830467939');" onmouseout="out('616928146830467939');" style=""> 354     public static synchronized void removeFromBlacklist(String packageName) {                            </span>
<span class="-8340158867305867611" onmouseenter="enter('-8340158867305867611');" onmouseout="out('-8340158867305867611');" style=""> 355         blacklist.remove(packageName);                                                                   </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 356         saveBlackList();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357     }                                                                                                    </span>
<span  style=""> 358                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 359     /**                                                                                                  </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 360      * Deletes both the old Activity database and the new one recreates it with empty tables.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 361      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 362      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 363      */                                                                                                  </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 364     public static synchronized boolean deleteActivityDatabase(Context context) {                         </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 365         // TODO: flush, close, reopen db                                                                 </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 366         if (lockHandler != null) {                                                                       </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 367             lockHandler.closeDb();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368         }                                                                                                </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 369         boolean result = deleteOldActivityDatabase(context);                                             </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 370         result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                            </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 371         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372     }                                                                                                    </span>
<span  style=""> 373                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 374     /**                                                                                                  </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 375      * Deletes the legacy (pre 0.12) Activity database                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 376      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 377      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 378      */                                                                                                  </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 379     public static synchronized boolean deleteOldActivityDatabase(Context context) {                      </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 380         DBHelper dbHelper = new DBHelper(context);                                                       </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 381         boolean result = true;                                                                           </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 382         if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                     </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 383             result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384         }                                                                                                </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 385         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386     }                                                                                                    </span>
<span  style=""> 387                                                                                                          </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 388     private int getPrefsFileVersion() {                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 389         try {                                                                                            </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 390             return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 391         } catch (Exception e) {                                                                          </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 392             //in version 1 this was an int                                                               </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 393             return 1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395     }                                                                                                    </span>
<span  style=""> 396                                                                                                          </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 397     private void migratePrefs(int oldVersion) {                                                          </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 398         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 399         switch (oldVersion) {                                                                            </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 400             case 0:                                                                                      </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 401                 String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                     </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 402                 String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                  </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 403                 String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                  </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 404                 String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                 </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 405                 if (legacyGender != null) {                                                              </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 406                     int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;</span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 407                     editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));           </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 408                     editor.remove(&quot;mi_user_gender&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                 }                                                                                        </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 410                 if (legacyHeight != null) {                                                              </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 411                     editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                    </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 412                     editor.remove(&quot;mi_user_height_cm&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413                 }                                                                                        </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 414                 if (legacyWeigth != null) {                                                              </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 415                     editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                    </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 416                     editor.remove(&quot;mi_user_weight_kg&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417                 }                                                                                        </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 418                 if (legacyYOB != null) {                                                                 </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 419                     editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                   </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 420                     editor.remove(&quot;mi_user_year_of_birth&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421                 }                                                                                        </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 422                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 423                 break;                                                                                   </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 424             case 1:                                                                                      </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 425                 //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 425                 //migrate the integer version of gender introduced in version 1 to a string value, needed🔵</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 426                 int legacyGender_1 = 2;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 427                 try {                                                                                    </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 428                     legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 429                 } catch (Exception e) {                                                                  </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 430                     Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431                 }                                                                                        </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 432                 editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));       </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 433                 //also silently migrate the version to a string value                                    </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 434                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 435                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 437         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438     }                                                                                                    </span>
<span  style=""> 439                                                                                                          </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 440     public static LimitedQueue getIDSenderLookup() {                                                     </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 441         return mIDSenderLookup;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442     }                                                                                                    </span>
<span  style=""> 443                                                                                                          </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 444     public static boolean isDarkThemeEnabled() {                                                         </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 445         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 445         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equa🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446     }                                                                                                    </span>
<span  style=""> 447                                                                                                          </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 448     public static int getTextColor(Context context) {                                                    </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 449         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 450         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 451         theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                               </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 452         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453     }                                                                                                    </span>
<span  style=""> 454                                                                                                          </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 455     public static int getBackgroundColor(Context context) {                                              </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 456         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 457         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 458         theme.resolveAttribute(android.R.attr.background, typedValue, true);                             </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 459         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460     }                                                                                                    </span>
<span  style=""> 461                                                                                                          </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 462     public static Prefs getPrefs() {                                                                     </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 463         return prefs;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464     }                                                                                                    </span>
<span  style=""> 465                                                                                                          </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 466     public static GBPrefs getGBPrefs() {                                                                 </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 467         return gbPrefs;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468     }                                                                                                    </span>
<span  style=""> 469                                                                                                          </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 470     public DeviceManager getDeviceManager() {                                                            </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 471         return deviceManager;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473 }                                                                                                        </span>




</pre></td>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1 /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                 </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2     Gobbetti, Normano64                                                                                  </span>
<span  style="">   3                                                                                                          </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4     This file is part of Gadgetbridge.                                                                   </span>
<span  style="">   5                                                                                                          </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6     Gadgetbridge is free software: you can redistribute it and/or modify                                 </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7     it under the terms of the GNU Affero General Public License as published                             </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8     by the Free Software Foundation, either version 3 of the License, or                                 </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9     (at your option) any later version.                                                                  </span>
<span  style="">  10                                                                                                          </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11     Gadgetbridge is distributed in the hope that it will be useful,                                      </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12     but WITHOUT ANY WARRANTY; without even the implied warranty of                                       </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                        </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14     GNU Affero General Public License for more details.                                                  </span>
<span  style="">  15                                                                                                          </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16     You should have received a copy of the GNU Affero General Public License                             </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                             </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18 package nodomain.freeyourgadget.gadgetbridge;                                                            </span>
<span  style="">  19                                                                                                          </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20 import android.annotation.TargetApi;                                                                     </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21 import android.app.Application;                                                                          </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  22 import android.app.NotificationManager.Policy;                                                           </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  23 import android.app.NotificationManager;                                                                  </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24 import android.content.Context;                                                                          </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25 import android.content.Intent;                                                                           </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26 import android.content.SharedPreferences;                                                                </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  27 import android.content.res.Resources;                                                                    </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  28 import android.database.Cursor;                                                                          </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  29 import android.database.sqlite.SQLiteDatabase;                                                           </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  30 import android.net.Uri;                                                                                  </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  31 import android.os.Build.VERSION;                                                                         </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  32 import android.os.Build;                                                                                 </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  33 import android.preference.PreferenceManager;                                                             </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  34 import android.provider.ContactsContract.PhoneLookup;                                                    </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  35 import android.support.v4.content.LocalBroadcastManager;                                                 </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  36 import android.util.Log;                                                                                 </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  37 import android.util.TypedValue;                                                                          </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  38 import java.io.File;                                                                                     </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  39 import java.io.IOException;                                                                              </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  40 import java.util.HashSet;                                                                                </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  41 import java.util.List;                                                                                   </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  42 import java.util.concurrent.TimeUnit;                                                                    </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  43 import java.util.concurrent.locks.Lock;                                                                  </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  44 import java.util.concurrent.locks.ReentrantLock;                                                         </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="">  45 import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                        </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  46 import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                          </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  47 import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                           </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  48 import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                       </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  49 import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                       </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  50 import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                          </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  51 import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                               </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  52 import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                        </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  53 import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                          </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  54 import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                         </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="">  55 import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                 </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="">  56 import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                           </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  57 import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                              </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  58 import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                     </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  59 import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  60 import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                           </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  61 import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                  </span>
<span  style="">  62                                                                                                          </span>
<span  style="">  63                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64 /**                                                                                                      </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  65  * Main Application class that initializes and provides access to certain things like                    </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  66  * logging and DB access.                                                                                </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  67  */                                                                                                      </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  68 public class GBApplication extends Application {                                                         </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  69     // Since this class must not log to slf4j, we use plain android.util.Log                             </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  70     private static final String TAG = &quot;GBApplication&quot;;                                                   </span>
<span  style="">  71                                                                                                          </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  72     public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                           </span>
<span  style="">  73                                                                                                          </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  74     private static GBApplication context;                                                                </span>
<span  style="">  75                                                                                                          </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  76     private static final Lock dbLock = new ReentrantLock();                                              </span>
<span  style="">  77                                                                                                          </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  78     private static DeviceService deviceService;                                                          </span>
<span  style="">  79                                                                                                          </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  80     private static SharedPreferences sharedPrefs;                                                        </span>
<span  style="">  81                                                                                                          </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  82     private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                            </span>
<span  style="">  83                                                                                                          </span>
<span class="-7201596570557629566" onmouseenter="enter('-7201596570557629566');" onmouseout="out('-7201596570557629566');" style=""><abbr title="  84     // if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  84     // if preferences have to be migrated, increment the following and add the migration logic in migrate🔵</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  85     private static final int CURRENT_PREFS_VERSION = 2;                                                  </span>
<span  style="">  86                                                                                                          </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  87     private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                  </span>
<span  style="">  88                                                                                                          </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  89     private static Prefs prefs;                                                                          </span>
<span  style="">  90                                                                                                          </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  91     private static GBPrefs gbPrefs;                                                                      </span>
<span  style="">  92                                                                                                          </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  93     private static LockHandler lockHandler;                                                              </span>
<span  style="">  94                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  95     /**                                                                                                  </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  96      * Note: is null on Lollipop and Kitkat                                                              </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  97      */                                                                                                  </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  98     private static NotificationManager notificationManager;                                              </span>
<span  style="">  99                                                                                                          </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style=""> 100     public static final String ACTION_QUIT                                                               </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style=""> 101             = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                          </span>
<span  style=""> 102                                                                                                          </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style=""> 103     private static Logging logging = new Logging() {                                                     </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 104         @Override                                                                                        </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style=""> 105         protected String createLogDirectory() throws IOException {                                       </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style=""> 106             File dir = FileUtils.getExternalFilesDir();                                                  </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style=""> 107             return dir.getAbsolutePath();                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 108         }                                                                                                </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style=""> 109     };                                                                                                   </span>
<span  style=""> 110                                                                                                          </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style=""> 111     private DeviceManager deviceManager;                                                                 </span>
<span  style=""> 112                                                                                                          </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 113     public static void quit() {                                                                          </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 114         GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                               </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 115         Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                       </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 116         LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                            </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 117         GBApplication.deviceService().quit();                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 118     }                                                                                                    </span>
<span  style=""> 119                                                                                                          </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 120     public GBApplication() {                                                                             </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 121         context = this;                                                                                  </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 122         // don&#x27;t do anything here, add it to onCreate instead                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123     }                                                                                                    </span>
<span  style=""> 124                                                                                                          </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 125     protected DeviceService createDeviceService() {                                                      </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 126         return new GBDeviceService(this);                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 127     }                                                                                                    </span>
<span  style=""> 128                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 129     @Override                                                                                            </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 130     public void onCreate() {                                                                             </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 131         super.onCreate();                                                                                </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 132         if (lockHandler != null) {                                                                       </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 133             // guard against multiple invocations (robolectric)                                          </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 134             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135         }                                                                                                </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 136         sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                            </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 137         prefs = new Prefs(sharedPrefs);                                                                  </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 138         gbPrefs = new GBPrefs(prefs);                                                                    </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 139         // don&#x27;t do anything here before we set up logging, otherwise                                    </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 140         // slf4j may be implicitly initialized before we properly configured it.                         </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 141         setupLogging(isFileLoggingEnabled());                                                            </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 142         if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                            </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 143             migratePrefs(getPrefsFileVersion());                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 144         }                                                                                                </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 145         setupExceptionHandler();                                                                         </span>
<span class="7918800930529116607" onmouseenter="enter('7918800930529116607');" onmouseout="out('7918800930529116607');" style=""> 146         GB.environment = GBEnvironment.createDeviceEnvironment();                                        </span>
<span class="-2534505263094918300" onmouseenter="enter('-2534505263094918300');" onmouseout="out('-2534505263094918300');" style=""> 147         setupDatabase(this);                                                                             </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 148         deviceManager = new DeviceManager(this);                                                         </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style=""> 149         createWebViewActivity();                                                                         </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 150         deviceService = createDeviceService();                                                           </span>
<span class="7488460081830320754" onmouseenter="enter('7488460081830320754');" onmouseout="out('7488460081830320754');" style=""> 151         loadBlackList();                                                                                 </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 152         if (isRunningMarshmallowOrLater()) {                                                             </span>
<span class="-1786981645580945754" onmouseenter="enter('-1786981645580945754');" onmouseout="out('-1786981645580945754');" style=""><abbr title=" 153             notificationManager = ((NotificationManager) (context.getSystemService(Context.NOTIFICATION_SERVICE)));"> 153             notificationManager = ((NotificationManager) (context.getSystemService(Context.NOTIFICATION_S🔵</abbr></span>
<span class="8967845918777711559" onmouseenter="enter('8967845918777711559');" onmouseout="out('8967845918777711559');" style=""> 154             // the following will ensure the notification manager is kept alive                          </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style=""> 155             startService(new Intent(this, NotificationCollectorMonitorService.class));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 157     }                                                                                                    </span>
<span  style=""> 158                                                                                                          </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style=""> 159     private void createWebViewActivity() {                                                               </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style=""> 160         if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                   </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style=""> 161             Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                   </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style=""> 162             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                              </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style=""> 163             startActivity(intent);                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165     }                                                                                                    </span>
<span  style=""> 166                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 167     @Override                                                                                            </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 168     public void onTrimMemory(int level) {                                                                </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 169         super.onTrimMemory(level);                                                                       </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 170         if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                           </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 171             if (!hasBusyDevice()) {                                                                      </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 172                 DBHelper.clearSession();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 173             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175     }                                                                                                    </span>
<span  style=""> 176                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 177     /**                                                                                                  </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 178      * Returns true if at least a single device is busy, e.g synchronizing activity data                 </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 179      * or something similar.                                                                             </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 180      * Note: busy is not the same as connected or initialized!                                           </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 181      */                                                                                                  </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 182     private boolean hasBusyDevice() {                                                                    </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 183         List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                        </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 184         for (GBDevice device : devices) {                                                                </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 185             if (device.isBusy()) {                                                                       </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 186                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 189         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190     }                                                                                                    </span>
<span  style=""> 191                                                                                                          </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 192     public static void setupLogging(boolean enabled) {                                                   </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 193         logging.setupLogging(enabled);                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 194     }                                                                                                    </span>
<span  style=""> 195                                                                                                          </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 196     private void setupExceptionHandler() {                                                               </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 197         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 197         LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionH🔵</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 198         Thread.setDefaultUncaughtExceptionHandler(handler);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199     }                                                                                                    </span>
<span  style=""> 200                                                                                                          </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 201     public static boolean isFileLoggingEnabled() {                                                       </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 202         return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203     }                                                                                                    </span>
<span  style=""> 204                                                                                                          </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 205     public static boolean minimizeNotification() {                                                       </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 206         return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 207     }                                                                                                    </span>
<span  style=""> 208                                                                                                          </span>
<span class="-9123382081525140297" onmouseenter="enter('-9123382081525140297');" onmouseout="out('-9123382081525140297');" style=""> 209     static void setupDatabase(Context context) {                                                         </span>
<span class="495848848502583738" onmouseenter="enter('495848848502583738');" onmouseout="out('495848848502583738');" style=""> 210         DBOpenHelper helper = new DBOpenHelper(context, DATABASE_NAME, null);                            </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 211         SQLiteDatabase db = helper.getWritableDatabase();                                                </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 212         DaoMaster daoMaster = new DaoMaster(db);                                                         </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 213         if (lockHandler == null) {                                                                       </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 214             lockHandler = new LockHandler();                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 215         }                                                                                                </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 216         lockHandler.init(daoMaster, helper);                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 217     }                                                                                                    </span>
<span  style=""> 218                                                                                                          </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 219     public static Context getContext() {                                                                 </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 220         return context;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 221     }                                                                                                    </span>
<span  style=""> 222                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 223     /**                                                                                                  </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 224      * Returns the facade for talking to devices. Devices are managed by                                 </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 225      * an Android Service and this facade provides access to its functionality.                          </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 226      *                                                                                                   </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 227      * @return the facade for talking to the service/devices.                                            </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 228      */                                                                                                  </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 229     public static DeviceService deviceService() {                                                        </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 230         return deviceService;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 231     }                                                                                                    </span>
<span  style=""> 232                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 233     /**                                                                                                  </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 234      * Returns the DBHandler instance for reading/writing or throws GBException                          </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 235      * when that was not successful                                                                      </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 236      * If acquiring was successful, callers must call #releaseDB when they                               </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 237      * are done (from the same thread that acquired the lock!                                            </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 238      * &lt;p&gt;                                                                                               </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 239      * Callers must not hold a reference to the returned instance because it                             </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 240      * will be invalidated at some point.                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 241      *                                                                                                   </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 242      * @return the DBHandler                                                                             </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 243      * @throws GBException                                                                               </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 244      * @see #releaseDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 245      */                                                                                                  </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 246     public static DBHandler acquireDB() throws GBException {                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 247         try {                                                                                            </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 248             if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                  </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 249                 return lockHandler;                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250             }                                                                                            </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 251         } catch (InterruptedException ex) {                                                              </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 252             Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253         }                                                                                                </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 254         throw new GBException(&quot;Unable to access the database.&quot;);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 255     }                                                                                                    </span>
<span  style=""> 256                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 257     /**                                                                                                  </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 258      * Releases the database lock.                                                                       </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 259      *                                                                                                   </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 260      * @throws IllegalMonitorStateException if the current thread is not owning the lock                 </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 261      * @see #acquireDB()                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 262      */                                                                                                  </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 263     public static void releaseDB() {                                                                     </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 264         dbLock.unlock();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 265     }                                                                                                    </span>
<span  style=""> 266                                                                                                          </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 267     public static boolean isRunningLollipopOrLater() {                                                   </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 268         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 269     }                                                                                                    </span>
<span  style=""> 270                                                                                                          </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 271     public static boolean isRunningMarshmallowOrLater() {                                                </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 272         return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 273     }                                                                                                    </span>
<span  style=""> 274                                                                                                          </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 275     private static boolean isPrioritySender(int prioritySenders, String number) {                        </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 276         if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                            </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 277             return true;                                                                                 </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 278         } else {                                                                                         </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 279             Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));          </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 280             String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                    </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 281             Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);       </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 282             boolean exists = false;                                                                      </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 283             int starred = 0;                                                                             </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 284             try {                                                                                        </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 285                 if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                            </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 286                     exists = true;                                                                       </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 287                     starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288                 }                                                                                        </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 289             } finally {                                                                                  </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 290                 if (cursor != null) {                                                                    </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 291                     cursor.close();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 292                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 293             }                                                                                            </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 294             if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                         </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 295                 return true;                                                                             </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 296             } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {             </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 297                 return true;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298             }                                                                                            </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 299             return false;                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 300         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301     }                                                                                                    </span>
<span  style=""> 302                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 303     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 304     public static boolean isPriorityNumber(int priorityType, String number) {                            </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 305         NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();     </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 306         if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                         </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 307             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 307             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRI🔵</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 308                 return isPrioritySender(notificationPolicy.priorityMessageSenders, number);              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 309             }                                                                                            </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 310         } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                     </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 311             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 311             if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORI🔵</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 312                 return isPrioritySender(notificationPolicy.priorityCallSenders, number);                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314         }                                                                                                </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 315         return false;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 316     }                                                                                                    </span>
<span  style=""> 317                                                                                                          </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 318     @TargetApi(Build.VERSION_CODES.M)                                                                    </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 319     public static int getGrantedInterruptionFilter() {                                                   </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""><abbr title=" 320         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {"> 320         if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()🔵</abbr></span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 321             if (notificationManager.isNotificationPolicyAccessGranted()) {                               </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 322                 return notificationManager.getCurrentInterruptionFilter();                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323             }                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 324         }                                                                                                </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 325         return NotificationManager.INTERRUPTION_FILTER_ALL;                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 326     }                                                                                                    </span>
<span  style=""> 327                                                                                                          </span>
<span class="504195764522846272" onmouseenter="enter('504195764522846272');" onmouseout="out('504195764522846272');" style=""> 328     public static HashSet&lt;String&gt; blacklist = null;                                                      </span>
<span  style=""> 329                                                                                                          </span>
<span class="3136809427715779853" onmouseenter="enter('3136809427715779853');" onmouseout="out('3136809427715779853');" style=""> 330     private static void loadBlackList() {                                                                </span>
<span class="-4165545423449523865" onmouseenter="enter('-4165545423449523865');" onmouseout="out('-4165545423449523865');" style=""> 331         blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(&quot;package_blacklist&quot;, null);               </span>
<span class="3710122947239011739" onmouseenter="enter('3710122947239011739');" onmouseout="out('3710122947239011739');" style=""> 332         if (blacklist == null) {                                                                         </span>
<span class="8704968985872011996" onmouseenter="enter('8704968985872011996');" onmouseout="out('8704968985872011996');" style=""> 333             blacklist = new HashSet&lt;&gt;();                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 334         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 335     }                                                                                                    </span>
<span  style=""> 336                                                                                                          </span>
<span class="-481433286634482934" onmouseenter="enter('-481433286634482934');" onmouseout="out('-481433286634482934');" style=""> 337     private static void saveBlackList() {                                                                </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 338         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="4373063490515338158" onmouseenter="enter('4373063490515338158');" onmouseout="out('4373063490515338158');" style=""> 339         if (blacklist.isEmpty()) {                                                                       </span>
<span class="-7033385367321024850" onmouseenter="enter('-7033385367321024850');" onmouseout="out('-7033385367321024850');" style=""> 340             editor.putStringSet(&quot;package_blacklist&quot;, null);                                              </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 341         } else {                                                                                         </span>
<span class="3909103545192669113" onmouseenter="enter('3909103545192669113');" onmouseout="out('3909103545192669113');" style=""> 342             editor.putStringSet(&quot;package_blacklist&quot;, blacklist);                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 343         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 344         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345     }                                                                                                    </span>
<span  style=""> 346                                                                                                          </span>
<span class="-2779319696285586872" onmouseenter="enter('-2779319696285586872');" onmouseout="out('-2779319696285586872');" style=""> 347     public static void addToBlacklist(String packageName) {                                              </span>
<span class="-1871256217611316970" onmouseenter="enter('-1871256217611316970');" onmouseout="out('-1871256217611316970');" style=""> 348         if (!blacklist.contains(packageName)) {                                                          </span>
<span class="1292536329989809753" onmouseenter="enter('1292536329989809753');" onmouseout="out('1292536329989809753');" style=""> 349             blacklist.add(packageName);                                                                  </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 350             saveBlackList();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 351         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 352     }                                                                                                    </span>
<span  style=""> 353                                                                                                          </span>
<span class="616928146830467939" onmouseenter="enter('616928146830467939');" onmouseout="out('616928146830467939');" style=""> 354     public static synchronized void removeFromBlacklist(String packageName) {                            </span>
<span class="-8340158867305867611" onmouseenter="enter('-8340158867305867611');" onmouseout="out('-8340158867305867611');" style=""> 355         blacklist.remove(packageName);                                                                   </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 356         saveBlackList();                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 357     }                                                                                                    </span>
<span  style=""> 358                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 359     /**                                                                                                  </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 360      * Deletes both the old Activity database and the new one recreates it with empty tables.            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 361      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 362      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 363      */                                                                                                  </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 364     public static synchronized boolean deleteActivityDatabase(Context context) {                         </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 365         // TODO: flush, close, reopen db                                                                 </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 366         if (lockHandler != null) {                                                                       </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 367             lockHandler.closeDb();                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 368         }                                                                                                </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 369         boolean result = deleteOldActivityDatabase(context);                                             </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 370         result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                            </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 371         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372     }                                                                                                    </span>
<span  style=""> 373                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 374     /**                                                                                                  </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 375      * Deletes the legacy (pre 0.12) Activity database                                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 376      *                                                                                                   </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 377      * @return true on successful deletion                                                               </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 378      */                                                                                                  </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 379     public static synchronized boolean deleteOldActivityDatabase(Context context) {                      </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 380         DBHelper dbHelper = new DBHelper(context);                                                       </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 381         boolean result = true;                                                                           </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 382         if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                     </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 383             result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 384         }                                                                                                </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 385         return result;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 386     }                                                                                                    </span>
<span  style=""> 387                                                                                                          </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 388     private int getPrefsFileVersion() {                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 389         try {                                                                                            </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 390             return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 391         } catch (Exception e) {                                                                          </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 392             //in version 1 this was an int                                                               </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 393             return 1;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 394         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 395     }                                                                                                    </span>
<span  style=""> 396                                                                                                          </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 397     private void migratePrefs(int oldVersion) {                                                          </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 398         SharedPreferences.Editor editor = sharedPrefs.edit();                                            </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 399         switch (oldVersion) {                                                                            </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 400             case 0:                                                                                      </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 401                 String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                     </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 402                 String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                  </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 403                 String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                  </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 404                 String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                 </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 405                 if (legacyGender != null) {                                                              </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 406                     int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;</span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 407                     editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));           </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 408                     editor.remove(&quot;mi_user_gender&quot;);                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                 }                                                                                        </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 410                 if (legacyHeight != null) {                                                              </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 411                     editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                    </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 412                     editor.remove(&quot;mi_user_height_cm&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 413                 }                                                                                        </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 414                 if (legacyWeigth != null) {                                                              </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 415                     editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                    </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 416                     editor.remove(&quot;mi_user_weight_kg&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 417                 }                                                                                        </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 418                 if (legacyYOB != null) {                                                                 </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 419                     editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                   </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 420                     editor.remove(&quot;mi_user_year_of_birth&quot;);                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 421                 }                                                                                        </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 422                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 423                 break;                                                                                   </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 424             case 1:                                                                                      </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 425                 //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 425                 //migrate the integer version of gender introduced in version 1 to a string value, needed🔵</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 426                 int legacyGender_1 = 2;                                                                  </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 427                 try {                                                                                    </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 428                     legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);               </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 429                 } catch (Exception e) {                                                                  </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 430                     Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 431                 }                                                                                        </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 432                 editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));       </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 433                 //also silently migrate the version to a string value                                    </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 434                 editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 435                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 436         }                                                                                                </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 437         editor.apply();                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 438     }                                                                                                    </span>
<span  style=""> 439                                                                                                          </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 440     public static LimitedQueue getIDSenderLookup() {                                                     </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 441         return mIDSenderLookup;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 442     }                                                                                                    </span>
<span  style=""> 443                                                                                                          </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 444     public static boolean isDarkThemeEnabled() {                                                         </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 445         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 445         return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equa🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 446     }                                                                                                    </span>
<span  style=""> 447                                                                                                          </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 448     public static int getTextColor(Context context) {                                                    </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 449         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 450         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 451         theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                               </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 452         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 453     }                                                                                                    </span>
<span  style=""> 454                                                                                                          </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 455     public static int getBackgroundColor(Context context) {                                              </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 456         TypedValue typedValue = new TypedValue();                                                        </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 457         Resources.Theme theme = context.getTheme();                                                      </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 458         theme.resolveAttribute(android.R.attr.background, typedValue, true);                             </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 459         return typedValue.data;                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460     }                                                                                                    </span>
<span  style=""> 461                                                                                                          </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 462     public static Prefs getPrefs() {                                                                     </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 463         return prefs;                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 464     }                                                                                                    </span>
<span  style=""> 465                                                                                                          </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 466     public static GBPrefs getGBPrefs() {                                                                 </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 467         return gbPrefs;                                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 468     }                                                                                                    </span>
<span  style=""> 469                                                                                                          </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 470     public DeviceManager getDeviceManager() {                                                            </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 471         return deviceManager;                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 472     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 473 }                                                                                                        </span>




</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1  /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                          </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2      Gobbetti, Normano64                                                                                           </span>
<span  style="">   3                                                                                                                    </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4      This file is part of Gadgetbridge.                                                                            </span>
<span  style="">   5                                                                                                                    </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6      Gadgetbridge is free software: you can redistribute it and/or modify                                          </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7      it under the terms of the GNU Affero General Public License as published                                      </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8      by the Free Software Foundation, either version 3 of the License, or                                          </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9      (at your option) any later version.                                                                           </span>
<span  style="">  10                                                                                                                    </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11      Gadgetbridge is distributed in the hope that it will be useful,                                               </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12      but WITHOUT ANY WARRANTY; without even the implied warranty of                                                </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                                 </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14      GNU Affero General Public License for more details.                                                           </span>
<span  style="">  15                                                                                                                    </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16      You should have received a copy of the GNU Affero General Public License                                      </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17      along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                                      </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18  package nodomain.freeyourgadget.gadgetbridge;                                                                     </span>
<span  style="">  19                                                                                                                    </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20  import android.annotation.TargetApi;                                                                              </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21  import android.app.Application;                                                                                   </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22  import android.app.NotificationManager;                                                                           </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23  import android.app.NotificationManager.Policy;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25  import android.content.Intent;                                                                                    </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26  import android.content.SharedPreferences;                                                                         </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  27  import android.content.res.Resources;                                                                             </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  28  import android.database.Cursor;                                                                                   </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  29  import android.database.sqlite.SQLiteDatabase;                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  30  import android.net.Uri;                                                                                           </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  31  import android.os.Build;                                                                                          </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  32  import android.os.Build.VERSION;                                                                                  </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  33  import android.preference.PreferenceManager;                                                                      </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  34  import android.provider.ContactsContract.PhoneLookup;                                                             </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  35  import android.support.v4.content.LocalBroadcastManager;                                                          </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  36  import android.util.Log;                                                                                          </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  37  import android.util.TypedValue;                                                                                   </span>
<span  style="">  38                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  39  import java.io.File;                                                                                              </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  40  import java.io.IOException;                                                                                       </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42  import java.util.List;                                                                                            </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  43  import java.util.concurrent.TimeUnit;                                                                             </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  44  import java.util.concurrent.locks.Lock;                                                                           </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  45  import java.util.concurrent.locks.ReentrantLock;                                                                  </span>
<span  style="">  46                                                                                                                    </span>
<span class="7399731926384290228" onmouseenter="enter('7399731926384290228');" onmouseout="out('7399731926384290228');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  47 +import nodomain.freeyourgadget.gadgetbridge.activities.BackgroundWebViewActivity;                                 </span>
<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  48  import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                                   </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  49  import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                                    </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  50  import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                                </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  51  import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                                </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  52  import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                                   </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  53  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  54  import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                                 </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  55  import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                                   </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  56  import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                                  </span>
<span class="-8326539218894047431" onmouseenter="enter('-8326539218894047431');" onmouseout="out('-8326539218894047431');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  57 +import nodomain.freeyourgadget.gadgetbridge.util.DeviceHelper;                                                    </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  58  import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                                       </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  59  import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                              </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  60  import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                         </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  61  import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                                    </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  62  import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                           </span>
<span  style="">  63                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  64  /**                                                                                                               </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  65   * Main Application class that initializes and provides access to certain things like                             </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  66   * logging and DB access.                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  67   */                                                                                                               </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  68  public class GBApplication extends Application {                                                                  </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  69      // Since this class must not log to slf4j, we use plain android.util.Log                                      </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  70      private static final String TAG = &quot;GBApplication&quot;;                                                            </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  71      public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                                    </span>
<span  style="">  72                                                                                                                    </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  73      private static GBApplication context;                                                                         </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  74      private static final Lock dbLock = new ReentrantLock();                                                       </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  75      private static DeviceService deviceService;                                                                   </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  76      private static SharedPreferences sharedPrefs;                                                                 </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  77      private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                                     </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  78      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  78      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs belo🔵</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  79      private static final int CURRENT_PREFS_VERSION = 2;                                                           </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  80      private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                           </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  81      private static Prefs prefs;                                                                                   </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  82      private static GBPrefs gbPrefs;                                                                               </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  83      private static LockHandler lockHandler;                                                                       </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  84      /**                                                                                                           </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  85       * Note: is null on Lollipop and Kitkat                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  86       */                                                                                                           </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  87      private static NotificationManager notificationManager;                                                       </span>
<span  style="">  88                                                                                                                    </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style="">  89      public static final String ACTION_QUIT                                                                        </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style="">  90              = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                                   </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style="">  91      private static Logging logging = new Logging() {                                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  92          @Override                                                                                                 </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style="">  93          protected String createLogDirectory() throws IOException {                                                </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style="">  94              File dir = FileUtils.getExternalFilesDir();                                                           </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style="">  95              return dir.getAbsolutePath();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  96          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="">  97      };                                                                                                            </span>
<span  style="">  98                                                                                                                    </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style="">  99      private DeviceManager deviceManager;                                                                          </span>
<span  style=""> 100                                                                                                                    </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 101      public static void quit() {                                                                                   </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 102          GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                                        </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 103          Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                                </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 104          LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                                     </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 105          GBApplication.deviceService().quit();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 106      }                                                                                                             </span>
<span  style=""> 107                                                                                                                    </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 108      public GBApplication() {                                                                                      </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 109          context = this;                                                                                           </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 110          // don&#x27;t do anything here, add it to onCreate instead                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 111      }                                                                                                             </span>
<span  style=""> 112                                                                                                                    </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 113      protected DeviceService createDeviceService() {                                                               </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 114          return new GBDeviceService(this);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 115      }                                                                                                             </span>
<span  style=""> 116                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 117      @Override                                                                                                     </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 118      public void onCreate() {                                                                                      </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 119          super.onCreate();                                                                                         </span>
<span  style=""> 120                                                                                                                    </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 121          if (lockHandler != null) {                                                                                </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 122              // guard against multiple invocations (robolectric)                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 123              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124          }                                                                                                         </span>
<span  style=""> 125                                                                                                                    </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 126          sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                                     </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 127          prefs = new Prefs(sharedPrefs);                                                                           </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 128          gbPrefs = new GBPrefs(prefs);                                                                             </span>
<span  style=""> 129                                                                                                                    </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 130          // don&#x27;t do anything here before we set up logging, otherwise                                             </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 131          // slf4j may be implicitly initialized before we properly configured it.                                  </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 132          setupLogging(isFileLoggingEnabled());                                                                     </span>
<span  style=""> 133                                                                                                                    </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 134          if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                                     </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 135              migratePrefs(getPrefsFileVersion());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136          }                                                                                                         </span>
<span  style=""> 137                                                                                                                    </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 138          setupExceptionHandler();                                                                                  </span>
<span  style=""> 139                                                                                                                    </span>
<span class="7918800930529116607" onmouseenter="enter('7918800930529116607');" onmouseout="out('7918800930529116607');" style=""> 140          GB.environment = GBEnvironment.createDeviceEnvironment();                                                 </span>
<span  style=""> 141                                                                                                                    </span>
<span class="-2534505263094918300" onmouseenter="enter('-2534505263094918300');" onmouseout="out('-2534505263094918300');" style=""> 142          setupDatabase(this);                                                                                      </span>
<span  style=""> 143                                                                                                                    </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 144          deviceManager = new DeviceManager(this);                                                                  </span>
<span  style=""> 145                                                                                                                    </span>
<span class="174408105383226903" onmouseenter="enter('174408105383226903');" onmouseout="out('174408105383226903');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 146 +        createWebViewActivity();                                                                                  </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 147 +                                                                                                                  </span>
<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 148          deviceService = createDeviceService();                                                                    </span>
<span class="7488460081830320754" onmouseenter="enter('7488460081830320754');" onmouseout="out('7488460081830320754');" style=""> 149          loadBlackList();                                                                                          </span>
<span  style=""> 150                                                                                                                    </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 151          if (isRunningMarshmallowOrLater()) {                                                                      </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""> 152              notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +        }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +    }                                                                                                             </span>
<span  style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 155 +                                                                                                                  </span>
<span class="-5717427514047617505" onmouseenter="enter('-5717427514047617505');" onmouseout="out('-5717427514047617505');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 156 +    private void createWebViewActivity() {                                                                        </span>
<span class="1560132465311496731" onmouseenter="enter('1560132465311496731');" onmouseout="out('1560132465311496731');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 157 +        if (DeviceHelper.getInstance().needsBackgroundWebView(this)) {                                            </span>
<span class="-1988738444344737981" onmouseenter="enter('-1988738444344737981');" onmouseout="out('-1988738444344737981');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 158 +            Intent intent = new Intent(getContext(), BackgroundWebViewActivity.class);                            </span>
<span class="-2757970933426051337" onmouseenter="enter('-2757970933426051337');" onmouseout="out('-2757970933426051337');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 159 +            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                                                       </span>
<span class="5329592942800388049" onmouseenter="enter('5329592942800388049');" onmouseout="out('5329592942800388049');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 160 +            startActivity(intent);                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162      }                                                                                                             </span>
<span  style=""> 163                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 164      @Override                                                                                                     </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 165      public void onTrimMemory(int level) {                                                                         </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 166          super.onTrimMemory(level);                                                                                </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 167          if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                                    </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 168              if (!hasBusyDevice()) {                                                                               </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 169                  DBHelper.clearSession();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 170              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 171          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172      }                                                                                                             </span>
<span  style=""> 173                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 174      /**                                                                                                           </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 175       * Returns true if at least a single device is busy, e.g synchronizing activity data                          </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 176       * or something similar.                                                                                      </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 177       * Note: busy is not the same as connected or initialized!                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 178       */                                                                                                           </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 179      private boolean hasBusyDevice() {                                                                             </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 180          List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                                 </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 181          for (GBDevice device : devices) {                                                                         </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 182              if (device.isBusy()) {                                                                                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 183                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 186          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187      }                                                                                                             </span>
<span  style=""> 188                                                                                                                    </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 189      public static void setupLogging(boolean enabled) {                                                            </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 190          logging.setupLogging(enabled);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191      }                                                                                                             </span>
<span  style=""> 192                                                                                                                    </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 193      private void setupExceptionHandler() {                                                                        </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 194          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 194          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler())🔵</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 195          Thread.setDefaultUncaughtExceptionHandler(handler);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196      }                                                                                                             </span>
<span  style=""> 197                                                                                                                    </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 198      public static boolean isFileLoggingEnabled() {                                                                </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 199          return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 200      }                                                                                                             </span>
<span  style=""> 201                                                                                                                    </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 202      public static boolean minimizeNotification() {                                                                </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 203          return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 204      }                                                                                                             </span>
<span  style=""> 205                                                                                                                    </span>
<span class="-9123382081525140297" onmouseenter="enter('-9123382081525140297');" onmouseout="out('-9123382081525140297');" style=""> 206      static void setupDatabase(Context context) {                                                                  </span>
<span class="495848848502583738" onmouseenter="enter('495848848502583738');" onmouseout="out('495848848502583738');" style=""> 207          DBOpenHelper helper = new DBOpenHelper(context, DATABASE_NAME, null);                                     </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 208          SQLiteDatabase db = helper.getWritableDatabase();                                                         </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 209          DaoMaster daoMaster = new DaoMaster(db);                                                                  </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 210          if (lockHandler == null) {                                                                                </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 211              lockHandler = new LockHandler();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 212          }                                                                                                         </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 213          lockHandler.init(daoMaster, helper);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 214      }                                                                                                             </span>
<span  style=""> 215                                                                                                                    </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 216      public static Context getContext() {                                                                          </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 217          return context;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 218      }                                                                                                             </span>
<span  style=""> 219                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 220      /**                                                                                                           </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 221       * Returns the facade for talking to devices. Devices are managed by                                          </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 222       * an Android Service and this facade provides access to its functionality.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 223       *                                                                                                            </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 224       * @return the facade for talking to the service/devices.                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 225       */                                                                                                           </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 226      public static DeviceService deviceService() {                                                                 </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 227          return deviceService;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 228      }                                                                                                             </span>
<span  style=""> 229                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 230      /**                                                                                                           </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 231       * Returns the DBHandler instance for reading/writing or throws GBException                                   </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 232       * when that was not successful                                                                               </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 233       * If acquiring was successful, callers must call #releaseDB when they                                        </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 234       * are done (from the same thread that acquired the lock!                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 235       * &lt;p&gt;                                                                                                        </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 236       * Callers must not hold a reference to the returned instance because it                                      </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 237       * will be invalidated at some point.                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 238       *                                                                                                            </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 239       * @return the DBHandler                                                                                      </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 240       * @throws GBException                                                                                        </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 241       * @see #releaseDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 242       */                                                                                                           </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 243      public static DBHandler acquireDB() throws GBException {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 244          try {                                                                                                     </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 245              if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                           </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 246                  return lockHandler;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 247              }                                                                                                     </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 248          } catch (InterruptedException ex) {                                                                       </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 249              Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 250          }                                                                                                         </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 251          throw new GBException(&quot;Unable to access the database.&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 252      }                                                                                                             </span>
<span  style=""> 253                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 254      /**                                                                                                           </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 255       * Releases the database lock.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 256       *                                                                                                            </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 257       * @throws IllegalMonitorStateException if the current thread is not owning the lock                          </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 258       * @see #acquireDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 259       */                                                                                                           </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 260      public static void releaseDB() {                                                                              </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 261          dbLock.unlock();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 262      }                                                                                                             </span>
<span  style=""> 263                                                                                                                    </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 264      public static boolean isRunningLollipopOrLater() {                                                            </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 265          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 266      }                                                                                                             </span>
<span  style=""> 267                                                                                                                    </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 268      public static boolean isRunningMarshmallowOrLater() {                                                         </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 269          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 270      }                                                                                                             </span>
<span  style=""> 271                                                                                                                    </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 272      private static boolean isPrioritySender(int prioritySenders, String number) {                                 </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 273          if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 274              return true;                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 275          } else {                                                                                                  </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 276              Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));                   </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 277              String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                             </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 278              Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);                </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 279              boolean exists = false;                                                                               </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 280              int starred = 0;                                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 281              try {                                                                                                 </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 282                  if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                                     </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 283                      exists = true;                                                                                </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 284                      starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 285                  }                                                                                                 </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 286              } finally {                                                                                           </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 287                  if (cursor != null) {                                                                             </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 288                      cursor.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 290              }                                                                                                     </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 291              if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 292                  return true;                                                                                      </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 293              } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 294                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 295              }                                                                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 296              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 298      }                                                                                                             </span>
<span  style=""> 299                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 300      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 301      public static boolean isPriorityNumber(int priorityType, String number) {                                     </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 302          NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();              </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 303          if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                                  </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 304              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 304              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CAT🔵</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 305                  return isPrioritySender(notificationPolicy.priorityMessageSenders, number);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 306              }                                                                                                     </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 307          } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                              </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 308              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 308              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGO🔵</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 309                  return isPrioritySender(notificationPolicy.priorityCallSenders, number);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 310              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 312          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 313      }                                                                                                             </span>
<span  style=""> 314                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 315      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 316      public static int getGrantedInterruptionFilter() {                                                            </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""> 317          if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {      </span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 318              if (notificationManager.isNotificationPolicyAccessGranted()) {                                        </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 319                  return notificationManager.getCurrentInterruptionFilter();                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 320              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 321          }                                                                                                         </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 322          return NotificationManager.INTERRUPTION_FILTER_ALL;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323      }                                                                                                             </span>
<span  style=""> 324                                                                                                                    </span>
<span class="504195764522846272" onmouseenter="enter('504195764522846272');" onmouseout="out('504195764522846272');" style=""> 325      public static HashSet&lt;String&gt; blacklist = null;                                                               </span>
<span  style=""> 326                                                                                                                    </span>
<span class="3136809427715779853" onmouseenter="enter('3136809427715779853');" onmouseout="out('3136809427715779853');" style=""> 327      private static void loadBlackList() {                                                                         </span>
<span class="-4165545423449523865" onmouseenter="enter('-4165545423449523865');" onmouseout="out('-4165545423449523865');" style=""> 328          blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(&quot;package_blacklist&quot;, null);                        </span>
<span class="3710122947239011739" onmouseenter="enter('3710122947239011739');" onmouseout="out('3710122947239011739');" style=""> 329          if (blacklist == null) {                                                                                  </span>
<span class="8704968985872011996" onmouseenter="enter('8704968985872011996');" onmouseout="out('8704968985872011996');" style=""> 330              blacklist = new HashSet&lt;&gt;();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 332      }                                                                                                             </span>
<span  style=""> 333                                                                                                                    </span>
<span class="-481433286634482934" onmouseenter="enter('-481433286634482934');" onmouseout="out('-481433286634482934');" style=""> 334      private static void saveBlackList() {                                                                         </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 335          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="4373063490515338158" onmouseenter="enter('4373063490515338158');" onmouseout="out('4373063490515338158');" style=""> 336          if (blacklist.isEmpty()) {                                                                                </span>
<span class="-7033385367321024850" onmouseenter="enter('-7033385367321024850');" onmouseout="out('-7033385367321024850');" style=""> 337              editor.putStringSet(&quot;package_blacklist&quot;, null);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 338          } else {                                                                                                  </span>
<span class="3909103545192669113" onmouseenter="enter('3909103545192669113');" onmouseout="out('3909103545192669113');" style=""> 339              editor.putStringSet(&quot;package_blacklist&quot;, blacklist);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 341          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 342      }                                                                                                             </span>
<span  style=""> 343                                                                                                                    </span>
<span class="-2779319696285586872" onmouseenter="enter('-2779319696285586872');" onmouseout="out('-2779319696285586872');" style=""> 344      public static void addToBlacklist(String packageName) {                                                       </span>
<span class="-1871256217611316970" onmouseenter="enter('-1871256217611316970');" onmouseout="out('-1871256217611316970');" style=""> 345          if (!blacklist.contains(packageName)) {                                                                   </span>
<span class="1292536329989809753" onmouseenter="enter('1292536329989809753');" onmouseout="out('1292536329989809753');" style=""> 346              blacklist.add(packageName);                                                                           </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 347              saveBlackList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 348          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 349      }                                                                                                             </span>
<span  style=""> 350                                                                                                                    </span>
<span class="616928146830467939" onmouseenter="enter('616928146830467939');" onmouseout="out('616928146830467939');" style=""> 351      public static synchronized void removeFromBlacklist(String packageName) {                                     </span>
<span class="-8340158867305867611" onmouseenter="enter('-8340158867305867611');" onmouseout="out('-8340158867305867611');" style=""> 352          blacklist.remove(packageName);                                                                            </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 353          saveBlackList();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 354      }                                                                                                             </span>
<span  style=""> 355                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 356      /**                                                                                                           </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 357       * Deletes both the old Activity database and the new one recreates it with empty tables.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 358       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 359       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 360       */                                                                                                           </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 361      public static synchronized boolean deleteActivityDatabase(Context context) {                                  </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 362          // TODO: flush, close, reopen db                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 363          if (lockHandler != null) {                                                                                </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 364              lockHandler.closeDb();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 365          }                                                                                                         </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 366          boolean result = deleteOldActivityDatabase(context);                                                      </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 367          result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                                     </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 368          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 369      }                                                                                                             </span>
<span  style=""> 370                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 371      /**                                                                                                           </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 372       * Deletes the legacy (pre 0.12) Activity database                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 373       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 374       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 375       */                                                                                                           </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 376      public static synchronized boolean deleteOldActivityDatabase(Context context) {                               </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 377          DBHelper dbHelper = new DBHelper(context);                                                                </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 378          boolean result = true;                                                                                    </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 379          if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                              </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 380              result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 381          }                                                                                                         </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 382          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383      }                                                                                                             </span>
<span  style=""> 384                                                                                                                    </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 385      private int getPrefsFileVersion() {                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 386          try {                                                                                                     </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 387              return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 388          } catch (Exception e) {                                                                                   </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 389              //in version 1 this was an int                                                                        </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 390              return 1;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 391          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 392      }                                                                                                             </span>
<span  style=""> 393                                                                                                                    </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 394      private void migratePrefs(int oldVersion) {                                                                   </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 395          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 396          switch (oldVersion) {                                                                                     </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 397              case 0:                                                                                               </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 398                  String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                              </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 399                  String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                           </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 400                  String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                           </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 401                  String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                          </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 402                  if (legacyGender != null) {                                                                       </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 403                      int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;         </span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 404                      editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));                    </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 405                      editor.remove(&quot;mi_user_gender&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 406                  }                                                                                                 </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 407                  if (legacyHeight != null) {                                                                       </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 408                      editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                             </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 409                      editor.remove(&quot;mi_user_height_cm&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 410                  }                                                                                                 </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 411                  if (legacyWeigth != null) {                                                                       </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 412                      editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                             </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 413                      editor.remove(&quot;mi_user_weight_kg&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 414                  }                                                                                                 </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 415                  if (legacyYOB != null) {                                                                          </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 416                      editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                            </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 417                      editor.remove(&quot;mi_user_year_of_birth&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 418                  }                                                                                                 </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 419                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 420                  break;                                                                                            </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 421              case 1:                                                                                               </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 422                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 422                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the 🔵</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 423                  int legacyGender_1 = 2;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 424                  try {                                                                                             </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 425                      legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 426                  } catch (Exception e) {                                                                           </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 427                      Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 428                  }                                                                                                 </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 429                  editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));                </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 430                  //also silently migrate the version to a string value                                             </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 431                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 432                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 433          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 434          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 435      }                                                                                                             </span>
<span  style=""> 436                                                                                                                    </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 437      public static LimitedQueue getIDSenderLookup() {                                                              </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 438          return mIDSenderLookup;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 439      }                                                                                                             </span>
<span  style=""> 440                                                                                                                    </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 441      public static boolean isDarkThemeEnabled() {                                                                  </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 442          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 442          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(contex🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 443      }                                                                                                             </span>
<span  style=""> 444                                                                                                                    </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 445      public static int getTextColor(Context context) {                                                             </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 446          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 447          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 448          theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                                        </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 449          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 450      }                                                                                                             </span>
<span  style=""> 451                                                                                                                    </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 452      public static int getBackgroundColor(Context context) {                                                       </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 453          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 454          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 455          theme.resolveAttribute(android.R.attr.background, typedValue, true);                                      </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 456          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 457      }                                                                                                             </span>
<span  style=""> 458                                                                                                                    </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 459      public static Prefs getPrefs() {                                                                              </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 460          return prefs;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461      }                                                                                                             </span>
<span  style=""> 462                                                                                                                    </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 463      public static GBPrefs getGBPrefs() {                                                                          </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 464          return gbPrefs;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 465      }                                                                                                             </span>
<span  style=""> 466                                                                                                                    </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 467      public DeviceManager getDeviceManager() {                                                                     </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 468          return deviceManager;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 469      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 470  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="2712347812677068090" onmouseenter="enter('2712347812677068090');" onmouseout="out('2712347812677068090');" style="">   1  /*  Copyright (C) 2015-2017 Andreas Shimokawa, Carsten Pfeiffer, Daniele                                          </span>
<span class="519545546387392480" onmouseenter="enter('519545546387392480');" onmouseout="out('519545546387392480');" style="">   2      Gobbetti, Normano64                                                                                           </span>
<span  style="">   3                                                                                                                    </span>
<span class="-7759499394858783956" onmouseenter="enter('-7759499394858783956');" onmouseout="out('-7759499394858783956');" style="">   4      This file is part of Gadgetbridge.                                                                            </span>
<span  style="">   5                                                                                                                    </span>
<span class="-2647557636279629478" onmouseenter="enter('-2647557636279629478');" onmouseout="out('-2647557636279629478');" style="">   6      Gadgetbridge is free software: you can redistribute it and/or modify                                          </span>
<span class="4878736751218581391" onmouseenter="enter('4878736751218581391');" onmouseout="out('4878736751218581391');" style="">   7      it under the terms of the GNU Affero General Public License as published                                      </span>
<span class="-5160078368722358920" onmouseenter="enter('-5160078368722358920');" onmouseout="out('-5160078368722358920');" style="">   8      by the Free Software Foundation, either version 3 of the License, or                                          </span>
<span class="6661789815760177463" onmouseenter="enter('6661789815760177463');" onmouseout="out('6661789815760177463');" style="">   9      (at your option) any later version.                                                                           </span>
<span  style="">  10                                                                                                                    </span>
<span class="-6828199977528779968" onmouseenter="enter('-6828199977528779968');" onmouseout="out('-6828199977528779968');" style="">  11      Gadgetbridge is distributed in the hope that it will be useful,                                               </span>
<span class="4883593508173597945" onmouseenter="enter('4883593508173597945');" onmouseout="out('4883593508173597945');" style="">  12      but WITHOUT ANY WARRANTY; without even the implied warranty of                                                </span>
<span class="2300657568347926527" onmouseenter="enter('2300657568347926527');" onmouseout="out('2300657568347926527');" style="">  13      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                                 </span>
<span class="4681049817175334681" onmouseenter="enter('4681049817175334681');" onmouseout="out('4681049817175334681');" style="">  14      GNU Affero General Public License for more details.                                                           </span>
<span  style="">  15                                                                                                                    </span>
<span class="-3235531360569947201" onmouseenter="enter('-3235531360569947201');" onmouseout="out('-3235531360569947201');" style="">  16      You should have received a copy of the GNU Affero General Public License                                      </span>
<span class="-3088444562895398794" onmouseenter="enter('-3088444562895398794');" onmouseout="out('-3088444562895398794');" style="">  17      along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. */                                      </span>
<span class="2334011911131623311" onmouseenter="enter('2334011911131623311');" onmouseout="out('2334011911131623311');" style="">  18  package nodomain.freeyourgadget.gadgetbridge;                                                                     </span>
<span  style="">  19                                                                                                                    </span>
<span class="-6548293536248798364" onmouseenter="enter('-6548293536248798364');" onmouseout="out('-6548293536248798364');" style="">  20  import android.annotation.TargetApi;                                                                              </span>
<span class="-4535828467892621321" onmouseenter="enter('-4535828467892621321');" onmouseout="out('-4535828467892621321');" style="">  21  import android.app.Application;                                                                                   </span>
<span class="2183671588995744448" onmouseenter="enter('2183671588995744448');" onmouseout="out('2183671588995744448');" style="">  22  import android.app.NotificationManager;                                                                           </span>
<span class="8022174898473650601" onmouseenter="enter('8022174898473650601');" onmouseout="out('8022174898473650601');" style="">  23  import android.app.NotificationManager.Policy;                                                                    </span>
<span class="5922045460006936195" onmouseenter="enter('5922045460006936195');" onmouseout="out('5922045460006936195');" style="">  24  import android.content.Context;                                                                                   </span>
<span class="6568903789857736568" onmouseenter="enter('6568903789857736568');" onmouseout="out('6568903789857736568');" style="">  25  import android.content.Intent;                                                                                    </span>
<span class="4122587240602557356" onmouseenter="enter('4122587240602557356');" onmouseout="out('4122587240602557356');" style="">  26  import android.content.SharedPreferences;                                                                         </span>
<span class="7207138161133478555" onmouseenter="enter('7207138161133478555');" onmouseout="out('7207138161133478555');" style="">  27  import android.content.res.Resources;                                                                             </span>
<span class="6294169624328016071" onmouseenter="enter('6294169624328016071');" onmouseout="out('6294169624328016071');" style="">  28  import android.database.Cursor;                                                                                   </span>
<span class="-4895155655276492102" onmouseenter="enter('-4895155655276492102');" onmouseout="out('-4895155655276492102');" style="">  29  import android.database.sqlite.SQLiteDatabase;                                                                    </span>
<span class="-8750621697125156872" onmouseenter="enter('-8750621697125156872');" onmouseout="out('-8750621697125156872');" style="">  30  import android.net.Uri;                                                                                           </span>
<span class="-4549785658871057260" onmouseenter="enter('-4549785658871057260');" onmouseout="out('-4549785658871057260');" style="">  31  import android.os.Build;                                                                                          </span>
<span class="-2606184283037987249" onmouseenter="enter('-2606184283037987249');" onmouseout="out('-2606184283037987249');" style="">  32  import android.os.Build.VERSION;                                                                                  </span>
<span class="-3409889999907038804" onmouseenter="enter('-3409889999907038804');" onmouseout="out('-3409889999907038804');" style="">  33  import android.preference.PreferenceManager;                                                                      </span>
<span class="-413536475979006678" onmouseenter="enter('-413536475979006678');" onmouseout="out('-413536475979006678');" style="">  34  import android.provider.ContactsContract.PhoneLookup;                                                             </span>
<span class="2517521963771876570" onmouseenter="enter('2517521963771876570');" onmouseout="out('2517521963771876570');" style="">  35  import android.support.v4.content.LocalBroadcastManager;                                                          </span>
<span class="7196841398407674858" onmouseenter="enter('7196841398407674858');" onmouseout="out('7196841398407674858');" style="">  36  import android.util.Log;                                                                                          </span>
<span class="-1289400933432271961" onmouseenter="enter('-1289400933432271961');" onmouseout="out('-1289400933432271961');" style="">  37  import android.util.TypedValue;                                                                                   </span>
<span  style="">  38                                                                                                                    </span>
<span class="-3926401431737521278" onmouseenter="enter('-3926401431737521278');" onmouseout="out('-3926401431737521278');" style="">  39  import java.io.File;                                                                                              </span>
<span class="103340661636203254" onmouseenter="enter('103340661636203254');" onmouseout="out('103340661636203254');" style="">  40  import java.io.IOException;                                                                                       </span>
<span class="-1320562196372945707" onmouseenter="enter('-1320562196372945707');" onmouseout="out('-1320562196372945707');" style="">  41  import java.util.HashSet;                                                                                         </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  42  import java.util.List;                                                                                            </span>
<span class="-6356287537734540725" onmouseenter="enter('-6356287537734540725');" onmouseout="out('-6356287537734540725');" style="">  43  import java.util.concurrent.TimeUnit;                                                                             </span>
<span class="3303209005407951113" onmouseenter="enter('3303209005407951113');" onmouseout="out('3303209005407951113');" style="">  44  import java.util.concurrent.locks.Lock;                                                                           </span>
<span class="7829593089976432692" onmouseenter="enter('7829593089976432692');" onmouseout="out('7829593089976432692');" style="">  45  import java.util.concurrent.locks.ReentrantLock;                                                                  </span>
<span  style="">  46                                                                                                                    </span>

<span class="6679513218772020996" onmouseenter="enter('6679513218772020996');" onmouseout="out('6679513218772020996');" style="">  47  import nodomain.freeyourgadget.gadgetbridge.database.DBHandler;                                                   </span>
<span class="4338650188295783318" onmouseenter="enter('4338650188295783318');" onmouseout="out('4338650188295783318');" style="">  48  import nodomain.freeyourgadget.gadgetbridge.database.DBHelper;                                                    </span>
<span class="4408224481861698471" onmouseenter="enter('4408224481861698471');" onmouseout="out('4408224481861698471');" style="">  49  import nodomain.freeyourgadget.gadgetbridge.database.DBOpenHelper;                                                </span>
<span class="3435970526381368717" onmouseenter="enter('3435970526381368717');" onmouseout="out('3435970526381368717');" style="">  50  import nodomain.freeyourgadget.gadgetbridge.devices.DeviceManager;                                                </span>
<span class="-5184377761573799337" onmouseenter="enter('-5184377761573799337');" onmouseout="out('-5184377761573799337');" style="">  51  import nodomain.freeyourgadget.gadgetbridge.entities.DaoMaster;                                                   </span>
<span class="4836892992022606579" onmouseenter="enter('4836892992022606579');" onmouseout="out('4836892992022606579');" style="">  52  import nodomain.freeyourgadget.gadgetbridge.impl.GBDevice;                                                        </span>
<span class="2477879965797776433" onmouseenter="enter('2477879965797776433');" onmouseout="out('2477879965797776433');" style="">  53  import nodomain.freeyourgadget.gadgetbridge.impl.GBDeviceService;                                                 </span>
<span class="4473521571743889434" onmouseenter="enter('4473521571743889434');" onmouseout="out('4473521571743889434');" style="">  54  import nodomain.freeyourgadget.gadgetbridge.model.ActivityUser;                                                   </span>
<span class="308285905299900254" onmouseenter="enter('308285905299900254');" onmouseout="out('308285905299900254');" style="">  55  import nodomain.freeyourgadget.gadgetbridge.model.DeviceService;                                                  </span>
<span class="-4124593349050005270" onmouseenter="enter('-4124593349050005270');" onmouseout="out('-4124593349050005270');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +import nodomain.freeyourgadget.gadgetbridge.service.NotificationCollectorMonitorService;                          </span>
<span class="-2020231768395052380" onmouseenter="enter('-2020231768395052380');" onmouseout="out('-2020231768395052380');" style="">  57  import nodomain.freeyourgadget.gadgetbridge.util.FileUtils;                                                       </span>
<span class="-3798970344596478499" onmouseenter="enter('-3798970344596478499');" onmouseout="out('-3798970344596478499');" style="">  58  import nodomain.freeyourgadget.gadgetbridge.util.GB;                                                              </span>
<span class="-9094281754584205644" onmouseenter="enter('-9094281754584205644');" onmouseout="out('-9094281754584205644');" style="">  59  import nodomain.freeyourgadget.gadgetbridge.util.GBPrefs;                                                         </span>
<span class="-6912606469471439703" onmouseenter="enter('-6912606469471439703');" onmouseout="out('-6912606469471439703');" style="">  60  import nodomain.freeyourgadget.gadgetbridge.util.LimitedQueue;                                                    </span>
<span class="-600862318521663319" onmouseenter="enter('-600862318521663319');" onmouseout="out('-600862318521663319');" style="">  61  import nodomain.freeyourgadget.gadgetbridge.util.Prefs;                                                           </span>
<span  style="">  62                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  63  /**                                                                                                               </span>
<span class="-4843613632959835076" onmouseenter="enter('-4843613632959835076');" onmouseout="out('-4843613632959835076');" style="">  64   * Main Application class that initializes and provides access to certain things like                             </span>
<span class="6235593870078905976" onmouseenter="enter('6235593870078905976');" onmouseout="out('6235593870078905976');" style="">  65   * logging and DB access.                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  66   */                                                                                                               </span>
<span class="759771369730976277" onmouseenter="enter('759771369730976277');" onmouseout="out('759771369730976277');" style="">  67  public class GBApplication extends Application {                                                                  </span>
<span class="5690473538327796015" onmouseenter="enter('5690473538327796015');" onmouseout="out('5690473538327796015');" style="">  68      // Since this class must not log to slf4j, we use plain android.util.Log                                      </span>
<span class="2464481609397612009" onmouseenter="enter('2464481609397612009');" onmouseout="out('2464481609397612009');" style="">  69      private static final String TAG = &quot;GBApplication&quot;;                                                            </span>
<span class="-5805665068875693522" onmouseenter="enter('-5805665068875693522');" onmouseout="out('-5805665068875693522');" style="">  70      public static final String DATABASE_NAME = &quot;Gadgetbridge&quot;;                                                    </span>
<span  style="">  71                                                                                                                    </span>
<span class="850460273030582630" onmouseenter="enter('850460273030582630');" onmouseout="out('850460273030582630');" style="">  72      private static GBApplication context;                                                                         </span>
<span class="-7325892316572258172" onmouseenter="enter('-7325892316572258172');" onmouseout="out('-7325892316572258172');" style="">  73      private static final Lock dbLock = new ReentrantLock();                                                       </span>
<span class="-6526574720522442685" onmouseenter="enter('-6526574720522442685');" onmouseout="out('-6526574720522442685');" style="">  74      private static DeviceService deviceService;                                                                   </span>
<span class="-9111638739002623420" onmouseenter="enter('-9111638739002623420');" onmouseout="out('-9111638739002623420');" style="">  75      private static SharedPreferences sharedPrefs;                                                                 </span>
<span class="997616430690679596" onmouseenter="enter('997616430690679596');" onmouseout="out('997616430690679596');" style="">  76      private static final String PREFS_VERSION = &quot;shared_preferences_version&quot;;                                     </span>
<span class="8784272355833553306" onmouseenter="enter('8784272355833553306');" onmouseout="out('8784272355833553306');" style=""><abbr title="  77      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs below; see http://stackoverflow.com/questions/16397848/how-can-i-migrate-android-preferences-with-a-new-version">  77      //if preferences have to be migrated, increment the following and add the migration logic in migratePrefs belo🔵</abbr></span>
<span class="599012323214413072" onmouseenter="enter('599012323214413072');" onmouseout="out('599012323214413072');" style="">  78      private static final int CURRENT_PREFS_VERSION = 2;                                                           </span>
<span class="-3976824484923687891" onmouseenter="enter('-3976824484923687891');" onmouseout="out('-3976824484923687891');" style="">  79      private static LimitedQueue mIDSenderLookup = new LimitedQueue(16);                                           </span>
<span class="3255392111665037504" onmouseenter="enter('3255392111665037504');" onmouseout="out('3255392111665037504');" style="">  80      private static Prefs prefs;                                                                                   </span>
<span class="-140005780120839790" onmouseenter="enter('-140005780120839790');" onmouseout="out('-140005780120839790');" style="">  81      private static GBPrefs gbPrefs;                                                                               </span>
<span class="5199242230401528950" onmouseenter="enter('5199242230401528950');" onmouseout="out('5199242230401528950');" style="">  82      private static LockHandler lockHandler;                                                                       </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  83      /**                                                                                                           </span>
<span class="2492130925074712510" onmouseenter="enter('2492130925074712510');" onmouseout="out('2492130925074712510');" style="">  84       * Note: is null on Lollipop and Kitkat                                                                       </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  85       */                                                                                                           </span>
<span class="-8899570044112182208" onmouseenter="enter('-8899570044112182208');" onmouseout="out('-8899570044112182208');" style="">  86      private static NotificationManager notificationManager;                                                       </span>
<span  style="">  87                                                                                                                    </span>
<span class="-5389455595393225283" onmouseenter="enter('-5389455595393225283');" onmouseout="out('-5389455595393225283');" style="">  88      public static final String ACTION_QUIT                                                                        </span>
<span class="-1988124227472802349" onmouseenter="enter('-1988124227472802349');" onmouseout="out('-1988124227472802349');" style="">  89              = &quot;nodomain.freeyourgadget.gadgetbridge.gbapplication.action.quit&quot;;                                   </span>
<span class="-6823188163779935816" onmouseenter="enter('-6823188163779935816');" onmouseout="out('-6823188163779935816');" style="">  90      private static Logging logging = new Logging() {                                                              </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  91          @Override                                                                                                 </span>
<span class="2047956327486618360" onmouseenter="enter('2047956327486618360');" onmouseout="out('2047956327486618360');" style="">  92          protected String createLogDirectory() throws IOException {                                                </span>
<span class="-4656890043492166931" onmouseenter="enter('-4656890043492166931');" onmouseout="out('-4656890043492166931');" style="">  93              File dir = FileUtils.getExternalFilesDir();                                                           </span>
<span class="3007889526376103180" onmouseenter="enter('3007889526376103180');" onmouseout="out('3007889526376103180');" style="">  94              return dir.getAbsolutePath();                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95          }                                                                                                         </span>
<span class="2468309323999483380" onmouseenter="enter('2468309323999483380');" onmouseout="out('2468309323999483380');" style="">  96      };                                                                                                            </span>
<span  style="">  97                                                                                                                    </span>
<span class="446465244819255660" onmouseenter="enter('446465244819255660');" onmouseout="out('446465244819255660');" style="">  98      private DeviceManager deviceManager;                                                                          </span>
<span  style="">  99                                                                                                                    </span>
<span class="6138722823527801498" onmouseenter="enter('6138722823527801498');" onmouseout="out('6138722823527801498');" style=""> 100      public static void quit() {                                                                                   </span>
<span class="7987659352318062880" onmouseenter="enter('7987659352318062880');" onmouseout="out('7987659352318062880');" style=""> 101          GB.log(&quot;Quitting Gadgetbridge...&quot;, GB.INFO, null);                                                        </span>
<span class="-832472449044793957" onmouseenter="enter('-832472449044793957');" onmouseout="out('-832472449044793957');" style=""> 102          Intent quitIntent = new Intent(GBApplication.ACTION_QUIT);                                                </span>
<span class="-4752327642296949274" onmouseenter="enter('-4752327642296949274');" onmouseout="out('-4752327642296949274');" style=""> 103          LocalBroadcastManager.getInstance(context).sendBroadcast(quitIntent);                                     </span>
<span class="-6518942679728085515" onmouseenter="enter('-6518942679728085515');" onmouseout="out('-6518942679728085515');" style=""> 104          GBApplication.deviceService().quit();                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 105      }                                                                                                             </span>
<span  style=""> 106                                                                                                                    </span>
<span class="3343874997906129279" onmouseenter="enter('3343874997906129279');" onmouseout="out('3343874997906129279');" style=""> 107      public GBApplication() {                                                                                      </span>
<span class="-9045804949470325763" onmouseenter="enter('-9045804949470325763');" onmouseout="out('-9045804949470325763');" style=""> 108          context = this;                                                                                           </span>
<span class="-7148680871334815171" onmouseenter="enter('-7148680871334815171');" onmouseout="out('-7148680871334815171');" style=""> 109          // don&#x27;t do anything here, add it to onCreate instead                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 110      }                                                                                                             </span>
<span  style=""> 111                                                                                                                    </span>
<span class="-2698966603391207222" onmouseenter="enter('-2698966603391207222');" onmouseout="out('-2698966603391207222');" style=""> 112      protected DeviceService createDeviceService() {                                                               </span>
<span class="5273333773636603471" onmouseenter="enter('5273333773636603471');" onmouseout="out('5273333773636603471');" style=""> 113          return new GBDeviceService(this);                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 114      }                                                                                                             </span>
<span  style=""> 115                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 116      @Override                                                                                                     </span>
<span class="-2716773701189387633" onmouseenter="enter('-2716773701189387633');" onmouseout="out('-2716773701189387633');" style=""> 117      public void onCreate() {                                                                                      </span>
<span class="-2958534921295515858" onmouseenter="enter('-2958534921295515858');" onmouseout="out('-2958534921295515858');" style=""> 118          super.onCreate();                                                                                         </span>
<span  style=""> 119                                                                                                                    </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 120          if (lockHandler != null) {                                                                                </span>
<span class="2946276138735138039" onmouseenter="enter('2946276138735138039');" onmouseout="out('2946276138735138039');" style=""> 121              // guard against multiple invocations (robolectric)                                                   </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 122              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123          }                                                                                                         </span>
<span  style=""> 124                                                                                                                    </span>
<span class="-7682209466348692789" onmouseenter="enter('-7682209466348692789');" onmouseout="out('-7682209466348692789');" style=""> 125          sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);                                     </span>
<span class="7752471275755172020" onmouseenter="enter('7752471275755172020');" onmouseout="out('7752471275755172020');" style=""> 126          prefs = new Prefs(sharedPrefs);                                                                           </span>
<span class="-2233501952527350295" onmouseenter="enter('-2233501952527350295');" onmouseout="out('-2233501952527350295');" style=""> 127          gbPrefs = new GBPrefs(prefs);                                                                             </span>
<span  style=""> 128                                                                                                                    </span>
<span class="-5272371693743866314" onmouseenter="enter('-5272371693743866314');" onmouseout="out('-5272371693743866314');" style=""> 129          // don&#x27;t do anything here before we set up logging, otherwise                                             </span>
<span class="-4365537966658644169" onmouseenter="enter('-4365537966658644169');" onmouseout="out('-4365537966658644169');" style=""> 130          // slf4j may be implicitly initialized before we properly configured it.                                  </span>
<span class="216771908453430844" onmouseenter="enter('216771908453430844');" onmouseout="out('216771908453430844');" style=""> 131          setupLogging(isFileLoggingEnabled());                                                                     </span>
<span  style=""> 132                                                                                                                    </span>
<span class="-4267741648294612061" onmouseenter="enter('-4267741648294612061');" onmouseout="out('-4267741648294612061');" style=""> 133          if (getPrefsFileVersion() != CURRENT_PREFS_VERSION) {                                                     </span>
<span class="5571923868684252096" onmouseenter="enter('5571923868684252096');" onmouseout="out('5571923868684252096');" style=""> 134              migratePrefs(getPrefsFileVersion());                                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135          }                                                                                                         </span>
<span  style=""> 136                                                                                                                    </span>
<span class="241650942716246256" onmouseenter="enter('241650942716246256');" onmouseout="out('241650942716246256');" style=""> 137          setupExceptionHandler();                                                                                  </span>
<span  style=""> 138                                                                                                                    </span>
<span class="7918800930529116607" onmouseenter="enter('7918800930529116607');" onmouseout="out('7918800930529116607');" style=""> 139          GB.environment = GBEnvironment.createDeviceEnvironment();                                                 </span>
<span  style=""> 140                                                                                                                    </span>
<span class="-2534505263094918300" onmouseenter="enter('-2534505263094918300');" onmouseout="out('-2534505263094918300');" style=""> 141          setupDatabase(this);                                                                                      </span>
<span  style=""> 142                                                                                                                    </span>
<span class="-706763515953093842" onmouseenter="enter('-706763515953093842');" onmouseout="out('-706763515953093842');" style=""> 143          deviceManager = new DeviceManager(this);                                                                  </span>
<span  style=""> 144                                                                                                                    </span>


<span class="-6122998303849960" onmouseenter="enter('-6122998303849960');" onmouseout="out('-6122998303849960');" style=""> 145          deviceService = createDeviceService();                                                                    </span>
<span class="7488460081830320754" onmouseenter="enter('7488460081830320754');" onmouseout="out('7488460081830320754');" style=""> 146          loadBlackList();                                                                                          </span>
<span  style=""> 147                                                                                                                    </span>
<span class="2476424367635550832" onmouseenter="enter('2476424367635550832');" onmouseout="out('2476424367635550832');" style=""> 148          if (isRunningMarshmallowOrLater()) {                                                                      </span>
<span class="-8110338791132869888" onmouseenter="enter('-8110338791132869888');" onmouseout="out('-8110338791132869888');" style=""> 149              notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);   </span>
<span class="-3292367781642785183" onmouseenter="enter('-3292367781642785183');" onmouseout="out('-3292367781642785183');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +            //the following will ensure the notification manager is kept alive                                    </span>
<span class="-1362973536513449118" onmouseenter="enter('-1362973536513449118');" onmouseout="out('-1362973536513449118');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +            startService(new Intent(this, NotificationCollectorMonitorService.class));                            </span>






<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153      }                                                                                                             </span>
<span  style=""> 154                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 155      @Override                                                                                                     </span>
<span class="2274976836934101801" onmouseenter="enter('2274976836934101801');" onmouseout="out('2274976836934101801');" style=""> 156      public void onTrimMemory(int level) {                                                                         </span>
<span class="-1383290349636775412" onmouseenter="enter('-1383290349636775412');" onmouseout="out('-1383290349636775412');" style=""> 157          super.onTrimMemory(level);                                                                                </span>
<span class="-4781185987508898365" onmouseenter="enter('-4781185987508898365');" onmouseout="out('-4781185987508898365');" style=""> 158          if (level &gt;= TRIM_MEMORY_BACKGROUND) {                                                                    </span>
<span class="-1508900837894417720" onmouseenter="enter('-1508900837894417720');" onmouseout="out('-1508900837894417720');" style=""> 159              if (!hasBusyDevice()) {                                                                               </span>
<span class="-905473446903257310" onmouseenter="enter('-905473446903257310');" onmouseout="out('-905473446903257310');" style=""> 160                  DBHelper.clearSession();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 162          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163      }                                                                                                             </span>
<span  style=""> 164                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 165      /**                                                                                                           </span>
<span class="-161433760836783242" onmouseenter="enter('-161433760836783242');" onmouseout="out('-161433760836783242');" style=""> 166       * Returns true if at least a single device is busy, e.g synchronizing activity data                          </span>
<span class="-2129897834961444137" onmouseenter="enter('-2129897834961444137');" onmouseout="out('-2129897834961444137');" style=""> 167       * or something similar.                                                                                      </span>
<span class="-1256941241338988665" onmouseenter="enter('-1256941241338988665');" onmouseout="out('-1256941241338988665');" style=""> 168       * Note: busy is not the same as connected or initialized!                                                    </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 169       */                                                                                                           </span>
<span class="3519322589467277707" onmouseenter="enter('3519322589467277707');" onmouseout="out('3519322589467277707');" style=""> 170      private boolean hasBusyDevice() {                                                                             </span>
<span class="5856043660353539159" onmouseenter="enter('5856043660353539159');" onmouseout="out('5856043660353539159');" style=""> 171          List&lt;GBDevice&gt; devices = getDeviceManager().getDevices();                                                 </span>
<span class="8782642673521208644" onmouseenter="enter('8782642673521208644');" onmouseout="out('8782642673521208644');" style=""> 172          for (GBDevice device : devices) {                                                                         </span>
<span class="552397664792329876" onmouseenter="enter('552397664792329876');" onmouseout="out('552397664792329876');" style=""> 173              if (device.isBusy()) {                                                                                </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 174                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 177          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178      }                                                                                                             </span>
<span  style=""> 179                                                                                                                    </span>
<span class="-3871637744395617929" onmouseenter="enter('-3871637744395617929');" onmouseout="out('-3871637744395617929');" style=""> 180      public static void setupLogging(boolean enabled) {                                                            </span>
<span class="2950542845093761665" onmouseenter="enter('2950542845093761665');" onmouseout="out('2950542845093761665');" style=""> 181          logging.setupLogging(enabled);                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182      }                                                                                                             </span>
<span  style=""> 183                                                                                                                    </span>
<span class="4192870835681485842" onmouseenter="enter('4192870835681485842');" onmouseout="out('4192870835681485842');" style=""> 184      private void setupExceptionHandler() {                                                                        </span>
<span class="8462359310625843573" onmouseenter="enter('8462359310625843573');" onmouseout="out('8462359310625843573');" style=""><abbr title=" 185          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler());"> 185          LoggingExceptionHandler handler = new LoggingExceptionHandler(Thread.getDefaultUncaughtExceptionHandler())🔵</abbr></span>
<span class="-8287053733639694554" onmouseenter="enter('-8287053733639694554');" onmouseout="out('-8287053733639694554');" style=""> 186          Thread.setDefaultUncaughtExceptionHandler(handler);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187      }                                                                                                             </span>
<span  style=""> 188                                                                                                                    </span>
<span class="4754947578823700086" onmouseenter="enter('4754947578823700086');" onmouseout="out('4754947578823700086');" style=""> 189      public static boolean isFileLoggingEnabled() {                                                                </span>
<span class="-3331889091025633732" onmouseenter="enter('-3331889091025633732');" onmouseout="out('-3331889091025633732');" style=""> 190          return prefs.getBoolean(&quot;log_to_file&quot;, false);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 191      }                                                                                                             </span>
<span  style=""> 192                                                                                                                    </span>
<span class="-4750710286909329427" onmouseenter="enter('-4750710286909329427');" onmouseout="out('-4750710286909329427');" style=""> 193      public static boolean minimizeNotification() {                                                                </span>
<span class="-4209592996267857305" onmouseenter="enter('-4209592996267857305');" onmouseout="out('-4209592996267857305');" style=""> 194          return prefs.getBoolean(&quot;minimize_priority&quot;, false);                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195      }                                                                                                             </span>
<span  style=""> 196                                                                                                                    </span>
<span class="-9123382081525140297" onmouseenter="enter('-9123382081525140297');" onmouseout="out('-9123382081525140297');" style=""> 197      static void setupDatabase(Context context) {                                                                  </span>
<span class="495848848502583738" onmouseenter="enter('495848848502583738');" onmouseout="out('495848848502583738');" style=""> 198          DBOpenHelper helper = new DBOpenHelper(context, DATABASE_NAME, null);                                     </span>
<span class="1042607168190791121" onmouseenter="enter('1042607168190791121');" onmouseout="out('1042607168190791121');" style=""> 199          SQLiteDatabase db = helper.getWritableDatabase();                                                         </span>
<span class="6507961655281342090" onmouseenter="enter('6507961655281342090');" onmouseout="out('6507961655281342090');" style=""> 200          DaoMaster daoMaster = new DaoMaster(db);                                                                  </span>
<span class="-3202302752613214492" onmouseenter="enter('-3202302752613214492');" onmouseout="out('-3202302752613214492');" style=""> 201          if (lockHandler == null) {                                                                                </span>
<span class="-603539593973792403" onmouseenter="enter('-603539593973792403');" onmouseout="out('-603539593973792403');" style=""> 202              lockHandler = new LockHandler();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 203          }                                                                                                         </span>
<span class="1541346282787338290" onmouseenter="enter('1541346282787338290');" onmouseout="out('1541346282787338290');" style=""> 204          lockHandler.init(daoMaster, helper);                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 205      }                                                                                                             </span>
<span  style=""> 206                                                                                                                    </span>
<span class="-1950614161317085577" onmouseenter="enter('-1950614161317085577');" onmouseout="out('-1950614161317085577');" style=""> 207      public static Context getContext() {                                                                          </span>
<span class="5912824651964420637" onmouseenter="enter('5912824651964420637');" onmouseout="out('5912824651964420637');" style=""> 208          return context;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 209      }                                                                                                             </span>
<span  style=""> 210                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 211      /**                                                                                                           </span>
<span class="406052821773125429" onmouseenter="enter('406052821773125429');" onmouseout="out('406052821773125429');" style=""> 212       * Returns the facade for talking to devices. Devices are managed by                                          </span>
<span class="1222088957697602265" onmouseenter="enter('1222088957697602265');" onmouseout="out('1222088957697602265');" style=""> 213       * an Android Service and this facade provides access to its functionality.                                   </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 214       *                                                                                                            </span>
<span class="-6858098882691141328" onmouseenter="enter('-6858098882691141328');" onmouseout="out('-6858098882691141328');" style=""> 215       * @return the facade for talking to the service/devices.                                                     </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 216       */                                                                                                           </span>
<span class="-6636943448324366934" onmouseenter="enter('-6636943448324366934');" onmouseout="out('-6636943448324366934');" style=""> 217      public static DeviceService deviceService() {                                                                 </span>
<span class="-7354642975754920169" onmouseenter="enter('-7354642975754920169');" onmouseout="out('-7354642975754920169');" style=""> 218          return deviceService;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 219      }                                                                                                             </span>
<span  style=""> 220                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 221      /**                                                                                                           </span>
<span class="-8219367387057506090" onmouseenter="enter('-8219367387057506090');" onmouseout="out('-8219367387057506090');" style=""> 222       * Returns the DBHandler instance for reading/writing or throws GBException                                   </span>
<span class="1362481699927282249" onmouseenter="enter('1362481699927282249');" onmouseout="out('1362481699927282249');" style=""> 223       * when that was not successful                                                                               </span>
<span class="8548348722043491324" onmouseenter="enter('8548348722043491324');" onmouseout="out('8548348722043491324');" style=""> 224       * If acquiring was successful, callers must call #releaseDB when they                                        </span>
<span class="8664537097537530933" onmouseenter="enter('8664537097537530933');" onmouseout="out('8664537097537530933');" style=""> 225       * are done (from the same thread that acquired the lock!                                                     </span>
<span class="4169512172915751358" onmouseenter="enter('4169512172915751358');" onmouseout="out('4169512172915751358');" style=""> 226       * &lt;p&gt;                                                                                                        </span>
<span class="-351362586305453410" onmouseenter="enter('-351362586305453410');" onmouseout="out('-351362586305453410');" style=""> 227       * Callers must not hold a reference to the returned instance because it                                      </span>
<span class="-6006330754066656278" onmouseenter="enter('-6006330754066656278');" onmouseout="out('-6006330754066656278');" style=""> 228       * will be invalidated at some point.                                                                         </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 229       *                                                                                                            </span>
<span class="8811837848714806322" onmouseenter="enter('8811837848714806322');" onmouseout="out('8811837848714806322');" style=""> 230       * @return the DBHandler                                                                                      </span>
<span class="1173013685970588399" onmouseenter="enter('1173013685970588399');" onmouseout="out('1173013685970588399');" style=""> 231       * @throws GBException                                                                                        </span>
<span class="-4861506863775770711" onmouseenter="enter('-4861506863775770711');" onmouseout="out('-4861506863775770711');" style=""> 232       * @see #releaseDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 233       */                                                                                                           </span>
<span class="-4984003598847853243" onmouseenter="enter('-4984003598847853243');" onmouseout="out('-4984003598847853243');" style=""> 234      public static DBHandler acquireDB() throws GBException {                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 235          try {                                                                                                     </span>
<span class="-7712895150301262974" onmouseenter="enter('-7712895150301262974');" onmouseout="out('-7712895150301262974');" style=""> 236              if (dbLock.tryLock(30, TimeUnit.SECONDS)) {                                                           </span>
<span class="9103432462993376054" onmouseenter="enter('9103432462993376054');" onmouseout="out('9103432462993376054');" style=""> 237                  return lockHandler;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 238              }                                                                                                     </span>
<span class="3493957724480568133" onmouseenter="enter('3493957724480568133');" onmouseout="out('3493957724480568133');" style=""> 239          } catch (InterruptedException ex) {                                                                       </span>
<span class="-6300383460786363972" onmouseenter="enter('-6300383460786363972');" onmouseout="out('-6300383460786363972');" style=""> 240              Log.i(TAG, &quot;Interrupted while waiting for DB lock&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 241          }                                                                                                         </span>
<span class="5293259304398378439" onmouseenter="enter('5293259304398378439');" onmouseout="out('5293259304398378439');" style=""> 242          throw new GBException(&quot;Unable to access the database.&quot;);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 243      }                                                                                                             </span>
<span  style=""> 244                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 245      /**                                                                                                           </span>
<span class="850434679602251273" onmouseenter="enter('850434679602251273');" onmouseout="out('850434679602251273');" style=""> 246       * Releases the database lock.                                                                                </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 247       *                                                                                                            </span>
<span class="2426030765714303667" onmouseenter="enter('2426030765714303667');" onmouseout="out('2426030765714303667');" style=""> 248       * @throws IllegalMonitorStateException if the current thread is not owning the lock                          </span>
<span class="-2997975059425877605" onmouseenter="enter('-2997975059425877605');" onmouseout="out('-2997975059425877605');" style=""> 249       * @see #acquireDB()                                                                                          </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 250       */                                                                                                           </span>
<span class="7923572183767073046" onmouseenter="enter('7923572183767073046');" onmouseout="out('7923572183767073046');" style=""> 251      public static void releaseDB() {                                                                              </span>
<span class="5375752470547299323" onmouseenter="enter('5375752470547299323');" onmouseout="out('5375752470547299323');" style=""> 252          dbLock.unlock();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 253      }                                                                                                             </span>
<span  style=""> 254                                                                                                                    </span>
<span class="-6149981994082820907" onmouseenter="enter('-6149981994082820907');" onmouseout="out('-6149981994082820907');" style=""> 255      public static boolean isRunningLollipopOrLater() {                                                            </span>
<span class="-449813020318729153" onmouseenter="enter('-449813020318729153');" onmouseout="out('-449813020318729153');" style=""> 256          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP;                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 257      }                                                                                                             </span>
<span  style=""> 258                                                                                                                    </span>
<span class="5246223441338207194" onmouseenter="enter('5246223441338207194');" onmouseout="out('5246223441338207194');" style=""> 259      public static boolean isRunningMarshmallowOrLater() {                                                         </span>
<span class="1440814087776293832" onmouseenter="enter('1440814087776293832');" onmouseout="out('1440814087776293832');" style=""> 260          return VERSION.SDK_INT &gt;= Build.VERSION_CODES.M;                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 261      }                                                                                                             </span>
<span  style=""> 262                                                                                                                    </span>
<span class="857630345198364068" onmouseenter="enter('857630345198364068');" onmouseout="out('857630345198364068');" style=""> 263      private static boolean isPrioritySender(int prioritySenders, String number) {                                 </span>
<span class="3608613859068535175" onmouseenter="enter('3608613859068535175');" onmouseout="out('3608613859068535175');" style=""> 264          if (prioritySenders == Policy.PRIORITY_SENDERS_ANY) {                                                     </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 265              return true;                                                                                          </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 266          } else {                                                                                                  </span>
<span class="5601221113118485943" onmouseenter="enter('5601221113118485943');" onmouseout="out('5601221113118485943');" style=""> 267              Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));                   </span>
<span class="-4924676386476628110" onmouseenter="enter('-4924676386476628110');" onmouseout="out('-4924676386476628110');" style=""> 268              String[] projection = new String[]{PhoneLookup._ID, PhoneLookup.STARRED};                             </span>
<span class="-2669433309324346164" onmouseenter="enter('-2669433309324346164');" onmouseout="out('-2669433309324346164');" style=""> 269              Cursor cursor = context.getContentResolver().query(uri, projection, null, null, null);                </span>
<span class="-8838545635375684706" onmouseenter="enter('-8838545635375684706');" onmouseout="out('-8838545635375684706');" style=""> 270              boolean exists = false;                                                                               </span>
<span class="1939368387188071046" onmouseenter="enter('1939368387188071046');" onmouseout="out('1939368387188071046');" style=""> 271              int starred = 0;                                                                                      </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 272              try {                                                                                                 </span>
<span class="-7074963311310704961" onmouseenter="enter('-7074963311310704961');" onmouseout="out('-7074963311310704961');" style=""> 273                  if (cursor != null &amp;&amp; cursor.moveToFirst()) {                                                     </span>
<span class="-3745469353240991600" onmouseenter="enter('-3745469353240991600');" onmouseout="out('-3745469353240991600');" style=""> 274                      exists = true;                                                                                </span>
<span class="3643998632725614603" onmouseenter="enter('3643998632725614603');" onmouseout="out('3643998632725614603');" style=""> 275                      starred = cursor.getInt(cursor.getColumnIndexOrThrow(PhoneLookup.STARRED));                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 276                  }                                                                                                 </span>
<span class="9062373144943479618" onmouseenter="enter('9062373144943479618');" onmouseout="out('9062373144943479618');" style=""> 277              } finally {                                                                                           </span>
<span class="-6884521933390835722" onmouseenter="enter('-6884521933390835722');" onmouseout="out('-6884521933390835722');" style=""> 278                  if (cursor != null) {                                                                             </span>
<span class="-598211251935134700" onmouseenter="enter('-598211251935134700');" onmouseout="out('-598211251935134700');" style=""> 279                      cursor.close();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 280                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 281              }                                                                                                     </span>
<span class="2185443498191377347" onmouseenter="enter('2185443498191377347');" onmouseout="out('2185443498191377347');" style=""> 282              if (prioritySenders == Policy.PRIORITY_SENDERS_CONTACTS &amp;&amp; exists) {                                  </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 283                  return true;                                                                                      </span>
<span class="-4757262264083326833" onmouseenter="enter('-4757262264083326833');" onmouseout="out('-4757262264083326833');" style=""> 284              } else if (prioritySenders == Policy.PRIORITY_SENDERS_STARRED &amp;&amp; starred == 1) {                      </span>
<span class="-3118901906653197100" onmouseenter="enter('-3118901906653197100');" onmouseout="out('-3118901906653197100');" style=""> 285                  return true;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 286              }                                                                                                     </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 287              return false;                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 288          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 289      }                                                                                                             </span>
<span  style=""> 290                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 291      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="6378402438787070019" onmouseenter="enter('6378402438787070019');" onmouseout="out('6378402438787070019');" style=""> 292      public static boolean isPriorityNumber(int priorityType, String number) {                                     </span>
<span class="379338103178194889" onmouseenter="enter('379338103178194889');" onmouseout="out('379338103178194889');" style=""> 293          NotificationManager.Policy notificationPolicy = notificationManager.getNotificationPolicy();              </span>
<span class="-4918631483329296684" onmouseenter="enter('-4918631483329296684');" onmouseout="out('-4918631483329296684');" style=""> 294          if (priorityType == Policy.PRIORITY_CATEGORY_MESSAGES) {                                                  </span>
<span class="4566630704153137223" onmouseenter="enter('4566630704153137223');" onmouseout="out('4566630704153137223');" style=""><abbr title=" 295              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CATEGORY_MESSAGES) {"> 295              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_MESSAGES) == Policy.PRIORITY_CAT🔵</abbr></span>
<span class="-3496973930039610364" onmouseenter="enter('-3496973930039610364');" onmouseout="out('-3496973930039610364');" style=""> 296                  return isPrioritySender(notificationPolicy.priorityMessageSenders, number);                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 297              }                                                                                                     </span>
<span class="-8257628256104336530" onmouseenter="enter('-8257628256104336530');" onmouseout="out('-8257628256104336530');" style=""> 298          } else if (priorityType == Policy.PRIORITY_CATEGORY_CALLS) {                                              </span>
<span class="-8212522030841768074" onmouseenter="enter('-8212522030841768074');" onmouseout="out('-8212522030841768074');" style=""><abbr title=" 299              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGORY_CALLS) {"> 299              if ((notificationPolicy.priorityCategories &amp; Policy.PRIORITY_CATEGORY_CALLS) == Policy.PRIORITY_CATEGO🔵</abbr></span>
<span class="-5487931469052316679" onmouseenter="enter('-5487931469052316679');" onmouseout="out('-5487931469052316679');" style=""> 300                  return isPrioritySender(notificationPolicy.priorityCallSenders, number);                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 301              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 302          }                                                                                                         </span>
<span class="-5432226360745882584" onmouseenter="enter('-5432226360745882584');" onmouseout="out('-5432226360745882584');" style=""> 303          return false;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 304      }                                                                                                             </span>
<span  style=""> 305                                                                                                                    </span>
<span class="7875015209262472316" onmouseenter="enter('7875015209262472316');" onmouseout="out('7875015209262472316');" style=""> 306      @TargetApi(Build.VERSION_CODES.M)                                                                             </span>
<span class="7382141910515743474" onmouseenter="enter('7382141910515743474');" onmouseout="out('7382141910515743474');" style=""> 307      public static int getGrantedInterruptionFilter() {                                                            </span>
<span class="-4864796436297161396" onmouseenter="enter('-4864796436297161396');" onmouseout="out('-4864796436297161396');" style=""> 308          if (prefs.getBoolean(&quot;notification_filter&quot;, false) &amp;&amp; GBApplication.isRunningMarshmallowOrLater()) {      </span>
<span class="-7162456311621088064" onmouseenter="enter('-7162456311621088064');" onmouseout="out('-7162456311621088064');" style=""> 309              if (notificationManager.isNotificationPolicyAccessGranted()) {                                        </span>
<span class="-192442873803741770" onmouseenter="enter('-192442873803741770');" onmouseout="out('-192442873803741770');" style=""> 310                  return notificationManager.getCurrentInterruptionFilter();                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 311              }                                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 312          }                                                                                                         </span>
<span class="2268331179451024566" onmouseenter="enter('2268331179451024566');" onmouseout="out('2268331179451024566');" style=""> 313          return NotificationManager.INTERRUPTION_FILTER_ALL;                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 314      }                                                                                                             </span>
<span  style=""> 315                                                                                                                    </span>
<span class="504195764522846272" onmouseenter="enter('504195764522846272');" onmouseout="out('504195764522846272');" style=""> 316      public static HashSet&lt;String&gt; blacklist = null;                                                               </span>
<span  style=""> 317                                                                                                                    </span>
<span class="3136809427715779853" onmouseenter="enter('3136809427715779853');" onmouseout="out('3136809427715779853');" style=""> 318      private static void loadBlackList() {                                                                         </span>
<span class="-4165545423449523865" onmouseenter="enter('-4165545423449523865');" onmouseout="out('-4165545423449523865');" style=""> 319          blacklist = (HashSet&lt;String&gt;) sharedPrefs.getStringSet(&quot;package_blacklist&quot;, null);                        </span>
<span class="3710122947239011739" onmouseenter="enter('3710122947239011739');" onmouseout="out('3710122947239011739');" style=""> 320          if (blacklist == null) {                                                                                  </span>
<span class="8704968985872011996" onmouseenter="enter('8704968985872011996');" onmouseout="out('8704968985872011996');" style=""> 321              blacklist = new HashSet&lt;&gt;();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 322          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 323      }                                                                                                             </span>
<span  style=""> 324                                                                                                                    </span>
<span class="-481433286634482934" onmouseenter="enter('-481433286634482934');" onmouseout="out('-481433286634482934');" style=""> 325      private static void saveBlackList() {                                                                         </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 326          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="4373063490515338158" onmouseenter="enter('4373063490515338158');" onmouseout="out('4373063490515338158');" style=""> 327          if (blacklist.isEmpty()) {                                                                                </span>
<span class="-7033385367321024850" onmouseenter="enter('-7033385367321024850');" onmouseout="out('-7033385367321024850');" style=""> 328              editor.putStringSet(&quot;package_blacklist&quot;, null);                                                       </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 329          } else {                                                                                                  </span>
<span class="3909103545192669113" onmouseenter="enter('3909103545192669113');" onmouseout="out('3909103545192669113');" style=""> 330              editor.putStringSet(&quot;package_blacklist&quot;, blacklist);                                                  </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 331          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 332          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 333      }                                                                                                             </span>
<span  style=""> 334                                                                                                                    </span>
<span class="-2779319696285586872" onmouseenter="enter('-2779319696285586872');" onmouseout="out('-2779319696285586872');" style=""> 335      public static void addToBlacklist(String packageName) {                                                       </span>
<span class="-1871256217611316970" onmouseenter="enter('-1871256217611316970');" onmouseout="out('-1871256217611316970');" style=""> 336          if (!blacklist.contains(packageName)) {                                                                   </span>
<span class="1292536329989809753" onmouseenter="enter('1292536329989809753');" onmouseout="out('1292536329989809753');" style=""> 337              blacklist.add(packageName);                                                                           </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 338              saveBlackList();                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 339          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 340      }                                                                                                             </span>
<span  style=""> 341                                                                                                                    </span>
<span class="616928146830467939" onmouseenter="enter('616928146830467939');" onmouseout="out('616928146830467939');" style=""> 342      public static synchronized void removeFromBlacklist(String packageName) {                                     </span>
<span class="-8340158867305867611" onmouseenter="enter('-8340158867305867611');" onmouseout="out('-8340158867305867611');" style=""> 343          blacklist.remove(packageName);                                                                            </span>
<span class="3407300167991166656" onmouseenter="enter('3407300167991166656');" onmouseout="out('3407300167991166656');" style=""> 344          saveBlackList();                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 345      }                                                                                                             </span>
<span  style=""> 346                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 347      /**                                                                                                           </span>
<span class="-1024739492088796652" onmouseenter="enter('-1024739492088796652');" onmouseout="out('-1024739492088796652');" style=""> 348       * Deletes both the old Activity database and the new one recreates it with empty tables.                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 349       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 350       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 351       */                                                                                                           </span>
<span class="7401422143281112207" onmouseenter="enter('7401422143281112207');" onmouseout="out('7401422143281112207');" style=""> 352      public static synchronized boolean deleteActivityDatabase(Context context) {                                  </span>
<span class="7000693892879411953" onmouseenter="enter('7000693892879411953');" onmouseout="out('7000693892879411953');" style=""> 353          // TODO: flush, close, reopen db                                                                          </span>
<span class="2613902002255270681" onmouseenter="enter('2613902002255270681');" onmouseout="out('2613902002255270681');" style=""> 354          if (lockHandler != null) {                                                                                </span>
<span class="5058666911274182462" onmouseenter="enter('5058666911274182462');" onmouseout="out('5058666911274182462');" style=""> 355              lockHandler.closeDb();                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 356          }                                                                                                         </span>
<span class="3822070642269235078" onmouseenter="enter('3822070642269235078');" onmouseout="out('3822070642269235078');" style=""> 357          boolean result = deleteOldActivityDatabase(context);                                                      </span>
<span class="-5716427167928771235" onmouseenter="enter('-5716427167928771235');" onmouseout="out('-5716427167928771235');" style=""> 358          result &amp;= getContext().deleteDatabase(DATABASE_NAME);                                                     </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 359          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 360      }                                                                                                             </span>
<span  style=""> 361                                                                                                                    </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style=""> 362      /**                                                                                                           </span>
<span class="2445251958463073439" onmouseenter="enter('2445251958463073439');" onmouseout="out('2445251958463073439');" style=""> 363       * Deletes the legacy (pre 0.12) Activity database                                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style=""> 364       *                                                                                                            </span>
<span class="-2328459712851452608" onmouseenter="enter('-2328459712851452608');" onmouseout="out('-2328459712851452608');" style=""> 365       * @return true on successful deletion                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style=""> 366       */                                                                                                           </span>
<span class="-4045301367723238628" onmouseenter="enter('-4045301367723238628');" onmouseout="out('-4045301367723238628');" style=""> 367      public static synchronized boolean deleteOldActivityDatabase(Context context) {                               </span>
<span class="-6732633968079085171" onmouseenter="enter('-6732633968079085171');" onmouseout="out('-6732633968079085171');" style=""> 368          DBHelper dbHelper = new DBHelper(context);                                                                </span>
<span class="5965466891229042999" onmouseenter="enter('5965466891229042999');" onmouseout="out('5965466891229042999');" style=""> 369          boolean result = true;                                                                                    </span>
<span class="-1531974482789838951" onmouseenter="enter('-1531974482789838951');" onmouseout="out('-1531974482789838951');" style=""> 370          if (dbHelper.existsDB(&quot;ActivityDatabase&quot;)) {                                                              </span>
<span class="-4697652899420479933" onmouseenter="enter('-4697652899420479933');" onmouseout="out('-4697652899420479933');" style=""> 371              result = getContext().deleteDatabase(&quot;ActivityDatabase&quot;);                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 372          }                                                                                                         </span>
<span class="-6419540350677864751" onmouseenter="enter('-6419540350677864751');" onmouseout="out('-6419540350677864751');" style=""> 373          return result;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 374      }                                                                                                             </span>
<span  style=""> 375                                                                                                                    </span>
<span class="7383866579133437876" onmouseenter="enter('7383866579133437876');" onmouseout="out('7383866579133437876');" style=""> 376      private int getPrefsFileVersion() {                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 377          try {                                                                                                     </span>
<span class="-4036254477438553305" onmouseenter="enter('-4036254477438553305');" onmouseout="out('-4036254477438553305');" style=""> 378              return Integer.parseInt(sharedPrefs.getString(PREFS_VERSION, &quot;0&quot;)); //0 is legacy                     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 379          } catch (Exception e) {                                                                                   </span>
<span class="8277887156933824539" onmouseenter="enter('8277887156933824539');" onmouseout="out('8277887156933824539');" style=""> 380              //in version 1 this was an int                                                                        </span>
<span class="6787741487180588680" onmouseenter="enter('6787741487180588680');" onmouseout="out('6787741487180588680');" style=""> 381              return 1;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 382          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 383      }                                                                                                             </span>
<span  style=""> 384                                                                                                                    </span>
<span class="-7450030736536174893" onmouseenter="enter('-7450030736536174893');" onmouseout="out('-7450030736536174893');" style=""> 385      private void migratePrefs(int oldVersion) {                                                                   </span>
<span class="6708800524954942548" onmouseenter="enter('6708800524954942548');" onmouseout="out('6708800524954942548');" style=""> 386          SharedPreferences.Editor editor = sharedPrefs.edit();                                                     </span>
<span class="-2644200031636506022" onmouseenter="enter('-2644200031636506022');" onmouseout="out('-2644200031636506022');" style=""> 387          switch (oldVersion) {                                                                                     </span>
<span class="-5990352835943936653" onmouseenter="enter('-5990352835943936653');" onmouseout="out('-5990352835943936653');" style=""> 388              case 0:                                                                                               </span>
<span class="-685662110494590154" onmouseenter="enter('-685662110494590154');" onmouseout="out('-685662110494590154');" style=""> 389                  String legacyGender = sharedPrefs.getString(&quot;mi_user_gender&quot;, null);                              </span>
<span class="6425923989101450597" onmouseenter="enter('6425923989101450597');" onmouseout="out('6425923989101450597');" style=""> 390                  String legacyHeight = sharedPrefs.getString(&quot;mi_user_height_cm&quot;, null);                           </span>
<span class="1488290843457672047" onmouseenter="enter('1488290843457672047');" onmouseout="out('1488290843457672047');" style=""> 391                  String legacyWeigth = sharedPrefs.getString(&quot;mi_user_weight_kg&quot;, null);                           </span>
<span class="4280374151227905704" onmouseenter="enter('4280374151227905704');" onmouseout="out('4280374151227905704');" style=""> 392                  String legacyYOB = sharedPrefs.getString(&quot;mi_user_year_of_birth&quot;, null);                          </span>
<span class="-9208900202213953563" onmouseenter="enter('-9208900202213953563');" onmouseout="out('-9208900202213953563');" style=""> 393                  if (legacyGender != null) {                                                                       </span>
<span class="-5465971217752234172" onmouseenter="enter('-5465971217752234172');" onmouseout="out('-5465971217752234172');" style=""> 394                      int gender = &quot;male&quot;.equals(legacyGender) ? 1 : &quot;female&quot;.equals(legacyGender) ? 0 : 2;         </span>
<span class="799211646181905585" onmouseenter="enter('799211646181905585');" onmouseout="out('799211646181905585');" style=""> 395                      editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(gender));                    </span>
<span class="1255271436224744626" onmouseenter="enter('1255271436224744626');" onmouseout="out('1255271436224744626');" style=""> 396                      editor.remove(&quot;mi_user_gender&quot;);                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 397                  }                                                                                                 </span>
<span class="-1946835822021296553" onmouseenter="enter('-1946835822021296553');" onmouseout="out('-1946835822021296553');" style=""> 398                  if (legacyHeight != null) {                                                                       </span>
<span class="-2299802317195801249" onmouseenter="enter('-2299802317195801249');" onmouseout="out('-2299802317195801249');" style=""> 399                      editor.putString(ActivityUser.PREF_USER_HEIGHT_CM, legacyHeight);                             </span>
<span class="-2529666311876181004" onmouseenter="enter('-2529666311876181004');" onmouseout="out('-2529666311876181004');" style=""> 400                      editor.remove(&quot;mi_user_height_cm&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 401                  }                                                                                                 </span>
<span class="-6566118167697987890" onmouseenter="enter('-6566118167697987890');" onmouseout="out('-6566118167697987890');" style=""> 402                  if (legacyWeigth != null) {                                                                       </span>
<span class="176955405818502330" onmouseenter="enter('176955405818502330');" onmouseout="out('176955405818502330');" style=""> 403                      editor.putString(ActivityUser.PREF_USER_WEIGHT_KG, legacyWeigth);                             </span>
<span class="-7267994962916796755" onmouseenter="enter('-7267994962916796755');" onmouseout="out('-7267994962916796755');" style=""> 404                      editor.remove(&quot;mi_user_weight_kg&quot;);                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 405                  }                                                                                                 </span>
<span class="4986330953457315756" onmouseenter="enter('4986330953457315756');" onmouseout="out('4986330953457315756');" style=""> 406                  if (legacyYOB != null) {                                                                          </span>
<span class="-459948623523417183" onmouseenter="enter('-459948623523417183');" onmouseout="out('-459948623523417183');" style=""> 407                      editor.putString(ActivityUser.PREF_USER_YEAR_OF_BIRTH, legacyYOB);                            </span>
<span class="-5051922747630165689" onmouseenter="enter('-5051922747630165689');" onmouseout="out('-5051922747630165689');" style=""> 408                      editor.remove(&quot;mi_user_year_of_birth&quot;);                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 409                  }                                                                                                 </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 410                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 411                  break;                                                                                            </span>
<span class="-1101904192611917292" onmouseenter="enter('-1101904192611917292');" onmouseout="out('-1101904192611917292');" style=""> 412              case 1:                                                                                               </span>
<span class="-3682724615942658025" onmouseenter="enter('-3682724615942658025');" onmouseout="out('-3682724615942658025');" style=""><abbr title=" 413                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the way Android accesses the shared preferences"> 413                  //migrate the integer version of gender introduced in version 1 to a string value, needed for the 🔵</abbr></span>
<span class="5965543307952398766" onmouseenter="enter('5965543307952398766');" onmouseout="out('5965543307952398766');" style=""> 414                  int legacyGender_1 = 2;                                                                           </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 415                  try {                                                                                             </span>
<span class="8229140128155873554" onmouseenter="enter('8229140128155873554');" onmouseout="out('8229140128155873554');" style=""> 416                      legacyGender_1 = sharedPrefs.getInt(ActivityUser.PREF_USER_GENDER, 2);                        </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 417                  } catch (Exception e) {                                                                           </span>
<span class="-324185773312201481" onmouseenter="enter('-324185773312201481');" onmouseout="out('-324185773312201481');" style=""> 418                      Log.e(TAG, &quot;Could not access legacy activity gender&quot;, e);                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 419                  }                                                                                                 </span>
<span class="4758254117848304045" onmouseenter="enter('4758254117848304045');" onmouseout="out('4758254117848304045');" style=""> 420                  editor.putString(ActivityUser.PREF_USER_GENDER, Integer.toString(legacyGender_1));                </span>
<span class="-3069564466671463779" onmouseenter="enter('-3069564466671463779');" onmouseout="out('-3069564466671463779');" style=""> 421                  //also silently migrate the version to a string value                                             </span>
<span class="548035526533389061" onmouseenter="enter('548035526533389061');" onmouseout="out('548035526533389061');" style=""> 422                  editor.putString(PREFS_VERSION, Integer.toString(CURRENT_PREFS_VERSION));                         </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 423                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 424          }                                                                                                         </span>
<span class="-5305612453340718340" onmouseenter="enter('-5305612453340718340');" onmouseout="out('-5305612453340718340');" style=""> 425          editor.apply();                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 426      }                                                                                                             </span>
<span  style=""> 427                                                                                                                    </span>
<span class="2549101936383900119" onmouseenter="enter('2549101936383900119');" onmouseout="out('2549101936383900119');" style=""> 428      public static LimitedQueue getIDSenderLookup() {                                                              </span>
<span class="6842437706753382405" onmouseenter="enter('6842437706753382405');" onmouseout="out('6842437706753382405');" style=""> 429          return mIDSenderLookup;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 430      }                                                                                                             </span>
<span  style=""> 431                                                                                                                    </span>
<span class="5055859242945147236" onmouseenter="enter('5055859242945147236');" onmouseout="out('5055859242945147236');" style=""> 432      public static boolean isDarkThemeEnabled() {                                                                  </span>
<span class="-4714421194763311527" onmouseenter="enter('-4714421194763311527');" onmouseout="out('-4714421194763311527');" style=""><abbr title=" 433          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(context.getString(R.string.pref_theme_value_dark));"> 433          return prefs.getString(&quot;pref_key_theme&quot;, context.getString(R.string.pref_theme_value_light)).equals(contex🔵</abbr></span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 434      }                                                                                                             </span>
<span  style=""> 435                                                                                                                    </span>
<span class="-3983755251685502689" onmouseenter="enter('-3983755251685502689');" onmouseout="out('-3983755251685502689');" style=""> 436      public static int getTextColor(Context context) {                                                             </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 437          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 438          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="-7709688280460062747" onmouseenter="enter('-7709688280460062747');" onmouseout="out('-7709688280460062747');" style=""> 439          theme.resolveAttribute(R.attr.textColorPrimary, typedValue, true);                                        </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 440          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 441      }                                                                                                             </span>
<span  style=""> 442                                                                                                                    </span>
<span class="8929846970030397242" onmouseenter="enter('8929846970030397242');" onmouseout="out('8929846970030397242');" style=""> 443      public static int getBackgroundColor(Context context) {                                                       </span>
<span class="-620576937326550340" onmouseenter="enter('-620576937326550340');" onmouseout="out('-620576937326550340');" style=""> 444          TypedValue typedValue = new TypedValue();                                                                 </span>
<span class="-5616952898610345643" onmouseenter="enter('-5616952898610345643');" onmouseout="out('-5616952898610345643');" style=""> 445          Resources.Theme theme = context.getTheme();                                                               </span>
<span class="2684716467975561103" onmouseenter="enter('2684716467975561103');" onmouseout="out('2684716467975561103');" style=""> 446          theme.resolveAttribute(android.R.attr.background, typedValue, true);                                      </span>
<span class="-7166981269032094936" onmouseenter="enter('-7166981269032094936');" onmouseout="out('-7166981269032094936');" style=""> 447          return typedValue.data;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 448      }                                                                                                             </span>
<span  style=""> 449                                                                                                                    </span>
<span class="-8798492707437243449" onmouseenter="enter('-8798492707437243449');" onmouseout="out('-8798492707437243449');" style=""> 450      public static Prefs getPrefs() {                                                                              </span>
<span class="-6648992582121346826" onmouseenter="enter('-6648992582121346826');" onmouseout="out('-6648992582121346826');" style=""> 451          return prefs;                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 452      }                                                                                                             </span>
<span  style=""> 453                                                                                                                    </span>
<span class="3764495162310400312" onmouseenter="enter('3764495162310400312');" onmouseout="out('3764495162310400312');" style=""> 454      public static GBPrefs getGBPrefs() {                                                                          </span>
<span class="7035561871246445740" onmouseenter="enter('7035561871246445740');" onmouseout="out('7035561871246445740');" style=""> 455          return gbPrefs;                                                                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 456      }                                                                                                             </span>
<span  style=""> 457                                                                                                                    </span>
<span class="-5781575054155404950" onmouseenter="enter('-5781575054155404950');" onmouseout="out('-5781575054155404950');" style=""> 458      public DeviceManager getDeviceManager() {                                                                     </span>
<span class="-5647905009531338323" onmouseenter="enter('-5647905009531338323');" onmouseout="out('-5647905009531338323');" style=""> 459          return deviceManager;                                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 460      }                                                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 461  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            