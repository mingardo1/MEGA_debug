<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>446</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        abbr {
                          /* Here is the delay */
                          transition-delay:0s;
                        }
                    </style>
              </head>
              <body>
                <span style="height: 4vh">
                    446
                    <a href="445.html">prev</a>
                    <a href="447.html">next</a>
                    <a href="446_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_610fdc3d9ff4e046a5b8153bddff49bedcea484e_core/src/main/java/com/dtstack/flink/sql/util/DateUtil.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;610fdc3d9ff4e046a5b8153bddff49bedcea484e:core/src/main/java/com/dtstack/flink/sql/util/DateUtil.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;610fdc3d9ff4e046a5b8153bddff49bedcea484e^1:core/src/main/java/com/dtstack/flink/sql/util/DateUtil.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;610fdc3d9ff4e046a5b8153bddff49bedcea484e^2:core/src/main/java/com/dtstack/flink/sql/util/DateUtil.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;ad272dee5efa5225fc0d8e1183144396b70f1315:core/src/main/java/com/dtstack/flink/sql/util/DateUtil.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[b]], subset: [[b]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 
  19 
  20 
  21 package com.dtstack.flink.sql.util;
  22 
  23 import java.sql.Timestamp;
  24 import java.text.ParseException;
  25 import java.text.SimpleDateFormat;
  26 import java.time.*;
  27 import java.time.format.DateTimeFormatter;
  28 import java.time.format.DateTimeParseException;
  29 import java.util.*;
  30 import java.util.regex.Pattern;
  31 
  32 import static java.time.format.DateTimeFormatter.ISO_INSTANT;
  33 
  34 
  35 /**
  36 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  37  * </span>
<span style="background-color: rgba(255, 167, 0, 0.24); margin: 0">  38  * Êó•ÊúüÂ∑•ÂÖ∑</span>
  39 ||||||| GitAnalyzerPlus_base
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  40 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  41 </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  42 /**</span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  43  * </span>
<span style="background-color: rgba(0, 0, 0, 0.15); margin: 0">  44  * Reason: TODO ADD REASON(ÂèØÈÄâ)</span>
  45 =======
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  46  *</span>
<span style="background-color: rgba(0, 0, 255, 0.24); margin: 0">  47  * Reason: TODO ADD REASON(ÂèØÈÄâ)</span>
  48 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs
  49  * Date: 2017Âπ¥03Êúà10Êó• ‰∏ãÂçà1:16:37
  50  * Company: www.dtstack.com
  51  * @author sishu.yss
  52  *
  53  */
  54 public class DateUtil {
  55 
<abbr title="  56     static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);">  56     static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ssüîµ</abbr>
  57     static final DateTimeFormatter DATE_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;);
  58     static final DateTimeFormatter TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;);
  59 
<abbr title="  60     private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3,9})?Z$&quot;);">  60     private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\üîµ</abbr>
  61     private static final Pattern DATE = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}$&quot;);
  62     private static final int MILLIS_PER_SECOND = 1000;
  63 
  64 
  65 
  66     public static java.sql.Date columnToDate(Object column) {
  67         if(column instanceof String) {
  68             return new java.sql.Date(stringToDate((String)column).getTime());
  69         } else if (column instanceof Integer) {
  70             Integer rawData = (Integer) column;
  71             return new java.sql.Date(rawData.longValue());
  72         } else if (column instanceof Long) {
  73             Long rawData = (Long) column;
  74             return new java.sql.Date(rawData.longValue());
  75         } else if (column instanceof java.sql.Date) {
  76             return (java.sql.Date) column;
  77         } else if(column instanceof Timestamp) {
  78             Timestamp ts = (Timestamp) column;
  79             return new java.sql.Date(ts.getTime());
  80         }
  81         throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
  82     }
  83 
  84     public static Date stringToDate(String strDate)  {
  85         if(strDate == null){
  86             return null;
  87         }
  88         try {
  89             ;
  90             return localDateTimetoDate(LocalDateTime.parse(strDate, DATE_TIME_FORMATTER));
  91         } catch (DateTimeParseException ignored) {
  92         }
  93 
  94         try {
  95             return localDateTimetoDate(LocalDate.parse(strDate, DATE_FORMATTER).atStartOfDay());
  96         } catch (DateTimeParseException ignored) {
  97         }
  98 
  99         try {
<abbr title=" 100             return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FORMATTER)));"> 100             return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FOüîµ</abbr>
 101         } catch (DateTimeParseException ignored) {
 102         }
 103 
 104         throw new RuntimeException(&quot;can&#x27;t parse date&quot;);
 105     }
 106 
 107     public static Date localDateTimetoDate(LocalDateTime localDateTime){
 108         return Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());
 109     }
 110 
 111     public static LocalDateTime dateToLocalDateTime(Date date){
 112         return date.toInstant().atZone(ZoneId.systemDefault()).toLocalDateTime();
 113     }
 114 
 115     /**
 116      *
 117      * 
 118      * @param day Long Êó∂Èó¥
 119      * @return long
 120      */
 121     public static long getTodayStart(long day) {
 122         long firstDay = 0L;
 123         Calendar cal = Calendar.getInstance();
 124         if ((&quot;&quot; + day).length() &gt; 10) {
 125             cal.setTime(new Date(day));
 126         } else {
 127             cal.setTime(new Date(day * 1000));
 128         }
 129         cal.set(Calendar.HOUR_OF_DAY, 0);
 130         cal.set(Calendar.MINUTE, 0);
 131         cal.set(Calendar.SECOND, 0);
 132         cal.set(Calendar.MILLISECOND, 0);
 133         firstDay = cal.getTimeInMillis() / 1000;
 134         return firstDay;
 135     }
 136 
 137     /**
 138      *
 139      * @param day Long Êó∂Èó¥
 140      * @param scope
 141      * @return
 142      */
 143     public static long getTodayStart(long day,String scope) {
 144         if(&quot;MS&quot;.equals(scope)){
 145             return getTodayStart(day)*1000;
 146         }else if(&quot;S&quot;.equals(scope)){
 147             return getTodayStart(day);
 148         }else{
 149             return getTodayStart(day);
 150         }
 151     }
 152 
 153     /**
 154      *
 155      * @param day Long Êó∂Èó¥
 156      * @return long
 157      */
 158     public static long getNextDayStart(long day) {
 159         long daySpanMill = 86400000L;
 160         long nextDay = 0L;
 161         Calendar cal = Calendar.getInstance();
 162         if ((&quot;&quot; + day).length() &gt; 10) {
 163             cal.setTime(new Date(day));
 164         } else {
 165             cal.setTime(new Date(day * 1000));
 166         }
 167         cal.set(Calendar.HOUR_OF_DAY, 0);
 168         cal.set(Calendar.MINUTE, 0);
 169         cal.set(Calendar.SECOND, 0);
 170         cal.set(Calendar.MILLISECOND, 0);
 171         nextDay = (cal.getTimeInMillis() + daySpanMill) / 1000;
 172         return nextDay;
 173     }
 174     
 175     /**
 176      *
 177      * @param day Long Êó∂Èó¥
 178      * @param scope String Á∫ßÂà´&lt;br&gt;&quot;MS&quot;ÔºöÊØ´ÁßíÁ∫ß&lt;br&gt;&quot;S&quot;:ÁßíÁ∫ß
 179      * @return
 180      */
 181     public static long getNextDayStart(long day,String scope) {
 182         if(&quot;MS&quot;.equals(scope)){
 183             return getNextDayStart(day)*1000;
 184         }else if(&quot;S&quot;.equals(scope)){
 185             return getNextDayStart(day);
 186         }else{
 187             return getNextDayStart(day);
 188         }
 189     }
 190 
 191 
 192     /**
 193      *
 194      * @param day
 195      * @return
 196      */
 197     public static long getMonthFirst(long day) {
 198         long firstDay = 0L;
 199         Calendar cal = Calendar.getInstance();
 200         cal.setTime(new Date(day * 1000));
 201         cal.set(Calendar.DAY_OF_MONTH, 1);
 202         cal.set(Calendar.HOUR_OF_DAY, 0);
 203         cal.set(Calendar.MINUTE, 0);
 204         cal.set(Calendar.SECOND, 0);
 205         cal.set(Calendar.MILLISECOND, 0);
 206         firstDay = cal.getTimeInMillis() / 1000;
 207         return firstDay;
 208     }
 209 
 210     /**
 211      * @param day
 212      * @return
 213      */
 214     public static int getMonth(long day) {
 215         Calendar cal = Calendar.getInstance();
 216         cal.setTime(new Date(day * 1000));
 217         return cal.get(Calendar.MONTH) + 1;
 218     }
 219 
 220     /**
 221      *
 222      * @author yumo.lck
 223      */
 224     public static int getYear(long day) {
 225         Calendar cal = Calendar.getInstance();
 226         cal.setTime(new Date(day * 1000));
 227         return cal.get(Calendar.YEAR);
 228     }
 229 
 230     /**
 231      *
 232      * @param day
 233      * @return
 234      */
 235     public static long getWeekFirst(long day) {
 236         long firstDay = 0L;
 237         Calendar cal = Calendar.getInstance();
 238         cal.setTime(new Date(day * 1000));
 239         cal.setFirstDayOfWeek(Calendar.MONDAY);
 240         cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
 241         cal.set(Calendar.HOUR_OF_DAY, 0);
 242         cal.set(Calendar.MINUTE, 0);
 243         cal.set(Calendar.SECOND, 0);
 244         cal.set(Calendar.MILLISECOND, 0);
 245         firstDay = cal.getTimeInMillis() / 1000;
 246         return firstDay;
 247     }
 248 
 249     /**
 250      * Ê†πÊçÆÊüê‰∏™Êó•ÊúüÊó∂Èó¥Êà≥ÁßíÂÄºÔºåËé∑ÂèñÊâÄÂú®Âë®Âú®‰∏ÄÂπ¥‰∏≠ÊòØÁ¨¨Âá†Âë®.
 251      *
 252      * @param day
 253      * @return
 254      */
 255     public static int getWeekOfYear(long day) {
 256         Calendar cal = Calendar.getInstance();
 257         cal.setTime(new Date(day * 1000));
 258         return cal.get(Calendar.WEEK_OF_YEAR);
 259     }
 260 
 261     /**
 262      *
 263      * @param day
 264      * @param inFormat
 265      * @param outFormat
 266      * @return String
 267      * @throws ParseException
 268      */
 269     public static String getYesterdayByString(String day, String inFormat, String outFormat){
 270         try {
 271             SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 272             Date date = sdf.parse(day);
 273             Calendar calendar = Calendar.getInstance();
 274             calendar.setTime(date);
 275             int calendarDay = calendar.get(Calendar.DATE);
 276             calendar.set(Calendar.DATE, calendarDay - 1);
 277             String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 278             return dayBefore;
 279         } catch (ParseException e) {
 280             return null;
 281         }
 282     }
 283 
 284     /**
 285      *
 286      * @param day
 287      * @param inFormat
 288      * @param outFormat
 289      * @return String
 290      * @throws ParseException
 291      */
<abbr title=" 292     public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseException {"> 292     public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseEüîµ</abbr>
 293         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 294         Date date = sdf.parse(day);
 295         Calendar calendar = Calendar.getInstance();
 296         calendar.setTime(date);
 297         int calendarDay = calendar.get(Calendar.DATE);
 298         calendar.set(Calendar.DATE, calendarDay + 1);
 299         String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 300         return dayBefore;
 301     }
 302 
 303     /**
 304      *
 305      * @param date
 306      * @return Date
 307      * @throws ParseException
 308      */
 309     public static Date getTomorrowByDate(Date date) throws ParseException {
 310         Calendar calendar = Calendar.getInstance();
 311         calendar.setTime(date);
 312         int calendarDay = calendar.get(Calendar.DATE);
 313         calendar.set(Calendar.DATE, calendarDay + 1);
 314         return calendar.getTime();
 315     }
 316 
 317     /**
 318      *
 319      * @param day
 320      * @param inFormat
 321      * @param outFormat
 322      * @return String
 323      * @throws ParseException
 324      */
<abbr title=" 325     public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws ParseException {"> 325     public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws Paüîµ</abbr>
 326         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 327         Date date = sdf.parse(day);
 328         Calendar calendar = Calendar.getInstance();
 329         calendar.setTime(date);
 330         int calendarDay = calendar.get(Calendar.DATE);
 331         calendar.set(Calendar.DATE, calendarDay - 30);
 332         return new SimpleDateFormat(outFormat).format(calendar.getTime());
 333     }
 334 
 335     /**
 336      *
 337      * @param day
 338      * @param inFormat
 339      * @param outFormat
 340      * @return String
 341      * @throws ParseException
 342      */
<abbr title=" 343     public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws ParseException {"> 343     public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws Parüîµ</abbr>
 344         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 345         Date date = sdf.parse(day);
 346         Calendar calendar = Calendar.getInstance();
 347         calendar.setTime(date);
 348         int calendarDay = calendar.get(Calendar.DATE);
 349         calendar.set(Calendar.DATE, calendarDay + 30);
 350         String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 351         return dayBefore;
 352     }
 353 
 354 
 355     /**
 356      *
 357      * @param day
 358      * @param inFormat
 359      * @param outFormat
 360      * @return String
 361      * @throws ParseException
 362      */
<abbr title=" 363     public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseException {"> 363     public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseExüîµ</abbr>
 364         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 365         Date date = sdf.parse(day);
 366         Calendar calendar = Calendar.getInstance();
 367         calendar.setTime(date);
 368         String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 369         return dayBefore;
 370     }
 371 
 372     public static long getDateMillToFormat(String day, String inFormat) throws ParseException {
 373         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 374         Date date = sdf.parse(day);
 375         Calendar calendar = Calendar.getInstance();
 376         calendar.setTime(date);
 377         return calendar.getTimeInMillis()/1000;
 378     }
 379 
 380     /**
 381      *
 382      * @author sishu.yss
 383      * @param year
 384      * @param month
 385      * @return
 386      */
 387     public static long getFirstDay4Month(int year, int month) {
 388         long firstDay = 0L;
 389         Calendar cal = Calendar.getInstance();
 390         cal.set(Calendar.YEAR, year);
 391         cal.set(Calendar.MONTH, month - 1);
 392         cal.set(Calendar.DAY_OF_MONTH, 1);
 393         cal.set(Calendar.HOUR_OF_DAY, 0);
 394         cal.set(Calendar.MINUTE, 0);
 395         cal.set(Calendar.SECOND, 0);
 396         cal.set(Calendar.MILLISECOND, 0);
 397         firstDay = cal.getTimeInMillis() / 1000;
 398         return firstDay;
 399     }
 400 
 401     /**
 402      *
 403      * @author yumo.lck
 404      * @param year
 405      * @param month
 406      * @return
 407      */
 408     public static long getLastDay4Month(int year, int month) {
 409         long lastDay = 0L;
 410         Calendar cal = Calendar.getInstance();
 411         cal.set(Calendar.YEAR, year);
 412         cal.set(Calendar.MONTH, month);
<abbr title=" 413         //1 represents a zero next month, can be seen as the end of the first day of the month most one day, but the data table on the last day of the zero point on the line"> 413         //1 represents a zero next month, can be seen as the end of the first day of the month most one düîµ</abbr>
 414         cal.set(Calendar.DAY_OF_MONTH, 0);
 415         cal.set(Calendar.HOUR_OF_DAY, 0);
 416         cal.set(Calendar.MINUTE, 0);
 417         cal.set(Calendar.SECOND, 0);
 418         cal.set(Calendar.MILLISECOND, 0);
 419         lastDay = cal.getTimeInMillis() / 1000;
 420         return lastDay;
 421     }
 422 
 423     /**
 424      *
 425      * @author yumo.lck
 426      * @param chooseFirstDay
 427      */
 428 
 429     public static long getBeforeMonthDay(long day, boolean chooseFirstDay) {
 430         long chooseDay = 0L;
 431         int currentMonth = getMonth(day);
 432         int currentYear = getYear(day);
 433         if (currentMonth &gt; 1) {
 434             currentMonth--;
 435         } else {
 436             currentYear--;
 437             currentMonth = 12;
 438         }
 439         if (chooseFirstDay) {
 440             chooseDay = getFirstDay4Month(currentYear, currentMonth);
 441             return chooseDay;
 442         } else {
 443             chooseDay = getLastDay4Month(currentYear, currentMonth);
 444             return chooseDay;
 445         }
 446 
 447     }
 448 
 449     /**
 450      * @return long
 451      */
 452     public static long getMillByOneDay() {
 453         Calendar cal = Calendar.getInstance();
 454         cal.set(Calendar.HOUR_OF_DAY, 0);
 455         cal.set(Calendar.MINUTE, 0);
 456         cal.set(Calendar.SECOND, 0);
 457         cal.set(Calendar.MILLISECOND, 0);
 458         return cal.getTimeInMillis() / 1000;
 459     }
 460 
 461     /**
 462      *
 463      * @return long
 464      */
 465     public static long getMillByYesDay() {
 466         Calendar cal = Calendar.getInstance();
 467         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 1);
 468         cal.set(Calendar.HOUR_OF_DAY, 0);
 469         cal.set(Calendar.MINUTE, 0);
 470         cal.set(Calendar.SECOND, 0);
 471         cal.set(Calendar.MILLISECOND, 0);
 472         return cal.getTimeInMillis() / 1000;
 473     }
 474 
 475     /**
 476      *
 477      * @return
 478      */
 479     public static long getMillByLastWeekDay() {
 480         Calendar cal = Calendar.getInstance();
 481         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 7);
 482         cal.set(Calendar.HOUR_OF_DAY, 0);
 483         cal.set(Calendar.MINUTE, 0);
 484         cal.set(Calendar.SECOND, 0);
 485         cal.set(Calendar.MILLISECOND, 0);
 486         return cal.getTimeInMillis() / 1000;
 487     }
 488 
 489     /**
 490      * @return long
 491      */
 492     public static long getMillByDay(int severalDays,String condition) {
 493         int dateT=0;
 494         Calendar cal = Calendar.getInstance();
 495         if(condition==null){
 496             return getMillToDay(cal,dateT);
 497         }
 498         if(&quot;-&quot;.equals(condition)){
 499             dateT = (cal.get(Calendar.DATE) - severalDays);
 500             return getMillToDay(cal,dateT);
 501         }
 502         if(&quot;+&quot;.equals(condition)){
 503             dateT = (cal.get(Calendar.DATE) + severalDays);
 504             return getMillToDay(cal,dateT);
 505         }
 506         return getMillToDay(cal,dateT);
 507     }
 508 
 509     /**
 510      * @return long
 511      */
 512     public static long getStampByDay(int severalDays,String condition) {
 513         int dateT=0;
 514         Calendar cal = Calendar.getInstance();
 515         if(condition==null){
 516             return getStampToDay(cal,dateT);
 517         }
 518         if(&quot;-&quot;.equals(condition)){
 519             dateT = (cal.get(Calendar.DATE) - severalDays);
 520             return getStampToDay(cal,dateT);
 521         }
 522         if(&quot;+&quot;.equals(condition)){
 523             dateT = (cal.get(Calendar.DATE) + severalDays);
 524             return getStampToDay(cal,dateT);
 525         }
 526         return getStampToDay(cal,dateT);
 527     }
 528     /**
 529      * @return long
 530      */
 531     public static long getMillByDay(){
 532         return getMillByDay(0,null);
 533     }
 534 
 535     /**
 536      * @param cal  Calendar
 537      * @param dateT Integer
 538      * @return  long
 539      */
 540     public static long getMillToDay(Calendar cal,int dateT){
 541         if(dateT!=0){
 542             cal.set(Calendar.DATE, dateT);
 543         }
 544         cal.set(Calendar.HOUR_OF_DAY, 0);
 545         cal.set(Calendar.MINUTE, 0);
 546         cal.set(Calendar.SECOND, 0);
 547         cal.set(Calendar.MILLISECOND, 0);
 548         return cal.getTimeInMillis()/1000;
 549     }
 550 
 551     /**
 552      * @param cal  Calendar
 553      * @param dateT Integer
 554      * @return  long
 555      */
 556     public static long getStampToDay(Calendar cal,int dateT){
 557         if(dateT!=0){
 558             cal.set(Calendar.DATE, dateT);
 559         }
 560         return cal.getTimeInMillis();
 561     }
 562 
 563     public static String getToday() {
 564         Calendar cal = Calendar.getInstance();
 565         return cal.get(1) + &quot;Âπ¥&quot; + cal.get(2) + &quot;Êúà&quot; + cal.get(3) + &quot;Êó•&quot;;
 566     }
 567 
 568     /**
 569      * @param day
 570      * @return format time
 571      */
 572     public static String getDate(long day, String format) {
 573         Calendar cal = Calendar.getInstance();
 574         if ((&quot;&quot; + day).length() &gt; 10) {
 575             cal.setTime(new Date(day));
 576         } else {
 577             cal.setTime(new Date(day * 1000));
 578         }
 579         SimpleDateFormat sf = new SimpleDateFormat(format);
 580         return sf.format(cal.getTime());
 581     }
 582 
 583     /**
 584      *
 585      * @param  date
 586      * @return
 587      */
 588     public static String getDate(Date date, String format) {
 589         SimpleDateFormat sf = new SimpleDateFormat(format);
 590         return sf.format(date);
 591     }
 592 
 593 
 594     /**
 595      *
 596      * @param day
 597      * @param format
 598      * @return long
 599      * @throws ParseException
 600      */
 601     public static long stringToLong(String day, String format) throws ParseException {
 602         SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 603         long date = dateFormat.parse(day).getTime();
 604         return date;
 605     }
 606 
 607     /**
 608      * @param day
 609      * @param format
 610      * @return Date
 611      * @throws ParseException
 612      */
 613     public static Date stringToDate(String day, String format)  {
 614         try {
 615             SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 616             Date date = dateFormat.parse(day);
 617             return date;
 618         } catch (ParseException e) {
 619             return new Date();
 620         }
 621     }
 622 
 623 
 624     /**
 625      * longÂûãÊó∂Èó¥Êà≥ËΩ¨‰∏∫StringÂûã
 626      *
 627      * @param day Áßí
 628      * @return Ê†ºÂºèÂåñÂêéÁöÑÊó•Êúü
 629      * @throws ParseException
 630      */
 631     public static String longToString(long day, String format) throws ParseException {
 632         if ((&quot;&quot; + day).length() &lt;= 10){
 633             day=day*1000;
 634         }
 635         SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 636         String date = dateFormat.format(day);
 637         return date;
 638     }
 639 
 640     /**
 641      *
 642      * @param day Áßí
 643      * @param minusDay ÈúÄË¶ÅÂáèÊéâÁöÑÂ§©Êï∞
 644      * @return Áßí
 645      */
 646     public static int getMinusDate(int day, int minusDay) {
 647         Calendar cal = Calendar.getInstance();
 648         cal.setTime(new Date(day * 1000));
 649         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - minusDay);
 650         cal.set(Calendar.HOUR_OF_DAY, 0);
 651         cal.set(Calendar.MINUTE, 0);
 652         cal.set(Calendar.SECOND, 0);
 653         cal.set(Calendar.MILLISECOND, 0);
 654         return (int) cal.getTimeInMillis() / 1000;
 655     }
 656 
 657     /**
 658      *
 659      * @return long
 660      */
 661     public static long getMillByNow() {
 662         Calendar cal = Calendar.getInstance();
 663         cal.setTime(new Date());
 664         return cal.getTimeInMillis();
 665     }
 666 
 667     public static int getWeeksBetweenTwoDates(long startDay, long endDay) {
 668         int week = getWeekOfYear(endDay) - getWeekOfYear(startDay) + 1;
 669         if(week&lt;1){
 670             week = getWeekOfYear(endDay) + getMaxWeekOfYear(startDay) - getWeekOfYear(startDay) + 1;
 671         }
 672         return week;
 673     }
 674 
 675     public static int getMaxWeekOfYear(long startDay) {
 676         Calendar cal = Calendar.getInstance();
 677         cal.setTime(new Date(startDay * 1000));
 678         return cal.getMaximum(Calendar.WEEK_OF_YEAR);
 679     }
 680 
 681     public static int getMonthsBetweenTwoDates(long startDay, long endDay) {
 682         int month = DateUtil.getMonth(endDay) - DateUtil.getMonth(startDay) + 1;
 683         if(month&lt;1){
 684             month = getMonth(endDay) + 12 - getMonth(startDay) +1;
 685         }
 686         return month;
 687     }
 688 
 689     public static Date parseDate(String dateStr, String pattern){
 690         SimpleDateFormat sdf = new SimpleDateFormat();
 691         sdf.applyPattern(pattern);
 692         try {
 693             return sdf.parse(dateStr);
 694         } catch (ParseException e) {
 695             return null;
 696         }
 697     }
 698 
 699     /**
 700      *
 701      * @param time Long Êó∂Èó¥
 702      * @return long
 703      */
 704     public static long getMinuteStart(long time) {
 705         long firstDay = 0L;
 706         Calendar cal = Calendar.getInstance();
 707         if ((&quot;&quot; + time).length() &gt; 10) {
 708             cal.setTime(new Date(time));
 709         } else {
 710             cal.setTime(new Date(time * 1000));
 711         }
 712         cal.set(Calendar.SECOND, 0);
 713         cal.set(Calendar.MILLISECOND, 0);
 714         firstDay = cal.getTimeInMillis() / 1000;
 715         return firstDay;
 716     }
 717 
 718     /**
 719      * @param time Long
 720      * @return long
 721      */
 722     public static long getHourStart(long time) {
 723         long firstDay = 0L;
 724         Calendar cal = Calendar.getInstance();
 725         if ((&quot;&quot; + time).length() &gt; 10) {
 726             cal.setTime(new Date(time));
 727         } else {
 728             cal.setTime(new Date(time * 1000));
 729         }
 730         cal.set(Calendar.SECOND, 0);
 731         cal.set(Calendar.MILLISECOND, 0);
 732         cal.set(Calendar.MINUTE, 0);
 733         firstDay = cal.getTimeInMillis() / 1000;
 734         return firstDay;
 735     }
 736 
 737     /**
 738      * @param time
 739      * @return Date
 740      */
 741     public static Date getDateByLong(long time){
 742         Date date = new Date();
 743         date.setTime(time);
 744         return date;
 745     }
 746 
 747 
 748     public static Date parseDate(String dateStr, String pattern, Locale locale){
 749         SimpleDateFormat df = new SimpleDateFormat(
 750                 pattern, locale);
 751 
 752         df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));
 753         try {
 754             return df.parse(dateStr);
 755         } catch (ParseException e) {
 756             return null;
 757         }
 758     }
 759 
 760     public static String getDate(Date date, String format, Locale locale) {
 761         SimpleDateFormat df = new SimpleDateFormat(
 762                 format, locale);
 763         df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));
 764         return df.format(date);
 765     }
 766 
 767     public static java.sql.Timestamp columnToTimestamp(Object column) {
 768         if (column == null) {
 769             return null;
 770         } else if(column instanceof String) {
 771             return new java.sql.Timestamp(stringToDate((String)column).getTime());
 772         } else if (column instanceof Integer) {
 773             Integer rawData = (Integer) column;
 774             return new java.sql.Timestamp(rawData.longValue());
 775         } else if (column instanceof Long) {
 776             Long rawData = (Long) column;
 777             return new java.sql.Timestamp(rawData.longValue());
 778         } else if (column instanceof java.sql.Date) {
 779             return (java.sql.Timestamp) column;
 780         } else if(column instanceof Timestamp) {
 781             return (Timestamp) column;
 782         } else if(column instanceof Date) {
 783             Date d = (Date)column;
 784             return new java.sql.Timestamp(d.getTime());
 785         }
 786 
 787         throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
 788     }
 789 
 790     public static String dateToString(Date date) {
 791         LocalDateTime localDateTime = dateToLocalDateTime(date);
 792         return localDateTime.format(DATE_FORMATTER);
 793     }
 794 
 795     public static String timestampToString(Date date) {
 796         LocalDateTime localDateTime = dateToLocalDateTime(date);
 797         return localDateTime.format(DATE_TIME_FORMATTER);
 798     }
 799 
 800     public static Timestamp getTimestampFromStr(String timeStr) {
 801         if (DATETIME.matcher(timeStr).matches()) {
 802             Instant instant = Instant.from(ISO_INSTANT.parse(timeStr));
 803             return new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);
 804         }
 805         return new Timestamp(stringToDate(timeStr).getTime());
 806     }
 807 
 808     public static java.sql.Date getDateFromStr(String dateStr) {
 809         if (DATE.matcher(dateStr).matches()) {
<abbr title=" 810             Instant instant = LocalDate.parse(dateStr).atTime(LocalTime.of(0, 0, 0, 0)).toInstant(ZoneOffset.UTC);"> 810             Instant instant = LocalDate.parse(dateStr).atTime(LocalTime.of(0, 0, 0, 0)).toInstant(ZoneOffüîµ</abbr>
 811             int offset = TimeZone.getDefault().getOffset(instant.toEpochMilli());
 812             return new java.sql.Date(instant.toEpochMilli() - offset);
 813         } else if (DATETIME.matcher(dateStr).matches()) {
 814             Instant instant = Instant.from(ISO_INSTANT.parse(dateStr));
 815             return new java.sql.Date(instant.toEpochMilli());
 816         }
 817         return new java.sql.Date(stringToDate(dateStr).getTime());
 818     }
 819     
 820 }</pre></td>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 
  19 
  20 
  21 package com.dtstack.flink.sql.util;
  22 
  23 import java.sql.Timestamp;
  24 import java.text.ParseException;
  25 import java.text.SimpleDateFormat;
  26 import java.time.*;
  27 import java.time.format.DateTimeFormatter;
  28 import java.time.format.DateTimeParseException;
  29 import java.util.*;
  30 import java.util.regex.Pattern;
  31 
  32 import static java.time.format.DateTimeFormatter.ISO_INSTANT;
  33 
  34 
  35 /**
  36  *
  37  * Êó•ÊúüÂ∑•ÂÖ∑
  38  * Date: 2017Âπ¥03Êúà10Êó• ‰∏ãÂçà1:16:37
  39  * Company: www.dtstack.com
  40  * @author sishu.yss
  41  *
  42  */
  43 public class DateUtil {
  44 
<abbr title="  45     static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);">  45     static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ssüîµ</abbr>
  46     static final DateTimeFormatter DATE_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;);
  47     static final DateTimeFormatter TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;);
  48 
<abbr title="  49     private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3,9})?Z$&quot;);">  49     private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\üîµ</abbr>
  50     private static final Pattern DATE = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}$&quot;);
  51     private static final int MILLIS_PER_SECOND = 1000;
  52 
  53 
  54 
  55     public static java.sql.Date columnToDate(Object column) {
  56         if(column instanceof String) {
  57             return new java.sql.Date(stringToDate((String)column).getTime());
  58         } else if (column instanceof Integer) {
  59             Integer rawData = (Integer) column;
  60             return new java.sql.Date(rawData.longValue());
  61         } else if (column instanceof Long) {
  62             Long rawData = (Long) column;
  63             return new java.sql.Date(rawData.longValue());
  64         } else if (column instanceof java.sql.Date) {
  65             return (java.sql.Date) column;
  66         } else if(column instanceof Timestamp) {
  67             Timestamp ts = (Timestamp) column;
  68             return new java.sql.Date(ts.getTime());
  69         }
  70         throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
  71     }
  72 
  73     public static Date stringToDate(String strDate)  {
  74         if(strDate == null){
  75             return null;
  76         }
  77         try {
  78             ;
  79             return localDateTimetoDate(LocalDateTime.parse(strDate, DATE_TIME_FORMATTER));
  80         } catch (DateTimeParseException ignored) {
  81         }
  82 
  83         try {
  84             return localDateTimetoDate(LocalDate.parse(strDate, DATE_FORMATTER).atStartOfDay());
  85         } catch (DateTimeParseException ignored) {
  86         }
  87 
  88         try {
<abbr title="  89             return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FORMATTER)));">  89             return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FOüîµ</abbr>
  90         } catch (DateTimeParseException ignored) {
  91         }
  92 
  93         throw new RuntimeException(&quot;can&#x27;t parse date&quot;);
  94     }
  95 
  96     public static Date localDateTimetoDate(LocalDateTime localDateTime){
  97         return Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());
  98     }
  99 
 100     public static LocalDateTime dateToLocalDateTime(Date date){
 101         return date.toInstant().atZone(ZoneId.systemDefault()).toLocalDateTime();
 102     }
 103 
 104     /**
 105      *
 106      *
 107      * @param day Long Êó∂Èó¥
 108      * @return long
 109      */
 110     public static long getTodayStart(long day) {
 111         long firstDay = 0L;
 112         Calendar cal = Calendar.getInstance();
 113         if ((&quot;&quot; + day).length() &gt; 10) {
 114             cal.setTime(new Date(day));
 115         } else {
 116             cal.setTime(new Date(day * 1000));
 117         }
 118         cal.set(Calendar.HOUR_OF_DAY, 0);
 119         cal.set(Calendar.MINUTE, 0);
 120         cal.set(Calendar.SECOND, 0);
 121         cal.set(Calendar.MILLISECOND, 0);
 122         firstDay = cal.getTimeInMillis() / 1000;
 123         return firstDay;
 124     }
 125 
 126     /**
 127      *
 128      * @param day Long Êó∂Èó¥
 129      * @param scope
 130      * @return
 131      */
 132     public static long getTodayStart(long day,String scope) {
 133     	if(&quot;MS&quot;.equals(scope)){
 134     		return getTodayStart(day)*1000;
 135     	}else if(&quot;S&quot;.equals(scope)){
 136     		return getTodayStart(day);
 137     	}else{
 138     		return getTodayStart(day);
 139     	}
 140     }
 141 
 142     /**
 143      *
 144      * @param day Long Êó∂Èó¥
 145      * @return long
 146      */
 147     public static long getNextDayStart(long day) {
 148         long daySpanMill = 86400000L;
 149         long nextDay = 0L;
 150         Calendar cal = Calendar.getInstance();
 151         if ((&quot;&quot; + day).length() &gt; 10) {
 152             cal.setTime(new Date(day));
 153         } else {
 154             cal.setTime(new Date(day * 1000));
 155         }
 156         cal.set(Calendar.HOUR_OF_DAY, 0);
 157         cal.set(Calendar.MINUTE, 0);
 158         cal.set(Calendar.SECOND, 0);
 159         cal.set(Calendar.MILLISECOND, 0);
 160         nextDay = (cal.getTimeInMillis() + daySpanMill) / 1000;
 161         return nextDay;
 162     }
 163 
 164     /**
 165      *
 166      * @param day Long Êó∂Èó¥
 167      * @param scope String Á∫ßÂà´&lt;br&gt;&quot;MS&quot;ÔºöÊØ´ÁßíÁ∫ß&lt;br&gt;&quot;S&quot;:ÁßíÁ∫ß
 168      * @return
 169      */
 170     public static long getNextDayStart(long day,String scope) {
 171     	if(&quot;MS&quot;.equals(scope)){
 172     		return getNextDayStart(day)*1000;
 173     	}else if(&quot;S&quot;.equals(scope)){
 174     		return getNextDayStart(day);
 175     	}else{
 176     		return getNextDayStart(day);
 177     	}
 178     }
 179 
 180 
 181     /**
 182      *
 183      * @param day
 184      * @return
 185      */
 186     public static long getMonthFirst(long day) {
 187         long firstDay = 0L;
 188         Calendar cal = Calendar.getInstance();
 189         cal.setTime(new Date(day * 1000));
 190         cal.set(Calendar.DAY_OF_MONTH, 1);
 191         cal.set(Calendar.HOUR_OF_DAY, 0);
 192         cal.set(Calendar.MINUTE, 0);
 193         cal.set(Calendar.SECOND, 0);
 194         cal.set(Calendar.MILLISECOND, 0);
 195         firstDay = cal.getTimeInMillis() / 1000;
 196         return firstDay;
 197     }
 198 
 199     /**
 200      * @param day
 201      * @return
 202      */
 203     public static int getMonth(long day) {
 204         Calendar cal = Calendar.getInstance();
 205         cal.setTime(new Date(day * 1000));
 206         return cal.get(Calendar.MONTH) + 1;
 207     }
 208 
 209     /**
 210      *
 211      * @author yumo.lck
 212      */
 213     public static int getYear(long day) {
 214         Calendar cal = Calendar.getInstance();
 215         cal.setTime(new Date(day * 1000));
 216         return cal.get(Calendar.YEAR);
 217     }
 218 
 219     /**
 220      *
 221      * @param day
 222      * @return
 223      */
 224     public static long getWeekFirst(long day) {
 225         long firstDay = 0L;
 226         Calendar cal = Calendar.getInstance();
 227         cal.setTime(new Date(day * 1000));
 228         cal.setFirstDayOfWeek(Calendar.MONDAY);
 229         cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
 230         cal.set(Calendar.HOUR_OF_DAY, 0);
 231         cal.set(Calendar.MINUTE, 0);
 232         cal.set(Calendar.SECOND, 0);
 233         cal.set(Calendar.MILLISECOND, 0);
 234         firstDay = cal.getTimeInMillis() / 1000;
 235         return firstDay;
 236     }
 237 
 238     /**
 239      * Ê†πÊçÆÊüê‰∏™Êó•ÊúüÊó∂Èó¥Êà≥ÁßíÂÄºÔºåËé∑ÂèñÊâÄÂú®Âë®Âú®‰∏ÄÂπ¥‰∏≠ÊòØÁ¨¨Âá†Âë®.
 240      *
 241      * @param day
 242      * @return
 243      */
 244     public static int getWeekOfYear(long day) {
 245         Calendar cal = Calendar.getInstance();
 246         cal.setTime(new Date(day * 1000));
 247         return cal.get(Calendar.WEEK_OF_YEAR);
 248     }
 249 
 250     /**
 251      *
 252      * @param day
 253      * @param inFormat
 254      * @param outFormat
 255      * @return String
 256      * @throws ParseException
 257      */
 258     public static String getYesterdayByString(String day, String inFormat, String outFormat){
 259         try {
 260 			SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 261 			Date date = sdf.parse(day);
 262 			Calendar calendar = Calendar.getInstance();
 263 			calendar.setTime(date);
 264 			int calendarDay = calendar.get(Calendar.DATE);
 265 			calendar.set(Calendar.DATE, calendarDay - 1);
 266 			String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 267 			return dayBefore;
 268 		} catch (ParseException e) {
 269 			return null;
 270 		}
 271     }
 272 
 273     /**
 274      *
 275      * @param day
 276      * @param inFormat
 277      * @param outFormat
 278      * @return String
 279      * @throws ParseException
 280      */
<abbr title=" 281     public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseException {"> 281     public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseEüîµ</abbr>
 282         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 283         Date date = sdf.parse(day);
 284         Calendar calendar = Calendar.getInstance();
 285         calendar.setTime(date);
 286         int calendarDay = calendar.get(Calendar.DATE);
 287         calendar.set(Calendar.DATE, calendarDay + 1);
 288         String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 289         return dayBefore;
 290     }
 291 
 292     /**
 293      *
 294      * @param date
 295      * @return Date
 296      * @throws ParseException
 297      */
 298     public static Date getTomorrowByDate(Date date) throws ParseException {
 299         Calendar calendar = Calendar.getInstance();
 300         calendar.setTime(date);
 301         int calendarDay = calendar.get(Calendar.DATE);
 302         calendar.set(Calendar.DATE, calendarDay + 1);
 303         return calendar.getTime();
 304     }
 305 
 306     /**
 307      *
 308      * @param day
 309      * @param inFormat
 310      * @param outFormat
 311      * @return String
 312      * @throws ParseException
 313      */
<abbr title=" 314     public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws ParseException {"> 314     public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws Paüîµ</abbr>
 315         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 316         Date date = sdf.parse(day);
 317         Calendar calendar = Calendar.getInstance();
 318         calendar.setTime(date);
 319         int calendarDay = calendar.get(Calendar.DATE);
 320         calendar.set(Calendar.DATE, calendarDay - 30);
 321         return new SimpleDateFormat(outFormat).format(calendar.getTime());
 322     }
 323 
 324     /**
 325      *
 326      * @param day
 327      * @param inFormat
 328      * @param outFormat
 329      * @return String
 330      * @throws ParseException
 331      */
<abbr title=" 332     public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws ParseException {"> 332     public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws Parüîµ</abbr>
 333     	SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 334     	Date date = sdf.parse(day);
 335     	Calendar calendar = Calendar.getInstance();
 336     	calendar.setTime(date);
 337     	int calendarDay = calendar.get(Calendar.DATE);
 338     	calendar.set(Calendar.DATE, calendarDay + 30);
 339     	String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 340     	return dayBefore;
 341     }
 342 
 343 
 344     /**
 345      *
 346      * @param day
 347      * @param inFormat
 348      * @param outFormat
 349      * @return String
 350      * @throws ParseException
 351      */
<abbr title=" 352     public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseException {"> 352     public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseExüîµ</abbr>
 353         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 354         Date date = sdf.parse(day);
 355         Calendar calendar = Calendar.getInstance();
 356         calendar.setTime(date);
 357         String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 358         return dayBefore;
 359     }
 360 
 361     public static long getDateMillToFormat(String day, String inFormat) throws ParseException {
 362         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 363         Date date = sdf.parse(day);
 364         Calendar calendar = Calendar.getInstance();
 365         calendar.setTime(date);
 366         return calendar.getTimeInMillis()/1000;
 367     }
 368 
 369     /**
 370      *
 371      * @author sishu.yss
 372      * @param year
 373      * @param month
 374      * @return
 375      */
 376     public static long getFirstDay4Month(int year, int month) {
 377         long firstDay = 0L;
 378         Calendar cal = Calendar.getInstance();
 379         cal.set(Calendar.YEAR, year);
 380         cal.set(Calendar.MONTH, month - 1);
 381         cal.set(Calendar.DAY_OF_MONTH, 1);
 382         cal.set(Calendar.HOUR_OF_DAY, 0);
 383         cal.set(Calendar.MINUTE, 0);
 384         cal.set(Calendar.SECOND, 0);
 385         cal.set(Calendar.MILLISECOND, 0);
 386         firstDay = cal.getTimeInMillis() / 1000;
 387         return firstDay;
 388     }
 389 
 390     /**
 391      *
 392      * @author yumo.lck
 393      * @param year
 394      * @param month
 395      * @return
 396      */
 397     public static long getLastDay4Month(int year, int month) {
 398         long lastDay = 0L;
 399         Calendar cal = Calendar.getInstance();
 400         cal.set(Calendar.YEAR, year);
 401         cal.set(Calendar.MONTH, month);
<abbr title=" 402         //1 represents a zero next month, can be seen as the end of the first day of the month most one day, but the data table on the last day of the zero point on the line"> 402         //1 represents a zero next month, can be seen as the end of the first day of the month most one düîµ</abbr>
 403         cal.set(Calendar.DAY_OF_MONTH, 0);
 404         cal.set(Calendar.HOUR_OF_DAY, 0);
 405         cal.set(Calendar.MINUTE, 0);
 406         cal.set(Calendar.SECOND, 0);
 407         cal.set(Calendar.MILLISECOND, 0);
 408         lastDay = cal.getTimeInMillis() / 1000;
 409         return lastDay;
 410     }
 411 
 412     /**
 413      *
 414      * @author yumo.lck
 415      * @param chooseFirstDay
 416      */
 417 
 418     public static long getBeforeMonthDay(long day, boolean chooseFirstDay) {
 419         long chooseDay = 0L;
 420         int currentMonth = getMonth(day);
 421         int currentYear = getYear(day);
 422         if (currentMonth &gt; 1) {
 423             currentMonth--;
 424         } else {
 425             currentYear--;
 426             currentMonth = 12;
 427         }
 428         if (chooseFirstDay) {
 429             chooseDay = getFirstDay4Month(currentYear, currentMonth);
 430             return chooseDay;
 431         } else {
 432             chooseDay = getLastDay4Month(currentYear, currentMonth);
 433             return chooseDay;
 434         }
 435 
 436     }
 437 
 438     /**
 439      * @return long
 440      */
 441     public static long getMillByOneDay() {
 442         Calendar cal = Calendar.getInstance();
 443         cal.set(Calendar.HOUR_OF_DAY, 0);
 444         cal.set(Calendar.MINUTE, 0);
 445         cal.set(Calendar.SECOND, 0);
 446         cal.set(Calendar.MILLISECOND, 0);
 447         return cal.getTimeInMillis() / 1000;
 448     }
 449 
 450     /**
 451      *
 452      * @return long
 453      */
 454     public static long getMillByYesDay() {
 455         Calendar cal = Calendar.getInstance();
 456         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 1);
 457         cal.set(Calendar.HOUR_OF_DAY, 0);
 458         cal.set(Calendar.MINUTE, 0);
 459         cal.set(Calendar.SECOND, 0);
 460         cal.set(Calendar.MILLISECOND, 0);
 461         return cal.getTimeInMillis() / 1000;
 462     }
 463 
 464     /**
 465      *
 466      * @return
 467      */
 468     public static long getMillByLastWeekDay() {
 469         Calendar cal = Calendar.getInstance();
 470         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 7);
 471         cal.set(Calendar.HOUR_OF_DAY, 0);
 472         cal.set(Calendar.MINUTE, 0);
 473         cal.set(Calendar.SECOND, 0);
 474         cal.set(Calendar.MILLISECOND, 0);
 475         return cal.getTimeInMillis() / 1000;
 476     }
 477 
 478     /**
 479      * @return long
 480      */
 481     public static long getMillByDay(int severalDays,String condition) {
 482     	int dateT=0;
 483         Calendar cal = Calendar.getInstance();
 484     	if(condition==null){
 485     		return getMillToDay(cal,dateT);
 486     	}
 487         if(&quot;-&quot;.equals(condition)){
 488         	dateT = (cal.get(Calendar.DATE) - severalDays);
 489         	return getMillToDay(cal,dateT);
 490         }
 491         if(&quot;+&quot;.equals(condition)){
 492         	dateT = (cal.get(Calendar.DATE) + severalDays);
 493         	return getMillToDay(cal,dateT);
 494         }
 495 		return getMillToDay(cal,dateT);
 496   }
 497 
 498     /**
 499      * @return long
 500      */
 501     public static long getStampByDay(int severalDays,String condition) {
 502     	int dateT=0;
 503     	Calendar cal = Calendar.getInstance();
 504     	if(condition==null){
 505     		return getStampToDay(cal,dateT);
 506     	}
 507     	if(&quot;-&quot;.equals(condition)){
 508     		dateT = (cal.get(Calendar.DATE) - severalDays);
 509     		return getStampToDay(cal,dateT);
 510     	}
 511     	if(&quot;+&quot;.equals(condition)){
 512     		dateT = (cal.get(Calendar.DATE) + severalDays);
 513     		return getStampToDay(cal,dateT);
 514     	}
 515     	return getStampToDay(cal,dateT);
 516     }
 517     /**
 518      * @return long
 519      */
 520     public static long getMillByDay(){
 521 		return getMillByDay(0,null);
 522     }
 523 
 524     /**
 525      * @param cal  Calendar
 526      * @param dateT Integer
 527      * @return  long
 528      */
 529     public static long getMillToDay(Calendar cal,int dateT){
 530 		   if(dateT!=0){
 531 			   cal.set(Calendar.DATE, dateT);
 532 		   }
 533 	       cal.set(Calendar.HOUR_OF_DAY, 0);
 534 	       cal.set(Calendar.MINUTE, 0);
 535 	       cal.set(Calendar.SECOND, 0);
 536 	       cal.set(Calendar.MILLISECOND, 0);
 537 	       return cal.getTimeInMillis()/1000;
 538 	}
 539 
 540     /**
 541      * @param cal  Calendar
 542      * @param dateT Integer
 543      * @return  long
 544      */
 545     public static long getStampToDay(Calendar cal,int dateT){
 546     	if(dateT!=0){
 547     		cal.set(Calendar.DATE, dateT);
 548     	}
 549     	return cal.getTimeInMillis();
 550     }
 551 
 552     public static String getToday() {
 553         Calendar cal = Calendar.getInstance();
 554         return cal.get(1) + &quot;Âπ¥&quot; + cal.get(2) + &quot;Êúà&quot; + cal.get(3) + &quot;Êó•&quot;;
 555     }
 556 
 557     /**
 558      * @param day
 559      * @return format time
 560      */
 561     public static String getDate(long day, String format) {
 562         Calendar cal = Calendar.getInstance();
 563         if ((&quot;&quot; + day).length() &gt; 10) {
 564             cal.setTime(new Date(day));
 565         } else {
 566             cal.setTime(new Date(day * 1000));
 567         }
 568         SimpleDateFormat sf = new SimpleDateFormat(format);
 569         return sf.format(cal.getTime());
 570     }
 571 
 572     /**
 573      *
 574      * @param  date
 575      * @return
 576      */
 577     public static String getDate(Date date, String format) {
 578         SimpleDateFormat sf = new SimpleDateFormat(format);
 579         return sf.format(date);
 580     }
 581 
 582 
 583     /**
 584      *
 585      * @param day
 586      * @param format
 587      * @return long
 588      * @throws ParseException
 589      */
 590     public static long stringToLong(String day, String format) throws ParseException {
 591     	SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 592         long date = dateFormat.parse(day).getTime();
 593     	return date;
 594     }
 595 
 596     /**
 597      * @param day
 598      * @param format
 599      * @return Date
 600      * @throws ParseException
 601      */
 602     public static Date stringToDate(String day, String format)  {
 603     	try {
 604 			SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 605 			 Date date = dateFormat.parse(day);
 606 			return date;
 607 		} catch (ParseException e) {
 608 			return new Date();
 609 		}
 610     }
 611 
 612 
 613     /**
 614      * longÂûãÊó∂Èó¥Êà≥ËΩ¨‰∏∫StringÂûã
 615      *
 616      * @param day Áßí
 617      * @return Ê†ºÂºèÂåñÂêéÁöÑÊó•Êúü
 618      * @throws ParseException
 619      */
 620     public static String longToString(long day, String format) throws ParseException {
 621     	if ((&quot;&quot; + day).length() &lt;= 10){
 622             day=day*1000;
 623         }
 624     	SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 625 	    String date = dateFormat.format(day);
 626     	return date;
 627     }
 628 
 629     /**
 630      *
 631      * @param day Áßí
 632      * @param minusDay ÈúÄË¶ÅÂáèÊéâÁöÑÂ§©Êï∞
 633      * @return Áßí
 634      */
 635     public static int getMinusDate(int day, int minusDay) {
 636         Calendar cal = Calendar.getInstance();
 637         cal.setTime(new Date(day * 1000));
 638         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - minusDay);
 639         cal.set(Calendar.HOUR_OF_DAY, 0);
 640         cal.set(Calendar.MINUTE, 0);
 641         cal.set(Calendar.SECOND, 0);
 642         cal.set(Calendar.MILLISECOND, 0);
 643         return (int) cal.getTimeInMillis() / 1000;
 644     }
 645 
 646     /**
 647      *
 648      * @return long
 649      */
 650     public static long getMillByNow() {
 651         Calendar cal = Calendar.getInstance();
 652         cal.setTime(new Date());
 653         return cal.getTimeInMillis();
 654     }
 655 
 656     public static int getWeeksBetweenTwoDates(long startDay, long endDay) {
 657 		int week = getWeekOfYear(endDay) - getWeekOfYear(startDay) + 1;
 658 		if(week&lt;1){
 659 			week = getWeekOfYear(endDay) + getMaxWeekOfYear(startDay) - getWeekOfYear(startDay) + 1;
 660 		}
 661 		return week;
 662 	}
 663 
 664     public static int getMaxWeekOfYear(long startDay) {
 665 		Calendar cal = Calendar.getInstance();
 666         cal.setTime(new Date(startDay * 1000));
 667         return cal.getMaximum(Calendar.WEEK_OF_YEAR);
 668 	}
 669 
 670     public static int getMonthsBetweenTwoDates(long startDay, long endDay) {
 671 		int month = DateUtil.getMonth(endDay) - DateUtil.getMonth(startDay) + 1;
 672 		if(month&lt;1){
 673 			month = getMonth(endDay) + 12 - getMonth(startDay) +1;
 674 		}
 675 		return month;
 676 	}
 677 
 678     public static Date parseDate(String dateStr, String pattern){
 679 		SimpleDateFormat sdf = new SimpleDateFormat();
 680 		sdf.applyPattern(pattern);
 681 		try {
 682 			return sdf.parse(dateStr);
 683 		} catch (ParseException e) {
 684 			return null;
 685 		}
 686 	}
 687 
 688     /**
 689      *
 690      * @param time Long Êó∂Èó¥
 691      * @return long
 692      */
 693     public static long getMinuteStart(long time) {
 694         long firstDay = 0L;
 695         Calendar cal = Calendar.getInstance();
 696         if ((&quot;&quot; + time).length() &gt; 10) {
 697             cal.setTime(new Date(time));
 698         } else {
 699             cal.setTime(new Date(time * 1000));
 700         }
 701         cal.set(Calendar.SECOND, 0);
 702         cal.set(Calendar.MILLISECOND, 0);
 703         firstDay = cal.getTimeInMillis() / 1000;
 704         return firstDay;
 705     }
 706 
 707     /**
 708      * @param time Long
 709      * @return long
 710      */
 711     public static long getHourStart(long time) {
 712         long firstDay = 0L;
 713         Calendar cal = Calendar.getInstance();
 714         if ((&quot;&quot; + time).length() &gt; 10) {
 715             cal.setTime(new Date(time));
 716         } else {
 717             cal.setTime(new Date(time * 1000));
 718         }
 719         cal.set(Calendar.SECOND, 0);
 720         cal.set(Calendar.MILLISECOND, 0);
 721         cal.set(Calendar.MINUTE, 0);
 722         firstDay = cal.getTimeInMillis() / 1000;
 723         return firstDay;
 724     }
 725 
 726     /**
 727      * @param time
 728      * @return Date
 729      */
 730     public static Date getDateByLong(long time){
 731         Date date = new Date();
 732         date.setTime(time);
 733         return date;
 734     }
 735 
 736 
 737     public static Date parseDate(String dateStr, String pattern, Locale locale){
 738     	SimpleDateFormat df = new SimpleDateFormat(
 739 				pattern, locale);
 740 
 741 		df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));
 742 		try {
 743 			return df.parse(dateStr);
 744 		} catch (ParseException e) {
 745 			return null;
 746 		}
 747 	}
 748 
 749     public static String getDate(Date date, String format, Locale locale) {
 750     	SimpleDateFormat df = new SimpleDateFormat(
 751     			format, locale);
 752     	df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));
 753         return df.format(date);
 754     }
 755 
 756     public static java.sql.Timestamp columnToTimestamp(Object column) {
 757         if (column == null) {
 758             return null;
 759         } else if(column instanceof String) {
 760             return new java.sql.Timestamp(stringToDate((String)column).getTime());
 761         } else if (column instanceof Integer) {
 762             Integer rawData = (Integer) column;
 763             return new java.sql.Timestamp(rawData.longValue());
 764         } else if (column instanceof Long) {
 765             Long rawData = (Long) column;
 766             return new java.sql.Timestamp(rawData.longValue());
 767         } else if (column instanceof java.sql.Date) {
 768             return (java.sql.Timestamp) column;
 769         } else if(column instanceof Timestamp) {
 770             return (Timestamp) column;
 771         } else if(column instanceof Date) {
 772             Date d = (Date)column;
 773             return new java.sql.Timestamp(d.getTime());
 774         }
 775 
 776         throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
 777     }
 778 
 779     public static String dateToString(Date date) {
 780         LocalDateTime localDateTime = dateToLocalDateTime(date);
 781         return localDateTime.format(DATE_FORMATTER);
 782     }
 783 
 784     public static String timestampToString(Date date) {
 785         LocalDateTime localDateTime = dateToLocalDateTime(date);
 786         return localDateTime.format(DATE_TIME_FORMATTER);
 787     }
 788 
 789     public static Timestamp getTimestampFromStr(String timeStr) {
 790         if (DATETIME.matcher(timeStr).matches()) {
 791             Instant instant = Instant.from(ISO_INSTANT.parse(timeStr));
 792             return new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);
 793         }
 794         return new Timestamp(stringToDate(timeStr).getTime());
 795     }
 796 
 797     public static java.sql.Date getDateFromStr(String dateStr) {
 798         if (DATE.matcher(dateStr).matches()) {
<abbr title=" 799             Instant instant = LocalDate.parse(dateStr).atTime(LocalTime.of(0, 0, 0, 0)).toInstant(ZoneOffset.UTC);"> 799             Instant instant = LocalDate.parse(dateStr).atTime(LocalTime.of(0, 0, 0, 0)).toInstant(ZoneOffüîµ</abbr>
 800             int offset = TimeZone.getDefault().getOffset(instant.toEpochMilli());
 801             return new java.sql.Date(instant.toEpochMilli() - offset);
 802         } else if (DATETIME.matcher(dateStr).matches()) {
 803             Instant instant = Instant.from(ISO_INSTANT.parse(dateStr));
 804             return new java.sql.Date(instant.toEpochMilli());
 805         }
 806         return new java.sql.Date(stringToDate(dateStr).getTime());
 807     }
 808 
 809 }
 
 
 
 
 
 
 
 
 
 </pre></td>
                            <td><pre>   1 /*
   2  * Licensed to the Apache Software Foundation (ASF) under one
   3  * or more contributor license agreements.  See the NOTICE file
   4  * distributed with this work for additional information
   5  * regarding copyright ownership.  The ASF licenses this file
   6  * to you under the Apache License, Version 2.0 (the
   7  * &quot;License&quot;); you may not use this file except in compliance
   8  * with the License.  You may obtain a copy of the License at
   9  *
  10  *     http://www.apache.org/licenses/LICENSE-2.0
  11  *
  12  * Unless required by applicable law or agreed to in writing, software
  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15  * See the License for the specific language governing permissions and
  16  * limitations under the License.
  17  */
  18 package com.dtstack.flink.sql.util;
  19 
  20 import java.sql.Timestamp;
  21 import java.text.ParseException;
  22 import java.text.SimpleDateFormat;
  23 import java.time.*;
  24 import java.time.format.DateTimeFormatter;
  25 import java.time.format.DateTimeParseException;
  26 import java.util.*;
  27 import java.util.regex.Pattern;
  28 import static java.time.format.DateTimeFormatter.ISO_INSTANT;
  29 
  30 
  31 /**
  32  * Êó•ÊúüÂ∑•ÂÖ∑
  33  * Date: 2017Âπ¥03Êúà10Êó• ‰∏ãÂçà1:16:37
  34  * Company: www.dtstack.com
  35  *
  36  * @author sishu.yss
  37  */
  38 public class DateUtil {
<abbr title="  39     static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);">  39     static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ssüîµ</abbr>
  40 
  41     static final DateTimeFormatter DATE_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;);
  42 
  43     static final DateTimeFormatter TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;);
  44 
<abbr title="  45     private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3,9})?Z$&quot;);">  45     private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\üîµ</abbr>
  46 
  47     private static final Pattern DATE = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}$&quot;);
  48 
  49     private static final int MILLIS_PER_SECOND = 1000;
  50 
  51     public static java.sql.Date columnToDate(Object column) {
  52         if(column instanceof String) {
  53             return new java.sql.Date(stringToDate((String)column).getTime());
  54         } else if (column instanceof Integer) {
  55             Integer rawData = (Integer) column;
  56             return new java.sql.Date(rawData.longValue());
  57         } else if (column instanceof Long) {
  58             Long rawData = (Long) column;
  59             return new java.sql.Date(rawData.longValue());
  60         } else if (column instanceof java.sql.Date) {
  61             return (java.sql.Date) column;
  62         } else if(column instanceof Timestamp) {
  63             Timestamp ts = (Timestamp) column;
  64             return new java.sql.Date(ts.getTime());
  65         }
  66         throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
  67     }
  68 
  69     public static Date stringToDate(String strDate)  {
  70         if(strDate == null){
  71             return null;
  72         }
  73         try {
  74             ;
  75             return localDateTimetoDate(LocalDateTime.parse(strDate, DATE_TIME_FORMATTER));
  76         } catch (DateTimeParseException ignored) {
  77         }
  78 
  79         try {
  80             return localDateTimetoDate(LocalDate.parse(strDate, DATE_FORMATTER).atStartOfDay());
  81         } catch (DateTimeParseException ignored) {
  82         }
  83 
  84         try {
<abbr title="  85             return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FORMATTER)));">  85             return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FOüîµ</abbr>
  86         } catch (DateTimeParseException ignored) {
  87         }
  88 
  89         throw new RuntimeException(&quot;can&#x27;t parse date&quot;);
  90     }
  91 
  92     public static Date localDateTimetoDate(LocalDateTime localDateTime){
  93         return Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());
  94     }
  95 
  96     public static LocalDateTime dateToLocalDateTime(Date date){
  97         return date.toInstant().atZone(ZoneId.systemDefault()).toLocalDateTime();
  98     }
  99 
 100     /**
 101      *
 102      *
 103      * @param day Long Êó∂Èó¥
 104      * @return long
 105      */
 106     public static long getTodayStart(long day) {
 107         long firstDay = 0L;
 108         Calendar cal = Calendar.getInstance();
 109         if ((&quot;&quot; + day).length() &gt; 10) {
 110             cal.setTime(new Date(day));
 111         } else {
 112             cal.setTime(new Date(day * 1000));
 113         }
 114         cal.set(Calendar.HOUR_OF_DAY, 0);
 115         cal.set(Calendar.MINUTE, 0);
 116         cal.set(Calendar.SECOND, 0);
 117         cal.set(Calendar.MILLISECOND, 0);
 118         firstDay = cal.getTimeInMillis() / 1000;
 119         return firstDay;
 120     }
 121 
 122     /**
 123      *
 124      * @param day Long Êó∂Èó¥
 125      * @param scope
 126      * @return
 127      */
 128     public static long getTodayStart(long day,String scope) {
 129     	if(&quot;MS&quot;.equals(scope)){
 130     		return getTodayStart(day)*1000;
 131     	}else if(&quot;S&quot;.equals(scope)){
 132     		return getTodayStart(day);
 133     	}else{
 134     		return getTodayStart(day);
 135     	}
 136     }
 137 
 138     /**
 139      *
 140      * @param day Long Êó∂Èó¥
 141      * @return long
 142      */
 143     public static long getNextDayStart(long day) {
 144         long daySpanMill = 86400000L;
 145         long nextDay = 0L;
 146         Calendar cal = Calendar.getInstance();
 147         if ((&quot;&quot; + day).length() &gt; 10) {
 148             cal.setTime(new Date(day));
 149         } else {
 150             cal.setTime(new Date(day * 1000));
 151         }
 152         cal.set(Calendar.HOUR_OF_DAY, 0);
 153         cal.set(Calendar.MINUTE, 0);
 154         cal.set(Calendar.SECOND, 0);
 155         cal.set(Calendar.MILLISECOND, 0);
 156         nextDay = (cal.getTimeInMillis() + daySpanMill) / 1000;
 157         return nextDay;
 158     }
 159 
 160     /**
 161      *
 162      * @param day Long Êó∂Èó¥
 163      * @param scope String Á∫ßÂà´&lt;br&gt;&quot;MS&quot;ÔºöÊØ´ÁßíÁ∫ß&lt;br&gt;&quot;S&quot;:ÁßíÁ∫ß
 164      * @return
 165      */
 166     public static long getNextDayStart(long day,String scope) {
 167     	if(&quot;MS&quot;.equals(scope)){
 168     		return getNextDayStart(day)*1000;
 169     	}else if(&quot;S&quot;.equals(scope)){
 170     		return getNextDayStart(day);
 171     	}else{
 172     		return getNextDayStart(day);
 173     	}
 174     }
 175 
 176     /**
 177      *
 178      * @param day
 179      * @return
 180      */
 181     public static long getMonthFirst(long day) {
 182         long firstDay = 0L;
 183         Calendar cal = Calendar.getInstance();
 184         cal.setTime(new Date(day * 1000));
 185         cal.set(Calendar.DAY_OF_MONTH, 1);
 186         cal.set(Calendar.HOUR_OF_DAY, 0);
 187         cal.set(Calendar.MINUTE, 0);
 188         cal.set(Calendar.SECOND, 0);
 189         cal.set(Calendar.MILLISECOND, 0);
 190         firstDay = cal.getTimeInMillis() / 1000;
 191         return firstDay;
 192     }
 193 
 194     /**
 195      * @param day
 196      * @return
 197      */
 198     public static int getMonth(long day) {
 199         Calendar cal = Calendar.getInstance();
 200         cal.setTime(new Date(day * 1000));
 201         return cal.get(Calendar.MONTH) + 1;
 202     }
 203 
 204     /**
 205      *
 206      * @author yumo.lck
 207      */
 208     public static int getYear(long day) {
 209         Calendar cal = Calendar.getInstance();
 210         cal.setTime(new Date(day * 1000));
 211         return cal.get(Calendar.YEAR);
 212     }
 213 
 214     /**
 215      *
 216      * @param day
 217      * @return
 218      */
 219     public static long getWeekFirst(long day) {
 220         long firstDay = 0L;
 221         Calendar cal = Calendar.getInstance();
 222         cal.setTime(new Date(day * 1000));
 223         cal.setFirstDayOfWeek(Calendar.MONDAY);
 224         cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
 225         cal.set(Calendar.HOUR_OF_DAY, 0);
 226         cal.set(Calendar.MINUTE, 0);
 227         cal.set(Calendar.SECOND, 0);
 228         cal.set(Calendar.MILLISECOND, 0);
 229         firstDay = cal.getTimeInMillis() / 1000;
 230         return firstDay;
 231     }
 232 
 233     /**
 234      * Ê†πÊçÆÊüê‰∏™Êó•ÊúüÊó∂Èó¥Êà≥ÁßíÂÄºÔºåËé∑ÂèñÊâÄÂú®Âë®Âú®‰∏ÄÂπ¥‰∏≠ÊòØÁ¨¨Âá†Âë®.
 235      *
 236      * @param day
 237      * @return
 238      */
 239     public static int getWeekOfYear(long day) {
 240         Calendar cal = Calendar.getInstance();
 241         cal.setTime(new Date(day * 1000));
 242         return cal.get(Calendar.WEEK_OF_YEAR);
 243     }
 244 
 245     /**
 246      *
 247      * @param day
 248      * @param inFormat
 249      * @param outFormat
 250      * @return String
 251      * @throws ParseException
 252      */
 253     public static String getYesterdayByString(String day, String inFormat, String outFormat){
 254         try {
 255     			SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 256     			Date date = sdf.parse(day);
 257     			Calendar calendar = Calendar.getInstance();
 258     			calendar.setTime(date);
 259     			int calendarDay = calendar.get(Calendar.DATE);
 260     			calendar.set(Calendar.DATE, calendarDay - 1);
 261     			String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 262     			return dayBefore;
 263     		} catch (ParseException e) {
 264     			return null;
 265     		}
 266     }
 267 
 268     /**
 269      *
 270      * @param day
 271      * @param inFormat
 272      * @param outFormat
 273      * @return String
 274      * @throws ParseException
 275      */
<abbr title=" 276     public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseException {"> 276     public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseEüîµ</abbr>
 277         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 278         Date date = sdf.parse(day);
 279         Calendar calendar = Calendar.getInstance();
 280         calendar.setTime(date);
 281         int calendarDay = calendar.get(Calendar.DATE);
 282         calendar.set(Calendar.DATE, calendarDay + 1);
 283         String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 284         return dayBefore;
 285     }
 286 
 287     /**
 288      *
 289      * @param date
 290      * @return Date
 291      * @throws ParseException
 292      */
 293     public static Date getTomorrowByDate(Date date) throws ParseException {
 294         Calendar calendar = Calendar.getInstance();
 295         calendar.setTime(date);
 296         int calendarDay = calendar.get(Calendar.DATE);
 297         calendar.set(Calendar.DATE, calendarDay + 1);
 298         return calendar.getTime();
 299     }
 300 
 301     /**
 302      *
 303      * @param day
 304      * @param inFormat
 305      * @param outFormat
 306      * @return String
 307      * @throws ParseException
 308      */
<abbr title=" 309     public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws ParseException {"> 309     public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws Paüîµ</abbr>
 310         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 311         Date date = sdf.parse(day);
 312         Calendar calendar = Calendar.getInstance();
 313         calendar.setTime(date);
 314         int calendarDay = calendar.get(Calendar.DATE);
 315         calendar.set(Calendar.DATE, calendarDay - 30);
 316         return new SimpleDateFormat(outFormat).format(calendar.getTime());
 317     }
 318 
 319     /**
 320      *
 321      * @param day
 322      * @param inFormat
 323      * @param outFormat
 324      * @return String
 325      * @throws ParseException
 326      */
<abbr title=" 327     public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws ParseException {"> 327     public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws Parüîµ</abbr>
 328     	SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 329     	Date date = sdf.parse(day);
 330     	Calendar calendar = Calendar.getInstance();
 331     	calendar.setTime(date);
 332     	int calendarDay = calendar.get(Calendar.DATE);
 333     	calendar.set(Calendar.DATE, calendarDay + 30);
 334     	String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 335     	return dayBefore;
 336     }
 337 
 338     /**
 339      *
 340      * @param day
 341      * @param inFormat
 342      * @param outFormat
 343      * @return String
 344      * @throws ParseException
 345      */
<abbr title=" 346     public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseException {"> 346     public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseExüîµ</abbr>
 347         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 348         Date date = sdf.parse(day);
 349         Calendar calendar = Calendar.getInstance();
 350         calendar.setTime(date);
 351         String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 352         return dayBefore;
 353     }
 354 
 355     public static long getDateMillToFormat(String day, String inFormat) throws ParseException {
 356         SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 357         Date date = sdf.parse(day);
 358         Calendar calendar = Calendar.getInstance();
 359         calendar.setTime(date);
 360         return calendar.getTimeInMillis()/1000;
 361     }
 362 
 363     /**
 364      *
 365      * @author sishu.yss
 366      * @param year
 367      * @param month
 368      * @return
 369      */
 370     public static long getFirstDay4Month(int year, int month) {
 371         long firstDay = 0L;
 372         Calendar cal = Calendar.getInstance();
 373         cal.set(Calendar.YEAR, year);
 374         cal.set(Calendar.MONTH, month - 1);
 375         cal.set(Calendar.DAY_OF_MONTH, 1);
 376         cal.set(Calendar.HOUR_OF_DAY, 0);
 377         cal.set(Calendar.MINUTE, 0);
 378         cal.set(Calendar.SECOND, 0);
 379         cal.set(Calendar.MILLISECOND, 0);
 380         firstDay = cal.getTimeInMillis() / 1000;
 381         return firstDay;
 382     }
 383 
 384     /**
 385      *
 386      * @author yumo.lck
 387      * @param year
 388      * @param month
 389      * @return
 390      */
 391     public static long getLastDay4Month(int year, int month) {
 392         long lastDay = 0L;
 393         Calendar cal = Calendar.getInstance();
 394         cal.set(Calendar.YEAR, year);
 395         cal.set(Calendar.MONTH, month);
<abbr title=" 396         //1 represents a zero next month, can be seen as the end of the first day of the month most one day, but the data table on the last day of the zero point on the line"> 396         //1 represents a zero next month, can be seen as the end of the first day of the month most one düîµ</abbr>
 397         cal.set(Calendar.DAY_OF_MONTH, 0);
 398         cal.set(Calendar.HOUR_OF_DAY, 0);
 399         cal.set(Calendar.MINUTE, 0);
 400         cal.set(Calendar.SECOND, 0);
 401         cal.set(Calendar.MILLISECOND, 0);
 402         lastDay = cal.getTimeInMillis() / 1000;
 403         return lastDay;
 404     }
 405 
 406     /**
 407      *
 408      * @author yumo.lck
 409      * @param chooseFirstDay
 410      */
 411 
 412     public static long getBeforeMonthDay(long day, boolean chooseFirstDay) {
 413         long chooseDay = 0L;
 414         int currentMonth = getMonth(day);
 415         int currentYear = getYear(day);
 416         if (currentMonth &gt; 1) {
 417             currentMonth--;
 418         } else {
 419             currentYear--;
 420             currentMonth = 12;
 421         }
 422         if (chooseFirstDay) {
 423             chooseDay = getFirstDay4Month(currentYear, currentMonth);
 424             return chooseDay;
 425         } else {
 426             chooseDay = getLastDay4Month(currentYear, currentMonth);
 427             return chooseDay;
 428         }
 429 
 430     }
 431 
 432     /**
 433      * @return long
 434      */
 435     public static long getMillByOneDay() {
 436         Calendar cal = Calendar.getInstance();
 437         cal.set(Calendar.HOUR_OF_DAY, 0);
 438         cal.set(Calendar.MINUTE, 0);
 439         cal.set(Calendar.SECOND, 0);
 440         cal.set(Calendar.MILLISECOND, 0);
 441         return cal.getTimeInMillis() / 1000;
 442     }
 443 
 444     /**
 445      *
 446      * @return long
 447      */
 448     public static long getMillByYesDay() {
 449         Calendar cal = Calendar.getInstance();
 450         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 1);
 451         cal.set(Calendar.HOUR_OF_DAY, 0);
 452         cal.set(Calendar.MINUTE, 0);
 453         cal.set(Calendar.SECOND, 0);
 454         cal.set(Calendar.MILLISECOND, 0);
 455         return cal.getTimeInMillis() / 1000;
 456     }
 457 
 458     /**
 459      *
 460      * @return
 461      */
 462     public static long getMillByLastWeekDay() {
 463         Calendar cal = Calendar.getInstance();
 464         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 7);
 465         cal.set(Calendar.HOUR_OF_DAY, 0);
 466         cal.set(Calendar.MINUTE, 0);
 467         cal.set(Calendar.SECOND, 0);
 468         cal.set(Calendar.MILLISECOND, 0);
 469         return cal.getTimeInMillis() / 1000;
 470     }
 471 
 472 /**
 473  * @return long
 474  */
 475  public static long getMillByDay(int severalDays,String condition) {
 476  	int dateT=0;
 477      Calendar cal = Calendar.getInstance();
 478  	if(condition==null){
 479  		return getMillToDay(cal,dateT);
 480  	}
 481      if(&quot;-&quot;.equals(condition)){
 482      	dateT = (cal.get(Calendar.DATE) - severalDays);
 483      	return getMillToDay(cal,dateT);
 484      }
 485      if(&quot;+&quot;.equals(condition)){
 486      	dateT = (cal.get(Calendar.DATE) + severalDays);
 487      	return getMillToDay(cal,dateT);
 488      }
 489 		return getMillToDay(cal,dateT);
 490   }
 491 
 492     /**
 493      * @return long
 494      */
 495     public static long getStampByDay(int severalDays,String condition) {
 496     	int dateT=0;
 497     	Calendar cal = Calendar.getInstance();
 498     	if(condition==null){
 499     		return getStampToDay(cal,dateT);
 500     	}
 501     	if(&quot;-&quot;.equals(condition)){
 502     		dateT = (cal.get(Calendar.DATE) - severalDays);
 503     		return getStampToDay(cal,dateT);
 504     	}
 505     	if(&quot;+&quot;.equals(condition)){
 506     		dateT = (cal.get(Calendar.DATE) + severalDays);
 507     		return getStampToDay(cal,dateT);
 508     	}
 509     	return getStampToDay(cal,dateT);
 510     }
 511 
 512     /**
 513      * @return long
 514      */
 515     public static long getMillByDay(){
 516     		return getMillByDay(0,null);
 517     }
 518 
 519     /**
 520      * @param cal  Calendar
 521      * @param dateT Integer
 522      * @return  long
 523      */
 524     public static long getMillToDay(Calendar cal,int dateT){
 525      if(dateT!=0){
 526       cal.set(Calendar.DATE, dateT);
 527      }
 528         cal.set(Calendar.HOUR_OF_DAY, 0);
 529         cal.set(Calendar.MINUTE, 0);
 530         cal.set(Calendar.SECOND, 0);
 531         cal.set(Calendar.MILLISECOND, 0);
 532         return cal.getTimeInMillis()/1000;
 533     	}
 534 
 535     /**
 536      * @param cal  Calendar
 537      * @param dateT Integer
 538      * @return  long
 539      */
 540     public static long getStampToDay(Calendar cal,int dateT){
 541     	if(dateT!=0){
 542     		cal.set(Calendar.DATE, dateT);
 543     	}
 544     	return cal.getTimeInMillis();
 545     }
 546 
 547     public static String getToday() {
 548         Calendar cal = Calendar.getInstance();
 549         return cal.get(1) + &quot;Âπ¥&quot; + cal.get(2) + &quot;Êúà&quot; + cal.get(3) + &quot;Êó•&quot;;
 550     }
 551 
 552     /**
 553      * @param day
 554      * @return format time
 555      */
 556     public static String getDate(long day, String format) {
 557         Calendar cal = Calendar.getInstance();
 558         if ((&quot;&quot; + day).length() &gt; 10) {
 559             cal.setTime(new Date(day));
 560         } else {
 561             cal.setTime(new Date(day * 1000));
 562         }
 563         SimpleDateFormat sf = new SimpleDateFormat(format);
 564         return sf.format(cal.getTime());
 565     }
 566 
 567     /**
 568      *
 569      * @param  date
 570      * @return
 571      */
 572     public static String getDate(Date date, String format) {
 573         SimpleDateFormat sf = new SimpleDateFormat(format);
 574         return sf.format(date);
 575     }
 576 
 577     /**
 578      *
 579      * @param day
 580      * @param format
 581      * @return long
 582      * @throws ParseException
 583      */
 584     public static long stringToLong(String day, String format) throws ParseException {
 585     	SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 586         long date = dateFormat.parse(day).getTime();
 587     	return date;
 588     }
 589 
 590     /**
 591      * @param day
 592      * @param format
 593      * @return Date
 594      * @throws ParseException
 595      */
 596     public static Date stringToDate(String day, String format)  {
 597     	try {
 598     			SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 599     Date date = dateFormat.parse(day);
 600     			return date;
 601     		} catch (ParseException e) {
 602     			return new Date();
 603     		}
 604     }
 605 
 606     /**
 607      * longÂûãÊó∂Èó¥Êà≥ËΩ¨‰∏∫StringÂûã
 608      *
 609      * @param day Áßí
 610      * @return Ê†ºÂºèÂåñÂêéÁöÑÊó•Êúü
 611      * @throws ParseException
 612      */
 613     public static String longToString(long day, String format) throws ParseException {
 614     	if ((&quot;&quot; + day).length() &lt;= 10){
 615             day=day*1000;
 616         }
 617     	SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 618      String date = dateFormat.format(day);
 619     	return date;
 620     }
 621 
 622     /**
 623      *
 624      * @param day Áßí
 625      * @param minusDay ÈúÄË¶ÅÂáèÊéâÁöÑÂ§©Êï∞
 626      * @return Áßí
 627      */
 628     public static int getMinusDate(int day, int minusDay) {
 629         Calendar cal = Calendar.getInstance();
 630         cal.setTime(new Date(day * 1000));
 631         cal.set(Calendar.DATE, cal.get(Calendar.DATE) - minusDay);
 632         cal.set(Calendar.HOUR_OF_DAY, 0);
 633         cal.set(Calendar.MINUTE, 0);
 634         cal.set(Calendar.SECOND, 0);
 635         cal.set(Calendar.MILLISECOND, 0);
 636         return (int) cal.getTimeInMillis() / 1000;
 637     }
 638 
 639     /**
 640      *
 641      * @return long
 642      */
 643     public static long getMillByNow() {
 644         Calendar cal = Calendar.getInstance();
 645         cal.setTime(new Date());
 646         return cal.getTimeInMillis();
 647     }
 648 
 649 public static int getWeeksBetweenTwoDates(long startDay, long endDay) {
 650 	int week = getWeekOfYear(endDay) - getWeekOfYear(startDay) + 1;
 651 	if(week&lt;1){
 652 		week = getWeekOfYear(endDay) + getMaxWeekOfYear(startDay) - getWeekOfYear(startDay) + 1;
 653 	}
 654 	return week;
 655 }
 656 
 657 public static int getMaxWeekOfYear(long startDay) {
 658 	Calendar cal = Calendar.getInstance();
 659        cal.setTime(new Date(startDay * 1000));
 660        return cal.getMaximum(Calendar.WEEK_OF_YEAR);
 661 }
 662 
 663 public static int getMonthsBetweenTwoDates(long startDay, long endDay) {
 664 	int month = DateUtil.getMonth(endDay) - DateUtil.getMonth(startDay) + 1;
 665 	if(month&lt;1){
 666 		month = getMonth(endDay) + 12 - getMonth(startDay) +1;
 667 	}
 668 	return month;
 669 }
 670 
 671 public static Date parseDate(String dateStr, String pattern){
 672 	SimpleDateFormat sdf = new SimpleDateFormat();
 673 	sdf.applyPattern(pattern);
 674 	try {
 675 		return sdf.parse(dateStr);
 676 	} catch (ParseException e) {
 677 		return null;
 678 	}
 679 }
 680 
 681 /**
 682     *
 683     * @param time Long Êó∂Èó¥
 684     * @return long
 685     */
 686    public static long getMinuteStart(long time) {
 687        long firstDay = 0L;
 688        Calendar cal = Calendar.getInstance();
 689        if ((&quot;&quot; + time).length() &gt; 10) {
 690            cal.setTime(new Date(time));
 691        } else {
 692            cal.setTime(new Date(time * 1000));
 693        }
 694        cal.set(Calendar.SECOND, 0);
 695        cal.set(Calendar.MILLISECOND, 0);
 696        firstDay = cal.getTimeInMillis() / 1000;
 697        return firstDay;
 698    }
 699 
 700     /**
 701      * @param time Long
 702      * @return long
 703      */
 704     public static long getHourStart(long time) {
 705         long firstDay = 0L;
 706         Calendar cal = Calendar.getInstance();
 707         if ((&quot;&quot; + time).length() &gt; 10) {
 708             cal.setTime(new Date(time));
 709         } else {
 710             cal.setTime(new Date(time * 1000));
 711         }
 712         cal.set(Calendar.SECOND, 0);
 713         cal.set(Calendar.MILLISECOND, 0);
 714         cal.set(Calendar.MINUTE, 0);
 715         firstDay = cal.getTimeInMillis() / 1000;
 716         return firstDay;
 717     }
 718 
 719     /**
 720      * @param time
 721      * @return Date
 722      */
 723     public static Date getDateByLong(long time){
 724         Date date = new Date();
 725         date.setTime(time);
 726         return date;
 727     }
 728 
 729     public static Date parseDate(String dateStr, String pattern, Locale locale){
 730     	SimpleDateFormat df = new SimpleDateFormat(
 731     pattern, locale);
 732 
 733     		df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));
 734     		try {
 735     			return df.parse(dateStr);
 736     		} catch (ParseException e) {
 737     			return null;
 738     		}
 739     	}
 740 
 741     public static String getDate(Date date, String format, Locale locale) {
 742     	SimpleDateFormat df = new SimpleDateFormat(
 743     			format, locale);
 744     	df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));
 745         return df.format(date);
 746     }
 747 
 748     public static java.sql.Timestamp columnToTimestamp(Object column) {
 749         if (column == null) {
 750             return null;
 751         } else if(column instanceof String) {
 752             return new java.sql.Timestamp(stringToDate((String)column).getTime());
 753         } else if (column instanceof Integer) {
 754             Integer rawData = (Integer) column;
 755             return new java.sql.Timestamp(rawData.longValue());
 756         } else if (column instanceof Long) {
 757             Long rawData = (Long) column;
 758             return new java.sql.Timestamp(rawData.longValue());
 759         } else if (column instanceof java.sql.Date) {
 760             return (java.sql.Timestamp) column;
 761         } else if(column instanceof Timestamp) {
 762             return (Timestamp) column;
 763         } else if(column instanceof Date) {
 764             Date d = (Date)column;
 765             return new java.sql.Timestamp(d.getTime());
 766         }
 767 
 768         throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
 769     }
 770 
 771     public static String dateToString(Date date) {
 772         LocalDateTime localDateTime = dateToLocalDateTime(date);
 773         return localDateTime.format(DATE_FORMATTER);
 774     }
 775 
 776     public static String timestampToString(Date date) {
 777         LocalDateTime localDateTime = dateToLocalDateTime(date);
 778         return localDateTime.format(DATE_TIME_FORMATTER);
 779     }
 780 
 781     public static Timestamp getTimestampFromStr(String timeStr) {
 782         if (DATETIME.matcher(timeStr).matches()) {
 783             Instant instant = Instant.from(ISO_INSTANT.parse(timeStr));
 784             return new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);
 785         }
 786         return new Timestamp(stringToDate(timeStr).getTime());
 787     }
 788 
 789     public static java.sql.Date getDateFromStr(String dateStr) {
 790         if (DATE.matcher(dateStr).matches()) {
<abbr title=" 791             Instant instant = LocalDate.parse(dateStr).atTime(LocalTime.of(0, 0, 0, 0)).toInstant(ZoneOffset.UTC);"> 791             Instant instant = LocalDate.parse(dateStr).atTime(LocalTime.of(0, 0, 0, 0)).toInstant(ZoneOffüîµ</abbr>
 792             int offset = TimeZone.getDefault().getOffset(instant.toEpochMilli());
 793             return new java.sql.Date(instant.toEpochMilli() - offset);
 794         } else if (DATETIME.matcher(dateStr).matches()) {
 795             Instant instant = Instant.from(ISO_INSTANT.parse(dateStr));
 796             return new java.sql.Date(instant.toEpochMilli());
 797         }
 798         return new java.sql.Date(stringToDate(dateStr).getTime());
 799     }
 800 }
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre>   1  /*
   2   * Licensed to the Apache Software Foundation (ASF) under one
   3   * or more contributor license agreements.  See the NOTICE file
   4   * distributed with this work for additional information
   5   * regarding copyright ownership.  The ASF licenses this file
   6   * to you under the Apache License, Version 2.0 (the
   7   * &quot;License&quot;); you may not use this file except in compliance
   8   * with the License.  You may obtain a copy of the License at
   9   *
  10   *     http://www.apache.org/licenses/LICENSE-2.0
  11   *
  12   * Unless required by applicable law or agreed to in writing, software
  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15   * See the License for the specific language governing permissions and
  16   * limitations under the License.
  17   */
  18  
  19  
  20  
  21  package com.dtstack.flink.sql.util;
  22  
  23  import java.sql.Timestamp;
  24  import java.text.ParseException;
  25  import java.text.SimpleDateFormat;
  26  import java.time.LocalDate;
  27  import java.time.LocalDateTime;
  28  import java.time.LocalTime;
  29  import java.time.ZoneId;

  30  import java.time.format.DateTimeFormatter;
  31  import java.time.format.DateTimeParseException;
  32  import java.util.Calendar;
  33  import java.util.Date;
  34  import java.util.Locale;
  35  import java.util.SimpleTimeZone;




  36  
  37  
  38  /**
  39   *
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  40 - * Reason: TODO ADD REASON(ÂèØÈÄâ)</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  41 + * Êó•ÊúüÂ∑•ÂÖ∑</span>
  42   * Date: 2017Âπ¥03Êúà10Êó• ‰∏ãÂçà1:16:37
  43   * Company: www.dtstack.com
  44   * @author sishu.yss
  45   *
  46   */
  47  public class DateUtil {
  48  
  49      static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);
  50      static final DateTimeFormatter DATE_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;);
  51      static final DateTimeFormatter TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;);






  52  
  53      public static java.sql.Date columnToDate(Object column) {
  54          if(column instanceof String) {
  55              return new java.sql.Date(stringToDate((String)column).getTime());
  56          } else if (column instanceof Integer) {
  57              Integer rawData = (Integer) column;
  58              return new java.sql.Date(rawData.longValue());
  59          } else if (column instanceof Long) {
  60              Long rawData = (Long) column;
  61              return new java.sql.Date(rawData.longValue());
  62          } else if (column instanceof java.sql.Date) {
  63              return (java.sql.Date) column;
  64          } else if(column instanceof Timestamp) {
  65              Timestamp ts = (Timestamp) column;
  66              return new java.sql.Date(ts.getTime());
  67          }
  68          throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
  69      }
  70  
  71      public static Date stringToDate(String strDate)  {
  72          if(strDate == null){
  73              return null;
  74          }
  75          try {
  76              ;
  77              return localDateTimetoDate(LocalDateTime.parse(strDate, DATE_TIME_FORMATTER));
  78          } catch (DateTimeParseException ignored) {
  79          }
  80  
  81          try {
  82              return localDateTimetoDate(LocalDate.parse(strDate, DATE_FORMATTER).atStartOfDay());
  83          } catch (DateTimeParseException ignored) {
  84          }
  85  
  86          try {
<abbr title="  87              return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FORMATTER)));">  87              return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FORMATTER))üîµ</abbr>
  88          } catch (DateTimeParseException ignored) {
  89          }
  90  
  91          throw new RuntimeException(&quot;can&#x27;t parse date&quot;);
  92      }
  93  
  94      public static Date localDateTimetoDate(LocalDateTime localDateTime){
  95          return Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());
  96      }
  97  
  98      public static LocalDateTime dateToLocalDateTime(Date date){
  99          return date.toInstant().atZone(ZoneId.systemDefault()).toLocalDateTime();
 100      }
 101  
 102      /**
 103       *
 104       *
 105       * @param day Long Êó∂Èó¥
 106       * @return long
 107       */
 108      public static long getTodayStart(long day) {
 109          long firstDay = 0L;
 110          Calendar cal = Calendar.getInstance();
 111          if ((&quot;&quot; + day).length() &gt; 10) {
 112              cal.setTime(new Date(day));
 113          } else {
 114              cal.setTime(new Date(day * 1000));
 115          }
 116          cal.set(Calendar.HOUR_OF_DAY, 0);
 117          cal.set(Calendar.MINUTE, 0);
 118          cal.set(Calendar.SECOND, 0);
 119          cal.set(Calendar.MILLISECOND, 0);
 120          firstDay = cal.getTimeInMillis() / 1000;
 121          return firstDay;
 122      }
 123  
 124      /**
 125       *
 126       * @param day Long Êó∂Èó¥
 127       * @param scope
 128       * @return
 129       */
 130      public static long getTodayStart(long day,String scope) {
 131      	if(&quot;MS&quot;.equals(scope)){
 132      		return getTodayStart(day)*1000;
 133      	}else if(&quot;S&quot;.equals(scope)){
 134      		return getTodayStart(day);
 135      	}else{
 136      		return getTodayStart(day);
 137      	}







 138      }
 139  
 140      /**
 141       *
 142       * @param day Long Êó∂Èó¥
 143       * @return long
 144       */
 145      public static long getNextDayStart(long day) {
 146          long daySpanMill = 86400000L;
 147          long nextDay = 0L;
 148          Calendar cal = Calendar.getInstance();
 149          if ((&quot;&quot; + day).length() &gt; 10) {
 150              cal.setTime(new Date(day));
 151          } else {
 152              cal.setTime(new Date(day * 1000));
 153          }
 154          cal.set(Calendar.HOUR_OF_DAY, 0);
 155          cal.set(Calendar.MINUTE, 0);
 156          cal.set(Calendar.SECOND, 0);
 157          cal.set(Calendar.MILLISECOND, 0);
 158          nextDay = (cal.getTimeInMillis() + daySpanMill) / 1000;
 159          return nextDay;
 160      }
 161  
 162      /**
 163       *
 164       * @param day Long Êó∂Èó¥
 165       * @param scope String Á∫ßÂà´&lt;br&gt;&quot;MS&quot;ÔºöÊØ´ÁßíÁ∫ß&lt;br&gt;&quot;S&quot;:ÁßíÁ∫ß
 166       * @return
 167       */
 168      public static long getNextDayStart(long day,String scope) {
 169      	if(&quot;MS&quot;.equals(scope)){
 170      		return getNextDayStart(day)*1000;
 171      	}else if(&quot;S&quot;.equals(scope)){
 172      		return getNextDayStart(day);
 173      	}else{
 174      		return getNextDayStart(day);
 175      	}







 176      }
 177  
 178  
 179      /**
 180       *
 181       * @param day
 182       * @return
 183       */
 184      public static long getMonthFirst(long day) {
 185          long firstDay = 0L;
 186          Calendar cal = Calendar.getInstance();
 187          cal.setTime(new Date(day * 1000));
 188          cal.set(Calendar.DAY_OF_MONTH, 1);
 189          cal.set(Calendar.HOUR_OF_DAY, 0);
 190          cal.set(Calendar.MINUTE, 0);
 191          cal.set(Calendar.SECOND, 0);
 192          cal.set(Calendar.MILLISECOND, 0);
 193          firstDay = cal.getTimeInMillis() / 1000;
 194          return firstDay;
 195      }
 196  
 197      /**
 198       * @param day
 199       * @return
 200       */
 201      public static int getMonth(long day) {
 202          Calendar cal = Calendar.getInstance();
 203          cal.setTime(new Date(day * 1000));
 204          return cal.get(Calendar.MONTH) + 1;
 205      }
 206  
 207      /**
 208       *
 209       * @author yumo.lck
 210       */
 211      public static int getYear(long day) {
 212          Calendar cal = Calendar.getInstance();
 213          cal.setTime(new Date(day * 1000));
 214          return cal.get(Calendar.YEAR);
 215      }
 216  
 217      /**
 218       *
 219       * @param day
 220       * @return
 221       */
 222      public static long getWeekFirst(long day) {
 223          long firstDay = 0L;
 224          Calendar cal = Calendar.getInstance();
 225          cal.setTime(new Date(day * 1000));
 226          cal.setFirstDayOfWeek(Calendar.MONDAY);
 227          cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
 228          cal.set(Calendar.HOUR_OF_DAY, 0);
 229          cal.set(Calendar.MINUTE, 0);
 230          cal.set(Calendar.SECOND, 0);
 231          cal.set(Calendar.MILLISECOND, 0);
 232          firstDay = cal.getTimeInMillis() / 1000;
 233          return firstDay;
 234      }
 235  
 236      /**
 237       * Ê†πÊçÆÊüê‰∏™Êó•ÊúüÊó∂Èó¥Êà≥ÁßíÂÄºÔºåËé∑ÂèñÊâÄÂú®Âë®Âú®‰∏ÄÂπ¥‰∏≠ÊòØÁ¨¨Âá†Âë®.
 238       *
 239       * @param day
 240       * @return
 241       */
 242      public static int getWeekOfYear(long day) {
 243          Calendar cal = Calendar.getInstance();
 244          cal.setTime(new Date(day * 1000));
 245          return cal.get(Calendar.WEEK_OF_YEAR);
 246      }
 247  
 248      /**
 249       *
 250       * @param day
 251       * @param inFormat
 252       * @param outFormat
 253       * @return String
 254       * @throws ParseException
 255       */
 256      public static String getYesterdayByString(String day, String inFormat, String outFormat){
 257          try {
 258  			SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 259  			Date date = sdf.parse(day);
 260  			Calendar calendar = Calendar.getInstance();
 261  			calendar.setTime(date);
 262  			int calendarDay = calendar.get(Calendar.DATE);
 263  			calendar.set(Calendar.DATE, calendarDay - 1);
 264  			String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 265  			return dayBefore;
 266  		} catch (ParseException e) {
 267  			return null;
 268  		}











 269      }
 270  
 271      /**
 272       *
 273       * @param day
 274       * @param inFormat
 275       * @param outFormat
 276       * @return String
 277       * @throws ParseException
 278       */
<abbr title=" 279      public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseException {"> 279      public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseException üîµ</abbr>
 280          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 281          Date date = sdf.parse(day);
 282          Calendar calendar = Calendar.getInstance();
 283          calendar.setTime(date);
 284          int calendarDay = calendar.get(Calendar.DATE);
 285          calendar.set(Calendar.DATE, calendarDay + 1);
 286          String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 287          return dayBefore;
 288      }
 289  
 290      /**
 291       *
 292       * @param date
 293       * @return Date
 294       * @throws ParseException
 295       */
 296      public static Date getTomorrowByDate(Date date) throws ParseException {
 297          Calendar calendar = Calendar.getInstance();
 298          calendar.setTime(date);
 299          int calendarDay = calendar.get(Calendar.DATE);
 300          calendar.set(Calendar.DATE, calendarDay + 1);
 301          return calendar.getTime();
 302      }
 303  
 304      /**
 305       *
 306       * @param day
 307       * @param inFormat
 308       * @param outFormat
 309       * @return String
 310       * @throws ParseException
 311       */
<abbr title=" 312      public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws ParseException {"> 312      public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws ParseExceptüîµ</abbr>
 313          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 314          Date date = sdf.parse(day);
 315          Calendar calendar = Calendar.getInstance();
 316          calendar.setTime(date);
 317          int calendarDay = calendar.get(Calendar.DATE);
 318          calendar.set(Calendar.DATE, calendarDay - 30);
 319          return new SimpleDateFormat(outFormat).format(calendar.getTime());
 320      }
 321  
 322      /**
 323       *
 324       * @param day
 325       * @param inFormat
 326       * @param outFormat
 327       * @return String
 328       * @throws ParseException
 329       */
<abbr title=" 330      public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws ParseException {"> 330      public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws ParseExceptiüîµ</abbr>
 331      	SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 332      	Date date = sdf.parse(day);
 333      	Calendar calendar = Calendar.getInstance();
 334      	calendar.setTime(date);
 335      	int calendarDay = calendar.get(Calendar.DATE);
 336      	calendar.set(Calendar.DATE, calendarDay + 30);
 337      	String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 338      	return dayBefore;








 339      }
 340  
 341  
 342      /**
 343       *
 344       * @param day
 345       * @param inFormat
 346       * @param outFormat
 347       * @return String
 348       * @throws ParseException
 349       */
 350      public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseException {
 351          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 352          Date date = sdf.parse(day);
 353          Calendar calendar = Calendar.getInstance();
 354          calendar.setTime(date);
 355          String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 356          return dayBefore;
 357      }
 358  
 359      public static long getDateMillToFormat(String day, String inFormat) throws ParseException {
 360          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 361          Date date = sdf.parse(day);
 362          Calendar calendar = Calendar.getInstance();
 363          calendar.setTime(date);
 364          return calendar.getTimeInMillis()/1000;
 365      }
 366  
 367      /**
 368       *
 369       * @author sishu.yss
 370       * @param year
 371       * @param month
 372       * @return
 373       */
 374      public static long getFirstDay4Month(int year, int month) {
 375          long firstDay = 0L;
 376          Calendar cal = Calendar.getInstance();
 377          cal.set(Calendar.YEAR, year);
 378          cal.set(Calendar.MONTH, month - 1);
 379          cal.set(Calendar.DAY_OF_MONTH, 1);
 380          cal.set(Calendar.HOUR_OF_DAY, 0);
 381          cal.set(Calendar.MINUTE, 0);
 382          cal.set(Calendar.SECOND, 0);
 383          cal.set(Calendar.MILLISECOND, 0);
 384          firstDay = cal.getTimeInMillis() / 1000;
 385          return firstDay;
 386      }
 387  
 388      /**
 389       *
 390       * @author yumo.lck
 391       * @param year
 392       * @param month
 393       * @return
 394       */
 395      public static long getLastDay4Month(int year, int month) {
 396          long lastDay = 0L;
 397          Calendar cal = Calendar.getInstance();
 398          cal.set(Calendar.YEAR, year);
 399          cal.set(Calendar.MONTH, month);
<abbr title=" 400          //1 represents a zero next month, can be seen as the end of the first day of the month most one day, but the data table on the last day of the zero point on the line"> 400          //1 represents a zero next month, can be seen as the end of the first day of the month most one day, but tüîµ</abbr>
 401          cal.set(Calendar.DAY_OF_MONTH, 0);
 402          cal.set(Calendar.HOUR_OF_DAY, 0);
 403          cal.set(Calendar.MINUTE, 0);
 404          cal.set(Calendar.SECOND, 0);
 405          cal.set(Calendar.MILLISECOND, 0);
 406          lastDay = cal.getTimeInMillis() / 1000;
 407          return lastDay;
 408      }
 409  
 410      /**
 411       *
 412       * @author yumo.lck
 413       * @param chooseFirstDay
 414       */
 415  
 416      public static long getBeforeMonthDay(long day, boolean chooseFirstDay) {
 417          long chooseDay = 0L;
 418          int currentMonth = getMonth(day);
 419          int currentYear = getYear(day);
 420          if (currentMonth &gt; 1) {
 421              currentMonth--;
 422          } else {
 423              currentYear--;
 424              currentMonth = 12;
 425          }
 426          if (chooseFirstDay) {
 427              chooseDay = getFirstDay4Month(currentYear, currentMonth);
 428              return chooseDay;
 429          } else {
 430              chooseDay = getLastDay4Month(currentYear, currentMonth);
 431              return chooseDay;
 432          }
 433  
 434      }
 435  
 436      /**
 437       * @return long
 438       */
 439      public static long getMillByOneDay() {
 440          Calendar cal = Calendar.getInstance();
 441          cal.set(Calendar.HOUR_OF_DAY, 0);
 442          cal.set(Calendar.MINUTE, 0);
 443          cal.set(Calendar.SECOND, 0);
 444          cal.set(Calendar.MILLISECOND, 0);
 445          return cal.getTimeInMillis() / 1000;
 446      }
 447  
 448      /**
 449       *
 450       * @return long
 451       */
 452      public static long getMillByYesDay() {
 453          Calendar cal = Calendar.getInstance();
 454          cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 1);
 455          cal.set(Calendar.HOUR_OF_DAY, 0);
 456          cal.set(Calendar.MINUTE, 0);
 457          cal.set(Calendar.SECOND, 0);
 458          cal.set(Calendar.MILLISECOND, 0);
 459          return cal.getTimeInMillis() / 1000;
 460      }
 461  
 462      /**
 463       *
 464       * @return
 465       */
 466      public static long getMillByLastWeekDay() {
 467          Calendar cal = Calendar.getInstance();
 468          cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 7);
 469          cal.set(Calendar.HOUR_OF_DAY, 0);
 470          cal.set(Calendar.MINUTE, 0);
 471          cal.set(Calendar.SECOND, 0);
 472          cal.set(Calendar.MILLISECOND, 0);
 473          return cal.getTimeInMillis() / 1000;
 474      }
 475  
 476     /**
 477      * @return long
 478      */



 479      public static long getMillByDay(int severalDays,String condition) {
 480      	int dateT=0;
 481          Calendar cal = Calendar.getInstance();
 482      	if(condition==null){
 483      		return getMillToDay(cal,dateT);
 484      	}





 485          if(&quot;-&quot;.equals(condition)){
 486          	dateT = (cal.get(Calendar.DATE) - severalDays);
 487          	return getMillToDay(cal,dateT);


 488          }
 489          if(&quot;+&quot;.equals(condition)){
 490          	dateT = (cal.get(Calendar.DATE) + severalDays);
 491          	return getMillToDay(cal,dateT);
 492          }
 493  		return getMillToDay(cal,dateT);
 494    }





 495  
 496      /**
 497       * @return long
 498       */
 499      public static long getStampByDay(int severalDays,String condition) {
 500      	int dateT=0;
 501      	Calendar cal = Calendar.getInstance();
 502      	if(condition==null){
 503      		return getStampToDay(cal,dateT);
 504      	}
 505      	if(&quot;-&quot;.equals(condition)){
 506      		dateT = (cal.get(Calendar.DATE) - severalDays);
 507      		return getStampToDay(cal,dateT);
 508      	}
 509      	if(&quot;+&quot;.equals(condition)){
 510      		dateT = (cal.get(Calendar.DATE) + severalDays);
 511      		return getStampToDay(cal,dateT);
 512      	}
 513      	return getStampToDay(cal,dateT);














 514      }
 515      /**
 516       * @return long
 517       */
 518      public static long getMillByDay(){
 519  		return getMillByDay(0,null);

 520      }
 521  
 522      /**
 523       * @param cal  Calendar
 524       * @param dateT Integer
 525       * @return  long
 526       */
 527      public static long getMillToDay(Calendar cal,int dateT){
 528  		   if(dateT!=0){
 529  			   cal.set(Calendar.DATE, dateT);
 530  		   }
 531  	       cal.set(Calendar.HOUR_OF_DAY, 0);
 532  	       cal.set(Calendar.MINUTE, 0);
 533  	       cal.set(Calendar.SECOND, 0);
 534  	       cal.set(Calendar.MILLISECOND, 0);
 535  	       return cal.getTimeInMillis()/1000;
 536  	}









 537  
 538      /**
 539       * @param cal  Calendar
 540       * @param dateT Integer
 541       * @return  long
 542       */
 543      public static long getStampToDay(Calendar cal,int dateT){
 544      	if(dateT!=0){
 545      		cal.set(Calendar.DATE, dateT);
 546      	}
 547      	return cal.getTimeInMillis();




 548      }
 549  
 550      public static String getToday() {
 551          Calendar cal = Calendar.getInstance();
 552          return cal.get(1) + &quot;Âπ¥&quot; + cal.get(2) + &quot;Êúà&quot; + cal.get(3) + &quot;Êó•&quot;;
 553      }
 554  
 555      /**
 556       * @param day
 557       * @return format time
 558       */
 559      public static String getDate(long day, String format) {
 560          Calendar cal = Calendar.getInstance();
 561          if ((&quot;&quot; + day).length() &gt; 10) {
 562              cal.setTime(new Date(day));
 563          } else {
 564              cal.setTime(new Date(day * 1000));
 565          }
 566          SimpleDateFormat sf = new SimpleDateFormat(format);
 567          return sf.format(cal.getTime());
 568      }
 569  
 570      /**
 571       *
 572       * @param  date
 573       * @return
 574       */
 575      public static String getDate(Date date, String format) {
 576          SimpleDateFormat sf = new SimpleDateFormat(format);
 577          return sf.format(date);
 578      }
 579  
 580  
 581      /**
 582       *
 583       * @param day
 584       * @param format
 585       * @return long
 586       * @throws ParseException
 587       */
 588      public static long stringToLong(String day, String format) throws ParseException {
 589      	SimpleDateFormat dateFormat = new SimpleDateFormat(format);

 590          long date = dateFormat.parse(day).getTime();
 591      	return date;

 592      }
 593  
 594      /**
 595       * @param day
 596       * @param format
 597       * @return Date
 598       * @throws ParseException
 599       */
 600      public static Date stringToDate(String day, String format)  {
 601      	try {
 602  			SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 603  			 Date date = dateFormat.parse(day);
 604  			return date;
 605  		} catch (ParseException e) {
 606  			return new Date();
 607  		}







 608      }
 609  
 610  
 611      /**
 612       * longÂûãÊó∂Èó¥Êà≥ËΩ¨‰∏∫StringÂûã
 613       *
 614       * @param day Áßí
 615       * @return Ê†ºÂºèÂåñÂêéÁöÑÊó•Êúü
 616       * @throws ParseException
 617       */
 618      public static String longToString(long day, String format) throws ParseException {
 619      	if ((&quot;&quot; + day).length() &lt;= 10){

 620              day=day*1000;
 621          }
 622      	SimpleDateFormat dateFormat = new SimpleDateFormat(format);
 623  	    String date = dateFormat.format(day);
 624      	return date;



 625      }
 626  
 627      /**
 628       *
 629       * @param day Áßí
 630       * @param minusDay ÈúÄË¶ÅÂáèÊéâÁöÑÂ§©Êï∞
 631       * @return Áßí
 632       */
 633      public static int getMinusDate(int day, int minusDay) {
 634          Calendar cal = Calendar.getInstance();
 635          cal.setTime(new Date(day * 1000));
 636          cal.set(Calendar.DATE, cal.get(Calendar.DATE) - minusDay);
 637          cal.set(Calendar.HOUR_OF_DAY, 0);
 638          cal.set(Calendar.MINUTE, 0);
 639          cal.set(Calendar.SECOND, 0);
 640          cal.set(Calendar.MILLISECOND, 0);
 641          return (int) cal.getTimeInMillis() / 1000;
 642      }
 643  
 644      /**
 645       *
 646       * @return long
 647       */
 648      public static long getMillByNow() {
 649          Calendar cal = Calendar.getInstance();
 650          cal.setTime(new Date());
 651          return cal.getTimeInMillis();
 652      }
 653  
 654  	public static int getWeeksBetweenTwoDates(long startDay, long endDay) {
 655  		int week = getWeekOfYear(endDay) - getWeekOfYear(startDay) + 1;
 656  		if(week&lt;1){
 657  			week = getWeekOfYear(endDay) + getMaxWeekOfYear(startDay) - getWeekOfYear(startDay) + 1;
 658  		}
 659  		return week;
 660  	}
 661  
 662  	public static int getMaxWeekOfYear(long startDay) {
 663  		Calendar cal = Calendar.getInstance();










 664          cal.setTime(new Date(startDay * 1000));
 665          return cal.getMaximum(Calendar.WEEK_OF_YEAR);
 666  	}
 667  
 668  	public static int getMonthsBetweenTwoDates(long startDay, long endDay) {
 669  		int month = DateUtil.getMonth(endDay) - DateUtil.getMonth(startDay) + 1;
 670  		if(month&lt;1){
 671  			month = getMonth(endDay) + 12 - getMonth(startDay) +1;
 672  		}
 673  		return month;
 674  	}
 675  
 676  	public static Date parseDate(String dateStr, String pattern){
 677  		SimpleDateFormat sdf = new SimpleDateFormat();
 678  		sdf.applyPattern(pattern);
 679  		try {
 680  			return sdf.parse(dateStr);
 681  		} catch (ParseException e) {
 682  			return null;
 683  		}
 684  	}
 685  
 686  	/**





















 687       *
 688       * @param time Long Êó∂Èó¥
 689       * @return long
 690       */
 691      public static long getMinuteStart(long time) {
 692          long firstDay = 0L;
 693          Calendar cal = Calendar.getInstance();
 694          if ((&quot;&quot; + time).length() &gt; 10) {
 695              cal.setTime(new Date(time));
 696          } else {
 697              cal.setTime(new Date(time * 1000));
 698          }
 699          cal.set(Calendar.SECOND, 0);
 700          cal.set(Calendar.MILLISECOND, 0);
 701          firstDay = cal.getTimeInMillis() / 1000;
 702          return firstDay;
 703      }
 704  
 705      /**
 706       * @param time Long
 707       * @return long
 708       */
 709      public static long getHourStart(long time) {
 710          long firstDay = 0L;
 711          Calendar cal = Calendar.getInstance();
 712          if ((&quot;&quot; + time).length() &gt; 10) {
 713              cal.setTime(new Date(time));
 714          } else {
 715              cal.setTime(new Date(time * 1000));
 716          }
 717          cal.set(Calendar.SECOND, 0);
 718          cal.set(Calendar.MILLISECOND, 0);
 719          cal.set(Calendar.MINUTE, 0);
 720          firstDay = cal.getTimeInMillis() / 1000;
 721          return firstDay;
 722      }
 723  
 724      /**
 725       * @param time
 726       * @return Date
 727       */
 728      public static Date getDateByLong(long time){
 729          Date date = new Date();
 730          date.setTime(time);
 731          return date;
 732      }
 733  
 734  
 735      public static Date parseDate(String dateStr, String pattern, Locale locale){
 736      	SimpleDateFormat df = new SimpleDateFormat(
 737  				pattern, locale);
 738  
 739  		df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));
 740  		try {
 741  			return df.parse(dateStr);
 742  		} catch (ParseException e) {
 743  			return null;
 744  		}
 745  	}










 746  
 747      public static String getDate(Date date, String format, Locale locale) {
 748      	SimpleDateFormat df = new SimpleDateFormat(
 749      			format, locale);
 750      	df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));



 751          return df.format(date);
 752      }
 753  
 754      public static java.sql.Timestamp columnToTimestamp(Object column) {
 755          if (column == null) {
 756              return null;
 757          } else if(column instanceof String) {
 758              return new java.sql.Timestamp(stringToDate((String)column).getTime());
 759          } else if (column instanceof Integer) {
 760              Integer rawData = (Integer) column;
 761              return new java.sql.Timestamp(rawData.longValue());
 762          } else if (column instanceof Long) {
 763              Long rawData = (Long) column;
 764              return new java.sql.Timestamp(rawData.longValue());
 765          } else if (column instanceof java.sql.Date) {
 766              return (java.sql.Timestamp) column;
 767          } else if(column instanceof Timestamp) {
 768              return (Timestamp) column;
 769          } else if(column instanceof Date) {
 770              Date d = (Date)column;
 771              return new java.sql.Timestamp(d.getTime());
 772          }
 773  
 774          throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
 775      }
 776  
 777      public static String dateToString(Date date) {
 778          LocalDateTime localDateTime = dateToLocalDateTime(date);
 779          return localDateTime.format(DATE_FORMATTER);
 780      }
 781  
 782      public static String timestampToString(Date date) {
 783          LocalDateTime localDateTime = dateToLocalDateTime(date);
 784          return localDateTime.format(DATE_TIME_FORMATTER);
 785      }





















 786  }</pre></td>
                            <td><pre>   1  /*
   2   * Licensed to the Apache Software Foundation (ASF) under one
   3   * or more contributor license agreements.  See the NOTICE file
   4   * distributed with this work for additional information
   5   * regarding copyright ownership.  The ASF licenses this file
   6   * to you under the Apache License, Version 2.0 (the
   7   * &quot;License&quot;); you may not use this file except in compliance
   8   * with the License.  You may obtain a copy of the License at
   9   *
  10   *     http://www.apache.org/licenses/LICENSE-2.0
  11   *
  12   * Unless required by applicable law or agreed to in writing, software
  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  15   * See the License for the specific language governing permissions and
  16   * limitations under the License.
  17   */
  18  
  19  
  20  
  21  package com.dtstack.flink.sql.util;
  22  
  23  import java.sql.Timestamp;
  24  import java.text.ParseException;
  25  import java.text.SimpleDateFormat;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  26 -import java.time.LocalDate;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  27 -import java.time.LocalDateTime;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  28 -import java.time.LocalTime;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  29 -import java.time.ZoneId;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  30 +import java.time.*;</span>
  31  import java.time.format.DateTimeFormatter;
  32  import java.time.format.DateTimeParseException;
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  33 -import java.util.Calendar;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  34 -import java.util.Date;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  35 -import java.util.Locale;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0">  36 -import java.util.SimpleTimeZone;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  37 +import java.util.*;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  38 +import java.util.regex.Pattern;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  39 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  40 +import static java.time.format.DateTimeFormatter.ISO_INSTANT;</span>
  41  
  42  
  43  /**
  44   *
  45   * Reason: TODO ADD REASON(ÂèØÈÄâ)

  46   * Date: 2017Âπ¥03Êúà10Êó• ‰∏ãÂçà1:16:37
  47   * Company: www.dtstack.com
  48   * @author sishu.yss
  49   *
  50   */
  51  public class DateUtil {
  52  
  53      static final DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);
  54      static final DateTimeFormatter DATE_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;);
  55      static final DateTimeFormatter TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;HH:mm:ss&quot;);
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  56 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title="  57 +    private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3,9})?Z$&quot;);">  57 +    private static final Pattern DATETIME = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}T\\d{2}:\\d{2}:\\d{üîµ</abbr></span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  58 +    private static final Pattern DATE = Pattern.compile(&quot;^\\d{4}-(?:0[0-9]|1[0-2])-[0-9]{2}$&quot;);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  59 +    private static final int MILLIS_PER_SECOND = 1000;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  60 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  61 +</span>
  62  
  63      public static java.sql.Date columnToDate(Object column) {
  64          if(column instanceof String) {
  65              return new java.sql.Date(stringToDate((String)column).getTime());
  66          } else if (column instanceof Integer) {
  67              Integer rawData = (Integer) column;
  68              return new java.sql.Date(rawData.longValue());
  69          } else if (column instanceof Long) {
  70              Long rawData = (Long) column;
  71              return new java.sql.Date(rawData.longValue());
  72          } else if (column instanceof java.sql.Date) {
  73              return (java.sql.Date) column;
  74          } else if(column instanceof Timestamp) {
  75              Timestamp ts = (Timestamp) column;
  76              return new java.sql.Date(ts.getTime());
  77          }
  78          throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
  79      }
  80  
  81      public static Date stringToDate(String strDate)  {
  82          if(strDate == null){
  83              return null;
  84          }
  85          try {
  86              ;
  87              return localDateTimetoDate(LocalDateTime.parse(strDate, DATE_TIME_FORMATTER));
  88          } catch (DateTimeParseException ignored) {
  89          }
  90  
  91          try {
  92              return localDateTimetoDate(LocalDate.parse(strDate, DATE_FORMATTER).atStartOfDay());
  93          } catch (DateTimeParseException ignored) {
  94          }
  95  
  96          try {
<abbr title="  97              return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FORMATTER)));">  97              return localDateTimetoDate(LocalDateTime.of(LocalDate.now(), LocalTime.parse(strDate, TIME_FORMATTER))üîµ</abbr>
  98          } catch (DateTimeParseException ignored) {
  99          }
 100  
 101          throw new RuntimeException(&quot;can&#x27;t parse date&quot;);
 102      }
 103  
 104      public static Date localDateTimetoDate(LocalDateTime localDateTime){
 105          return Date.from(localDateTime.atZone(ZoneId.systemDefault()).toInstant());
 106      }
 107  
 108      public static LocalDateTime dateToLocalDateTime(Date date){
 109          return date.toInstant().atZone(ZoneId.systemDefault()).toLocalDateTime();
 110      }
 111  
 112      /**
 113       *
 114       *
 115       * @param day Long Êó∂Èó¥
 116       * @return long
 117       */
 118      public static long getTodayStart(long day) {
 119          long firstDay = 0L;
 120          Calendar cal = Calendar.getInstance();
 121          if ((&quot;&quot; + day).length() &gt; 10) {
 122              cal.setTime(new Date(day));
 123          } else {
 124              cal.setTime(new Date(day * 1000));
 125          }
 126          cal.set(Calendar.HOUR_OF_DAY, 0);
 127          cal.set(Calendar.MINUTE, 0);
 128          cal.set(Calendar.SECOND, 0);
 129          cal.set(Calendar.MILLISECOND, 0);
 130          firstDay = cal.getTimeInMillis() / 1000;
 131          return firstDay;
 132      }
 133  
 134      /**
 135       *
 136       * @param day Long Êó∂Èó¥
 137       * @param scope
 138       * @return
 139       */
 140      public static long getTodayStart(long day,String scope) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 141 -    	if(&quot;MS&quot;.equals(scope)){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 142 -    		return getTodayStart(day)*1000;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 143 -    	}else if(&quot;S&quot;.equals(scope)){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 144 -    		return getTodayStart(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 145 -    	}else{</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 146 -    		return getTodayStart(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 147 -    	}</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 148 +        if(&quot;MS&quot;.equals(scope)){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 149 +            return getTodayStart(day)*1000;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +        }else if(&quot;S&quot;.equals(scope)){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 151 +            return getTodayStart(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 152 +        }else{</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +            return getTodayStart(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 154 +        }</span>
 155      }
 156  
 157      /**
 158       *
 159       * @param day Long Êó∂Èó¥
 160       * @return long
 161       */
 162      public static long getNextDayStart(long day) {
 163          long daySpanMill = 86400000L;
 164          long nextDay = 0L;
 165          Calendar cal = Calendar.getInstance();
 166          if ((&quot;&quot; + day).length() &gt; 10) {
 167              cal.setTime(new Date(day));
 168          } else {
 169              cal.setTime(new Date(day * 1000));
 170          }
 171          cal.set(Calendar.HOUR_OF_DAY, 0);
 172          cal.set(Calendar.MINUTE, 0);
 173          cal.set(Calendar.SECOND, 0);
 174          cal.set(Calendar.MILLISECOND, 0);
 175          nextDay = (cal.getTimeInMillis() + daySpanMill) / 1000;
 176          return nextDay;
 177      }
 178  
 179      /**
 180       *
 181       * @param day Long Êó∂Èó¥
 182       * @param scope String Á∫ßÂà´&lt;br&gt;&quot;MS&quot;ÔºöÊØ´ÁßíÁ∫ß&lt;br&gt;&quot;S&quot;:ÁßíÁ∫ß
 183       * @return
 184       */
 185      public static long getNextDayStart(long day,String scope) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 186 -    	if(&quot;MS&quot;.equals(scope)){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 187 -    		return getNextDayStart(day)*1000;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 188 -    	}else if(&quot;S&quot;.equals(scope)){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 189 -    		return getNextDayStart(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 190 -    	}else{</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 191 -    		return getNextDayStart(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 192 -    	}</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 193 +        if(&quot;MS&quot;.equals(scope)){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 194 +            return getNextDayStart(day)*1000;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 195 +        }else if(&quot;S&quot;.equals(scope)){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 196 +            return getNextDayStart(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 197 +        }else{</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 198 +            return getNextDayStart(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 199 +        }</span>
 200      }
 201  
 202  
 203      /**
 204       *
 205       * @param day
 206       * @return
 207       */
 208      public static long getMonthFirst(long day) {
 209          long firstDay = 0L;
 210          Calendar cal = Calendar.getInstance();
 211          cal.setTime(new Date(day * 1000));
 212          cal.set(Calendar.DAY_OF_MONTH, 1);
 213          cal.set(Calendar.HOUR_OF_DAY, 0);
 214          cal.set(Calendar.MINUTE, 0);
 215          cal.set(Calendar.SECOND, 0);
 216          cal.set(Calendar.MILLISECOND, 0);
 217          firstDay = cal.getTimeInMillis() / 1000;
 218          return firstDay;
 219      }
 220  
 221      /**
 222       * @param day
 223       * @return
 224       */
 225      public static int getMonth(long day) {
 226          Calendar cal = Calendar.getInstance();
 227          cal.setTime(new Date(day * 1000));
 228          return cal.get(Calendar.MONTH) + 1;
 229      }
 230  
 231      /**
 232       *
 233       * @author yumo.lck
 234       */
 235      public static int getYear(long day) {
 236          Calendar cal = Calendar.getInstance();
 237          cal.setTime(new Date(day * 1000));
 238          return cal.get(Calendar.YEAR);
 239      }
 240  
 241      /**
 242       *
 243       * @param day
 244       * @return
 245       */
 246      public static long getWeekFirst(long day) {
 247          long firstDay = 0L;
 248          Calendar cal = Calendar.getInstance();
 249          cal.setTime(new Date(day * 1000));
 250          cal.setFirstDayOfWeek(Calendar.MONDAY);
 251          cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
 252          cal.set(Calendar.HOUR_OF_DAY, 0);
 253          cal.set(Calendar.MINUTE, 0);
 254          cal.set(Calendar.SECOND, 0);
 255          cal.set(Calendar.MILLISECOND, 0);
 256          firstDay = cal.getTimeInMillis() / 1000;
 257          return firstDay;
 258      }
 259  
 260      /**
 261       * Ê†πÊçÆÊüê‰∏™Êó•ÊúüÊó∂Èó¥Êà≥ÁßíÂÄºÔºåËé∑ÂèñÊâÄÂú®Âë®Âú®‰∏ÄÂπ¥‰∏≠ÊòØÁ¨¨Âá†Âë®.
 262       *
 263       * @param day
 264       * @return
 265       */
 266      public static int getWeekOfYear(long day) {
 267          Calendar cal = Calendar.getInstance();
 268          cal.setTime(new Date(day * 1000));
 269          return cal.get(Calendar.WEEK_OF_YEAR);
 270      }
 271  
 272      /**
 273       *
 274       * @param day
 275       * @param inFormat
 276       * @param outFormat
 277       * @return String
 278       * @throws ParseException
 279       */
 280      public static String getYesterdayByString(String day, String inFormat, String outFormat){
 281          try {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 282 -			SimpleDateFormat sdf = new SimpleDateFormat(inFormat);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 283 -			Date date = sdf.parse(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 284 -			Calendar calendar = Calendar.getInstance();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 285 -			calendar.setTime(date);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 286 -			int calendarDay = calendar.get(Calendar.DATE);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 287 -			calendar.set(Calendar.DATE, calendarDay - 1);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 288 -			String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 289 -			return dayBefore;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 290 -		} catch (ParseException e) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 291 -			return null;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 292 -		}</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 293 +            SimpleDateFormat sdf = new SimpleDateFormat(inFormat);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 294 +            Date date = sdf.parse(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 295 +            Calendar calendar = Calendar.getInstance();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 296 +            calendar.setTime(date);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 297 +            int calendarDay = calendar.get(Calendar.DATE);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 298 +            calendar.set(Calendar.DATE, calendarDay - 1);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 299 +            String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 300 +            return dayBefore;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 301 +        } catch (ParseException e) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 302 +            return null;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 303 +        }</span>
 304      }
 305  
 306      /**
 307       *
 308       * @param day
 309       * @param inFormat
 310       * @param outFormat
 311       * @return String
 312       * @throws ParseException
 313       */
<abbr title=" 314      public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseException {"> 314      public static String getTomorrowByString(String day, String inFormat, String outFormat) throws ParseException üîµ</abbr>
 315          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 316          Date date = sdf.parse(day);
 317          Calendar calendar = Calendar.getInstance();
 318          calendar.setTime(date);
 319          int calendarDay = calendar.get(Calendar.DATE);
 320          calendar.set(Calendar.DATE, calendarDay + 1);
 321          String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 322          return dayBefore;
 323      }
 324  
 325      /**
 326       *
 327       * @param date
 328       * @return Date
 329       * @throws ParseException
 330       */
 331      public static Date getTomorrowByDate(Date date) throws ParseException {
 332          Calendar calendar = Calendar.getInstance();
 333          calendar.setTime(date);
 334          int calendarDay = calendar.get(Calendar.DATE);
 335          calendar.set(Calendar.DATE, calendarDay + 1);
 336          return calendar.getTime();
 337      }
 338  
 339      /**
 340       *
 341       * @param day
 342       * @param inFormat
 343       * @param outFormat
 344       * @return String
 345       * @throws ParseException
 346       */
<abbr title=" 347      public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws ParseException {"> 347      public static String get30DaysBeforeByString(String day, String inFormat, String outFormat) throws ParseExceptüîµ</abbr>
 348          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 349          Date date = sdf.parse(day);
 350          Calendar calendar = Calendar.getInstance();
 351          calendar.setTime(date);
 352          int calendarDay = calendar.get(Calendar.DATE);
 353          calendar.set(Calendar.DATE, calendarDay - 30);
 354          return new SimpleDateFormat(outFormat).format(calendar.getTime());
 355      }
 356  
 357      /**
 358       *
 359       * @param day
 360       * @param inFormat
 361       * @param outFormat
 362       * @return String
 363       * @throws ParseException
 364       */
<abbr title=" 365      public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws ParseException {"> 365      public static String get30DaysLaterByString(String day, String inFormat, String outFormat) throws ParseExceptiüîµ</abbr>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 366 -    	SimpleDateFormat sdf = new SimpleDateFormat(inFormat);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 367 -    	Date date = sdf.parse(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 368 -    	Calendar calendar = Calendar.getInstance();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 369 -    	calendar.setTime(date);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 370 -    	int calendarDay = calendar.get(Calendar.DATE);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 371 -    	calendar.set(Calendar.DATE, calendarDay + 30);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 372 -    	String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 373 -    	return dayBefore;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 374 +        SimpleDateFormat sdf = new SimpleDateFormat(inFormat);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 375 +        Date date = sdf.parse(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 376 +        Calendar calendar = Calendar.getInstance();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 377 +        calendar.setTime(date);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 378 +        int calendarDay = calendar.get(Calendar.DATE);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 379 +        calendar.set(Calendar.DATE, calendarDay + 30);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 380 +        String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 381 +        return dayBefore;</span>
 382      }
 383  
 384  
 385      /**
 386       *
 387       * @param day
 388       * @param inFormat
 389       * @param outFormat
 390       * @return String
 391       * @throws ParseException
 392       */
 393      public static String getDateStrToFormat(String day, String inFormat, String outFormat) throws ParseException {
 394          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 395          Date date = sdf.parse(day);
 396          Calendar calendar = Calendar.getInstance();
 397          calendar.setTime(date);
 398          String dayBefore = new SimpleDateFormat(outFormat).format(calendar.getTime());
 399          return dayBefore;
 400      }
 401  
 402      public static long getDateMillToFormat(String day, String inFormat) throws ParseException {
 403          SimpleDateFormat sdf = new SimpleDateFormat(inFormat);
 404          Date date = sdf.parse(day);
 405          Calendar calendar = Calendar.getInstance();
 406          calendar.setTime(date);
 407          return calendar.getTimeInMillis()/1000;
 408      }
 409  
 410      /**
 411       *
 412       * @author sishu.yss
 413       * @param year
 414       * @param month
 415       * @return
 416       */
 417      public static long getFirstDay4Month(int year, int month) {
 418          long firstDay = 0L;
 419          Calendar cal = Calendar.getInstance();
 420          cal.set(Calendar.YEAR, year);
 421          cal.set(Calendar.MONTH, month - 1);
 422          cal.set(Calendar.DAY_OF_MONTH, 1);
 423          cal.set(Calendar.HOUR_OF_DAY, 0);
 424          cal.set(Calendar.MINUTE, 0);
 425          cal.set(Calendar.SECOND, 0);
 426          cal.set(Calendar.MILLISECOND, 0);
 427          firstDay = cal.getTimeInMillis() / 1000;
 428          return firstDay;
 429      }
 430  
 431      /**
 432       *
 433       * @author yumo.lck
 434       * @param year
 435       * @param month
 436       * @return
 437       */
 438      public static long getLastDay4Month(int year, int month) {
 439          long lastDay = 0L;
 440          Calendar cal = Calendar.getInstance();
 441          cal.set(Calendar.YEAR, year);
 442          cal.set(Calendar.MONTH, month);
<abbr title=" 443          //1 represents a zero next month, can be seen as the end of the first day of the month most one day, but the data table on the last day of the zero point on the line"> 443          //1 represents a zero next month, can be seen as the end of the first day of the month most one day, but tüîµ</abbr>
 444          cal.set(Calendar.DAY_OF_MONTH, 0);
 445          cal.set(Calendar.HOUR_OF_DAY, 0);
 446          cal.set(Calendar.MINUTE, 0);
 447          cal.set(Calendar.SECOND, 0);
 448          cal.set(Calendar.MILLISECOND, 0);
 449          lastDay = cal.getTimeInMillis() / 1000;
 450          return lastDay;
 451      }
 452  
 453      /**
 454       *
 455       * @author yumo.lck
 456       * @param chooseFirstDay
 457       */
 458  
 459      public static long getBeforeMonthDay(long day, boolean chooseFirstDay) {
 460          long chooseDay = 0L;
 461          int currentMonth = getMonth(day);
 462          int currentYear = getYear(day);
 463          if (currentMonth &gt; 1) {
 464              currentMonth--;
 465          } else {
 466              currentYear--;
 467              currentMonth = 12;
 468          }
 469          if (chooseFirstDay) {
 470              chooseDay = getFirstDay4Month(currentYear, currentMonth);
 471              return chooseDay;
 472          } else {
 473              chooseDay = getLastDay4Month(currentYear, currentMonth);
 474              return chooseDay;
 475          }
 476  
 477      }
 478  
 479      /**
 480       * @return long
 481       */
 482      public static long getMillByOneDay() {
 483          Calendar cal = Calendar.getInstance();
 484          cal.set(Calendar.HOUR_OF_DAY, 0);
 485          cal.set(Calendar.MINUTE, 0);
 486          cal.set(Calendar.SECOND, 0);
 487          cal.set(Calendar.MILLISECOND, 0);
 488          return cal.getTimeInMillis() / 1000;
 489      }
 490  
 491      /**
 492       *
 493       * @return long
 494       */
 495      public static long getMillByYesDay() {
 496          Calendar cal = Calendar.getInstance();
 497          cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 1);
 498          cal.set(Calendar.HOUR_OF_DAY, 0);
 499          cal.set(Calendar.MINUTE, 0);
 500          cal.set(Calendar.SECOND, 0);
 501          cal.set(Calendar.MILLISECOND, 0);
 502          return cal.getTimeInMillis() / 1000;
 503      }
 504  
 505      /**
 506       *
 507       * @return
 508       */
 509      public static long getMillByLastWeekDay() {
 510          Calendar cal = Calendar.getInstance();
 511          cal.set(Calendar.DATE, cal.get(Calendar.DATE) - 7);
 512          cal.set(Calendar.HOUR_OF_DAY, 0);
 513          cal.set(Calendar.MINUTE, 0);
 514          cal.set(Calendar.SECOND, 0);
 515          cal.set(Calendar.MILLISECOND, 0);
 516          return cal.getTimeInMillis() / 1000;
 517      }
 518  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 519 -   /**</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 520 -    * @return long</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 521 -    */</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 522 +    /**</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 523 +     * @return long</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 524 +     */</span>
 525      public static long getMillByDay(int severalDays,String condition) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 526 -    	int dateT=0;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 527 -        Calendar cal = Calendar.getInstance();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 528 -    	if(condition==null){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 529 -    		return getMillToDay(cal,dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 530 -    	}</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 531 +        int dateT=0;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 532 +        Calendar cal = Calendar.getInstance();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 533 +        if(condition==null){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 534 +            return getMillToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 535 +        }</span>
 536          if(&quot;-&quot;.equals(condition)){
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 537 -        	dateT = (cal.get(Calendar.DATE) - severalDays);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 538 -        	return getMillToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 539 +            dateT = (cal.get(Calendar.DATE) - severalDays);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 540 +            return getMillToDay(cal,dateT);</span>
 541          }
 542          if(&quot;+&quot;.equals(condition)){
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 543 -        	dateT = (cal.get(Calendar.DATE) + severalDays);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 544 -        	return getMillToDay(cal,dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 545 -        }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 546 -		return getMillToDay(cal,dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 547 -  }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 548 +            dateT = (cal.get(Calendar.DATE) + severalDays);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 549 +            return getMillToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 550 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 551 +        return getMillToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 552 +    }</span>
 553  
 554      /**
 555       * @return long
 556       */
 557      public static long getStampByDay(int severalDays,String condition) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 558 -    	int dateT=0;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 559 -    	Calendar cal = Calendar.getInstance();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 560 -    	if(condition==null){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 561 -    		return getStampToDay(cal,dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 562 -    	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 563 -    	if(&quot;-&quot;.equals(condition)){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 564 -    		dateT = (cal.get(Calendar.DATE) - severalDays);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 565 -    		return getStampToDay(cal,dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 566 -    	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 567 -    	if(&quot;+&quot;.equals(condition)){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 568 -    		dateT = (cal.get(Calendar.DATE) + severalDays);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 569 -    		return getStampToDay(cal,dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 570 -    	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 571 -    	return getStampToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 572 +        int dateT=0;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 573 +        Calendar cal = Calendar.getInstance();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 574 +        if(condition==null){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 575 +            return getStampToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 576 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 577 +        if(&quot;-&quot;.equals(condition)){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 578 +            dateT = (cal.get(Calendar.DATE) - severalDays);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 579 +            return getStampToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 580 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 581 +        if(&quot;+&quot;.equals(condition)){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 582 +            dateT = (cal.get(Calendar.DATE) + severalDays);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 583 +            return getStampToDay(cal,dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 584 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 585 +        return getStampToDay(cal,dateT);</span>
 586      }
 587      /**
 588       * @return long
 589       */
 590      public static long getMillByDay(){
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 591 -		return getMillByDay(0,null);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 592 +        return getMillByDay(0,null);</span>
 593      }
 594  
 595      /**
 596       * @param cal  Calendar
 597       * @param dateT Integer
 598       * @return  long
 599       */
 600      public static long getMillToDay(Calendar cal,int dateT){
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 601 -		   if(dateT!=0){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 602 -			   cal.set(Calendar.DATE, dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 603 -		   }</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 604 -	       cal.set(Calendar.HOUR_OF_DAY, 0);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 605 -	       cal.set(Calendar.MINUTE, 0);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 606 -	       cal.set(Calendar.SECOND, 0);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 607 -	       cal.set(Calendar.MILLISECOND, 0);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 608 -	       return cal.getTimeInMillis()/1000;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 609 -	}</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 610 +        if(dateT!=0){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 611 +            cal.set(Calendar.DATE, dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 612 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 613 +        cal.set(Calendar.HOUR_OF_DAY, 0);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 614 +        cal.set(Calendar.MINUTE, 0);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 615 +        cal.set(Calendar.SECOND, 0);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 616 +        cal.set(Calendar.MILLISECOND, 0);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 617 +        return cal.getTimeInMillis()/1000;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 618 +    }</span>
 619  
 620      /**
 621       * @param cal  Calendar
 622       * @param dateT Integer
 623       * @return  long
 624       */
 625      public static long getStampToDay(Calendar cal,int dateT){
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 626 -    	if(dateT!=0){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 627 -    		cal.set(Calendar.DATE, dateT);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 628 -    	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 629 -    	return cal.getTimeInMillis();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 630 +        if(dateT!=0){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 631 +            cal.set(Calendar.DATE, dateT);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 632 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 633 +        return cal.getTimeInMillis();</span>
 634      }
 635  
 636      public static String getToday() {
 637          Calendar cal = Calendar.getInstance();
 638          return cal.get(1) + &quot;Âπ¥&quot; + cal.get(2) + &quot;Êúà&quot; + cal.get(3) + &quot;Êó•&quot;;
 639      }
 640  
 641      /**
 642       * @param day
 643       * @return format time
 644       */
 645      public static String getDate(long day, String format) {
 646          Calendar cal = Calendar.getInstance();
 647          if ((&quot;&quot; + day).length() &gt; 10) {
 648              cal.setTime(new Date(day));
 649          } else {
 650              cal.setTime(new Date(day * 1000));
 651          }
 652          SimpleDateFormat sf = new SimpleDateFormat(format);
 653          return sf.format(cal.getTime());
 654      }
 655  
 656      /**
 657       *
 658       * @param  date
 659       * @return
 660       */
 661      public static String getDate(Date date, String format) {
 662          SimpleDateFormat sf = new SimpleDateFormat(format);
 663          return sf.format(date);
 664      }
 665  
 666  
 667      /**
 668       *
 669       * @param day
 670       * @param format
 671       * @return long
 672       * @throws ParseException
 673       */
 674      public static long stringToLong(String day, String format) throws ParseException {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 675 -    	SimpleDateFormat dateFormat = new SimpleDateFormat(format);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 676 +        SimpleDateFormat dateFormat = new SimpleDateFormat(format);</span>
 677          long date = dateFormat.parse(day).getTime();
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 678 -    	return date;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 679 +        return date;</span>
 680      }
 681  
 682      /**
 683       * @param day
 684       * @param format
 685       * @return Date
 686       * @throws ParseException
 687       */
 688      public static Date stringToDate(String day, String format)  {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 689 -    	try {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 690 -			SimpleDateFormat dateFormat = new SimpleDateFormat(format);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 691 -			 Date date = dateFormat.parse(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 692 -			return date;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 693 -		} catch (ParseException e) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 694 -			return new Date();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 695 -		}</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 696 +        try {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 697 +            SimpleDateFormat dateFormat = new SimpleDateFormat(format);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 698 +            Date date = dateFormat.parse(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 699 +            return date;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 700 +        } catch (ParseException e) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 701 +            return new Date();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 702 +        }</span>
 703      }
 704  
 705  
 706      /**
 707       * longÂûãÊó∂Èó¥Êà≥ËΩ¨‰∏∫StringÂûã
 708       *
 709       * @param day Áßí
 710       * @return Ê†ºÂºèÂåñÂêéÁöÑÊó•Êúü
 711       * @throws ParseException
 712       */
 713      public static String longToString(long day, String format) throws ParseException {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 714 -    	if ((&quot;&quot; + day).length() &lt;= 10){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 715 +        if ((&quot;&quot; + day).length() &lt;= 10){</span>
 716              day=day*1000;
 717          }
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 718 -    	SimpleDateFormat dateFormat = new SimpleDateFormat(format);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 719 -	    String date = dateFormat.format(day);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 720 -    	return date;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 721 +        SimpleDateFormat dateFormat = new SimpleDateFormat(format);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 722 +        String date = dateFormat.format(day);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 723 +        return date;</span>
 724      }
 725  
 726      /**
 727       *
 728       * @param day Áßí
 729       * @param minusDay ÈúÄË¶ÅÂáèÊéâÁöÑÂ§©Êï∞
 730       * @return Áßí
 731       */
 732      public static int getMinusDate(int day, int minusDay) {
 733          Calendar cal = Calendar.getInstance();
 734          cal.setTime(new Date(day * 1000));
 735          cal.set(Calendar.DATE, cal.get(Calendar.DATE) - minusDay);
 736          cal.set(Calendar.HOUR_OF_DAY, 0);
 737          cal.set(Calendar.MINUTE, 0);
 738          cal.set(Calendar.SECOND, 0);
 739          cal.set(Calendar.MILLISECOND, 0);
 740          return (int) cal.getTimeInMillis() / 1000;
 741      }
 742  
 743      /**
 744       *
 745       * @return long
 746       */
 747      public static long getMillByNow() {
 748          Calendar cal = Calendar.getInstance();
 749          cal.setTime(new Date());
 750          return cal.getTimeInMillis();
 751      }
 752  
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 753 -	public static int getWeeksBetweenTwoDates(long startDay, long endDay) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 754 -		int week = getWeekOfYear(endDay) - getWeekOfYear(startDay) + 1;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 755 -		if(week&lt;1){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 756 -			week = getWeekOfYear(endDay) + getMaxWeekOfYear(startDay) - getWeekOfYear(startDay) + 1;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 757 -		}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 758 -		return week;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 759 -	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 760 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 761 -	public static int getMaxWeekOfYear(long startDay) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 762 -		Calendar cal = Calendar.getInstance();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 763 +    public static int getWeeksBetweenTwoDates(long startDay, long endDay) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 764 +        int week = getWeekOfYear(endDay) - getWeekOfYear(startDay) + 1;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 765 +        if(week&lt;1){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 766 +            week = getWeekOfYear(endDay) + getMaxWeekOfYear(startDay) - getWeekOfYear(startDay) + 1;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 767 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 768 +        return week;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 769 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 770 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 771 +    public static int getMaxWeekOfYear(long startDay) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 772 +        Calendar cal = Calendar.getInstance();</span>
 773          cal.setTime(new Date(startDay * 1000));
 774          return cal.getMaximum(Calendar.WEEK_OF_YEAR);
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 775 -	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 776 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 777 -	public static int getMonthsBetweenTwoDates(long startDay, long endDay) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 778 -		int month = DateUtil.getMonth(endDay) - DateUtil.getMonth(startDay) + 1;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 779 -		if(month&lt;1){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 780 -			month = getMonth(endDay) + 12 - getMonth(startDay) +1;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 781 -		}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 782 -		return month;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 783 -	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 784 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 785 -	public static Date parseDate(String dateStr, String pattern){</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 786 -		SimpleDateFormat sdf = new SimpleDateFormat();</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 787 -		sdf.applyPattern(pattern);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 788 -		try {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 789 -			return sdf.parse(dateStr);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 790 -		} catch (ParseException e) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 791 -			return null;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 792 -		}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 793 -	}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 794 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 795 -	/**</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 796 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 797 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 798 +    public static int getMonthsBetweenTwoDates(long startDay, long endDay) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 799 +        int month = DateUtil.getMonth(endDay) - DateUtil.getMonth(startDay) + 1;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 800 +        if(month&lt;1){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 801 +            month = getMonth(endDay) + 12 - getMonth(startDay) +1;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 802 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 803 +        return month;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 804 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 805 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 806 +    public static Date parseDate(String dateStr, String pattern){</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 807 +        SimpleDateFormat sdf = new SimpleDateFormat();</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 808 +        sdf.applyPattern(pattern);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 809 +        try {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 810 +            return sdf.parse(dateStr);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 811 +        } catch (ParseException e) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 812 +            return null;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 813 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 814 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 815 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 816 +    /**</span>
 817       *
 818       * @param time Long Êó∂Èó¥
 819       * @return long
 820       */
 821      public static long getMinuteStart(long time) {
 822          long firstDay = 0L;
 823          Calendar cal = Calendar.getInstance();
 824          if ((&quot;&quot; + time).length() &gt; 10) {
 825              cal.setTime(new Date(time));
 826          } else {
 827              cal.setTime(new Date(time * 1000));
 828          }
 829          cal.set(Calendar.SECOND, 0);
 830          cal.set(Calendar.MILLISECOND, 0);
 831          firstDay = cal.getTimeInMillis() / 1000;
 832          return firstDay;
 833      }
 834  
 835      /**
 836       * @param time Long
 837       * @return long
 838       */
 839      public static long getHourStart(long time) {
 840          long firstDay = 0L;
 841          Calendar cal = Calendar.getInstance();
 842          if ((&quot;&quot; + time).length() &gt; 10) {
 843              cal.setTime(new Date(time));
 844          } else {
 845              cal.setTime(new Date(time * 1000));
 846          }
 847          cal.set(Calendar.SECOND, 0);
 848          cal.set(Calendar.MILLISECOND, 0);
 849          cal.set(Calendar.MINUTE, 0);
 850          firstDay = cal.getTimeInMillis() / 1000;
 851          return firstDay;
 852      }
 853  
 854      /**
 855       * @param time
 856       * @return Date
 857       */
 858      public static Date getDateByLong(long time){
 859          Date date = new Date();
 860          date.setTime(time);
 861          return date;
 862      }
 863  
 864  
 865      public static Date parseDate(String dateStr, String pattern, Locale locale){
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 866 -    	SimpleDateFormat df = new SimpleDateFormat(</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 867 -				pattern, locale);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 868 -</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 869 -		df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 870 -		try {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 871 -			return df.parse(dateStr);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 872 -		} catch (ParseException e) {</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 873 -			return null;</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 874 -		}</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 875 -	}</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 876 +        SimpleDateFormat df = new SimpleDateFormat(</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 877 +                pattern, locale);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 878 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 879 +        df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 880 +        try {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 881 +            return df.parse(dateStr);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 882 +        } catch (ParseException e) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 883 +            return null;</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 884 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 885 +    }</span>
 886  
 887      public static String getDate(Date date, String format, Locale locale) {
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 888 -    	SimpleDateFormat df = new SimpleDateFormat(</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 889 -    			format, locale);</span>
<span style="background-color: rgba(255, 0, 0, 0.2);; margin: 0"> 890 -    	df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 891 +        SimpleDateFormat df = new SimpleDateFormat(</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 892 +                format, locale);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 893 +        df.setTimeZone(new SimpleTimeZone(0, &quot;GMT&quot;));</span>
 894          return df.format(date);
 895      }
 896  
 897      public static java.sql.Timestamp columnToTimestamp(Object column) {
 898          if (column == null) {
 899              return null;
 900          } else if(column instanceof String) {
 901              return new java.sql.Timestamp(stringToDate((String)column).getTime());
 902          } else if (column instanceof Integer) {
 903              Integer rawData = (Integer) column;
 904              return new java.sql.Timestamp(rawData.longValue());
 905          } else if (column instanceof Long) {
 906              Long rawData = (Long) column;
 907              return new java.sql.Timestamp(rawData.longValue());
 908          } else if (column instanceof java.sql.Date) {
 909              return (java.sql.Timestamp) column;
 910          } else if(column instanceof Timestamp) {
 911              return (Timestamp) column;
 912          } else if(column instanceof Date) {
 913              Date d = (Date)column;
 914              return new java.sql.Timestamp(d.getTime());
 915          }
 916  
 917          throw new IllegalArgumentException(&quot;Can&#x27;t convert &quot; + column.getClass().getName() + &quot; to Date&quot;);
 918      }
 919  
 920      public static String dateToString(Date date) {
 921          LocalDateTime localDateTime = dateToLocalDateTime(date);
 922          return localDateTime.format(DATE_FORMATTER);
 923      }
 924  
 925      public static String timestampToString(Date date) {
 926          LocalDateTime localDateTime = dateToLocalDateTime(date);
 927          return localDateTime.format(DATE_TIME_FORMATTER);
 928      }
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 929 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 930 +    public static Timestamp getTimestampFromStr(String timeStr) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 931 +        if (DATETIME.matcher(timeStr).matches()) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 932 +            Instant instant = Instant.from(ISO_INSTANT.parse(timeStr));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 933 +            return new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 934 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 935 +        return new Timestamp(stringToDate(timeStr).getTime());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 936 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 937 +</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 938 +    public static java.sql.Date getDateFromStr(String dateStr) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 939 +        if (DATE.matcher(dateStr).matches()) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 940 +            Instant instant = LocalDate.parse(dateStr).atTime(LocalTime.of(0, 0, 0, 0)).toInstant(ZoneOffset.UTC);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 941 +            int offset = TimeZone.getDefault().getOffset(instant.toEpochMilli());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 942 +            return new java.sql.Date(instant.toEpochMilli() - offset);</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 943 +        } else if (DATETIME.matcher(dateStr).matches()) {</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 944 +            Instant instant = Instant.from(ISO_INSTANT.parse(dateStr));</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 945 +            return new java.sql.Date(instant.toEpochMilli());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 946 +        }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 947 +        return new java.sql.Date(stringToDate(dateStr).getTime());</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 948 +    }</span>
<span style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 949 +</span>
 950  }</pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            