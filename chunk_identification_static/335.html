<!DOCTYPE html>
    <html lang="en">
              <head>
                <meta charset="utf-8">
                <title>335</title>
                    <style>
                        #top {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        #bottom {
                            height: 48vh;
                            overflow-y: auto;
                        }
                        .highlighted {
                            background-color: rgba(177, 82, 227, 0.85) !important;
                        }
                    </style>
                    <script>
                        function enter(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.add('highlighted');
                            }
                        }
                        function out(c) {
                            const lines = document.getElementsByClassName(c);
                            for (let i = 0; i < lines.length; i++) {
                               lines.item(i).classList.remove('highlighted');
                            }
                        }
                    </script>
              </head>
              <body>
                <span style="height: 4vh">
                    335
                    <a href="334.html">prev</a>
                    <a href="336.html">next</a>
                    <a href="335_chunks.html">chunks</a>
                    <a href="index.html">index</a>
                    DTStack/flinkStreamSQL_56df6ec562e5de006c036fc5b7dfd89cbd445219_redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java
                    <textarea rows=1 onclick='navigator.clipboard.writeText(this.value)'>cd C:\studies\se\mega\git-analyzer-plus\notebooks\debug
del /Q *
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;56df6ec562e5de006c036fc5b7dfd89cbd445219:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; committed.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;56df6ec562e5de006c036fc5b7dfd89cbd445219^1:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; ours.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;56df6ec562e5de006c036fc5b7dfd89cbd445219^2:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; theirs.java
git -C C:\studies\se\mega\project-dirs\projects_Java_desc-stars-1000\DTStack\flinkStreamSQL show &quot;6d396e5a6320f951f7b6e0f9f656b5ded67bea85:redis5/redis5-side/redis-async-side/src/main/java/com/dtstack/flink/sql/side/redis/RedisAsyncReqRow.java&quot; &gt; base.java
copy ours.java 1ours.java
copy ours.java 2ours.java
copy theirs.java 1theirs.java
copy theirs.java 2theirs.java
copy base.java 1base.java
copy base.java 2base.java
&quot;C:\Program Files\Java\jdk1.8.0_241\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\jFSTMerge\build\libs\jFSTMerge-all.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\1theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\jfstmerge.java --show-base
&quot;C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot\bin\java.exe&quot; -Dfile.encoding=UTF-8 -jar &quot;C:\studies\se\spork\target\spork-0.5.0-SNAPSHOT.jar&quot; C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2ours.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2base.java C:\studies\se\mega\git-analyzer-plus\notebooks\debug\2theirs.java -o C:\studies\se\mega\git-analyzer-plus\notebooks\debug\spork.java
del /Q 1*.java
del /Q 2*.java
del /Q jfstmerge.java.merge
</textarea>
                    {strict: [[bj]], subset: [[bj]]}
                </span>
                <div id="top">

                    <table>
                        <tr>
                            <th>line based (standard git)</th>
                            <th>jfstmerge</th>
                            <th>spork</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  23 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  24 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  25 import com.google.common.collect.Maps;                                                                   </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  26 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  27 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  28 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  29 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  30 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  31 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  32                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  33 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  34 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  35 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  36 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  37 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  38 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  39 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  40 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  41 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  42 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  43 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  44 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  45 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  46 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  47 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  48 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  49 import org.apache.commons.lang.StringUtils;                                                              </span>
<span  style="">  50                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  51 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  52 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  53 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  54 import java.util.function.Consumer;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  56  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  58 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  59                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  60     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  61                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  62     private RedisClient redisClient;                                                                     </span>
<span  style="">  63                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  64     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  65                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  66     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  67                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  68     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  69                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  70     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  71                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  72     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  73                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  74     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  75                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  76     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  76     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  77         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  78         redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  81     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  82     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  83         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  84         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  85         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86     }                                                                                                    </span>
<span  style="">  87                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  88     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  89         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  90         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  91         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  92             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  93         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  94             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  96         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  97         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  98             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style=""> 100         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style=""> 101             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 102                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 103                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 104                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 105                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 106                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 107                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 108             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 109                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 110                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 111                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 111                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 112                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 113                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 114                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 115                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 116             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 117                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 118                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 119                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 120                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 121                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 122             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 123                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 127     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 128     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 129         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130     }                                                                                                    </span>
<span  style=""> 131                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 132     @Override                                                                                            </span>
<span class="3547897215975148581" onmouseenter="enter('3547897215975148581');" onmouseout="out('3547897215975148581');" style=""><abbr title=" 133     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 133     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resulðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 134         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 135         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 136             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137         }                                                                                                </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 138         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 139         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 140             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 141             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 142                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 143                     try {                                                                                </span>
<span class="-4667942192763773056" onmouseenter="enter('-4667942192763773056');" onmouseout="out('-4667942192763773056');" style=""> 144 &lt;&lt;&lt;&lt;&lt;&lt;&lt; GitAnalyzerPlus_ours                                                                             </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145                         Row row = fillData(input.row(), values);                                         </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));    </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 147                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="6741223626729319096" onmouseenter="enter('6741223626729319096');" onmouseout="out('6741223626729319096');" style=""> 148 ||||||| GitAnalyzerPlus_base                                                                             </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149                         Row row = fillData(input.row(), values);                                         </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 152                     } catch (Exception e) {                                                              </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 153 =======                                                                                                  </span>
<span class="1084775360844291959" onmouseenter="enter('1084775360844291959');" onmouseout="out('1084775360844291959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                         Row row = fillData(input, values);                                               </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-964628810921806489" onmouseenter="enter('-964628810921806489');" onmouseout="out('-964628810921806489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 156                         RowDataComplete.completeRow(resultFuture, row);                                  </span>
<span class="-1382546150375666264" onmouseenter="enter('-1382546150375666264');" onmouseout="out('-1382546150375666264');" style=""> 157 &gt;&gt;&gt;&gt;&gt;&gt;&gt; GitAnalyzerPlus_theirs                                                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 158                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 159                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 161                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 162                     dealMissKey(input, resultFuture);                                                    </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 163                     dealCacheData(key,CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 166         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167     }                                                                                                    </span>
<span  style=""> 168                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 169     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 170     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style=""> 171         StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                 </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style=""> 172         List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                  </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style=""> 173         for(String primaryKey : primaryKeys){                                                            </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style=""> 174             if(!refData.containsKey(primaryKey)){                                                        </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 175                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176             }                                                                                            </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style=""> 177             keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 178         }                                                                                                </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style=""> 179         return keyBuilder.toString();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180     }                                                                                                    </span>
<span  style=""> 181                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 182     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 183     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 184         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 185         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 186             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 187         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 188         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 189             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 190         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 191         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 192             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 194         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 195             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 197     }                                                                                                    </span>
<span  style=""> 198                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 199 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span  style="">  18                                                                                                          </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  20                                                                                                          </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  23 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  24 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  25 import com.google.common.collect.Maps;                                                                   </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  26 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  27 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  28 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  29 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  30 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  31 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  32                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  33 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  34 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  35 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  36 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  37 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  38 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  39 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  40 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  41 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  42 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  43 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  44 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  45 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  46 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  47 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  48 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  49 import org.apache.commons.lang.StringUtils;                                                              </span>
<span  style="">  50                                                                                                          </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  51 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  52 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  53 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  54 import java.util.function.Consumer;                                                                      </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  55 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  56  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  57  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  58 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span  style="">  59                                                                                                          </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  60     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  61                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  62     private RedisClient redisClient;                                                                     </span>
<span  style="">  63                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  64     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  65                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  66     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  67                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  68     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  69                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  70     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  71                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  72     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  73                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  74     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  75                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  76     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  76     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  77         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  78         redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  79     }                                                                                                    </span>
<span  style="">  80                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  81     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  82     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  83         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  84         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  85         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  86     }                                                                                                    </span>
<span  style="">  87                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  88     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  89         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  90         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  91         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  92             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  93         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  94             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  95         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  96         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  97         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  98             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style=""> 100         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style=""> 101             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 102                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 103                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 104                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 105                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 106                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 107                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 108             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 109                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 110                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 111                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 111                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 112                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 113                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 114                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 115                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 116             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 117                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 118                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 119                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 120                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 121                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 122             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 123                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 125     }                                                                                                    </span>
<span  style=""> 126                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 127     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 128     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 129         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 130     }                                                                                                    </span>
<span  style=""> 131                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 132     @Override                                                                                            </span>
<span class="3547897215975148581" onmouseenter="enter('3547897215975148581');" onmouseout="out('3547897215975148581');" style=""><abbr title=" 133     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 133     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resulðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 134         String key = buildCacheKey(inputParams);                                                         </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 135         if(StringUtils.isBlank(key)){                                                                    </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 136             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 137         }                                                                                                </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 138         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);         </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 139         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 140             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 141             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 142                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 143                     try {                                                                                </span>
<span class="7598536375028459133" onmouseenter="enter('7598536375028459133');" onmouseout="out('7598536375028459133');" style=""> 144 &lt;&lt;&lt;&lt;&lt;&lt;&lt; MINE                                                                                             </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 145                         Row row = fillData(input.row(), values);                                         </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 146                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));    </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 167, 0, 0.24); margin: 0"> 147                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="7991106586064342212" onmouseenter="enter('7991106586064342212');" onmouseout="out('7991106586064342212');" style=""> 148 ||||||| BASE                                                                                             </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 149                         Row row = fillData(input.row(), values);                                         </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 150                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(0, 0, 0, 0.15); margin: 0"> 151                         resultFuture.complete(Collections.singleton(new CRow(row, input.change())));     </span>
<span class="3796057323931724632" onmouseenter="enter('3796057323931724632');" onmouseout="out('3796057323931724632');" style=""> 152 =======                                                                                                  </span>
<span class="1084775360844291959" onmouseenter="enter('1084775360844291959');" onmouseout="out('1084775360844291959');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 153                         Row row = fillData(input, values);                                               </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 154                         dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));  </span>
<span class="-964628810921806489" onmouseenter="enter('-964628810921806489');" onmouseout="out('-964628810921806489');" style="background-color: rgba(0, 0, 255, 0.24); margin: 0"> 155                         RowDataComplete.completeRow(resultFuture, row);                                  </span>
<span class="-5027112130205478640" onmouseenter="enter('-5027112130205478640');" onmouseout="out('-5027112130205478640');" style=""> 156 &gt;&gt;&gt;&gt;&gt;&gt;&gt; YOURS                                                                                            </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 157                     } catch (Exception e) {                                                              </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 158                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 159                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 160                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 161                     dealMissKey(input, resultFuture);                                                    </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 162                     dealCacheData(key,CacheMissVal.getMissKeyObj());                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 164             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 165         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 166     }                                                                                                    </span>
<span  style=""> 167                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 168     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 169     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style=""> 170         StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                 </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style=""> 171         List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                  </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style=""> 172         for(String primaryKey : primaryKeys){                                                            </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style=""> 173             if(!refData.containsKey(primaryKey)){                                                        </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 174                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 175             }                                                                                            </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style=""> 176             keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177         }                                                                                                </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style=""> 178         return keyBuilder.toString();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179     }                                                                                                    </span>
<span  style=""> 180                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 181     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 182     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 183         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 184         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 185             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 187         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 188             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 190         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 191             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 193         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 194             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 196     }                                                                                                    </span>
<span  style=""> 197                                                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 198 }                                                                                                        </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1 /*                                                                                                       </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2  * Licensed to the Apache Software Foundation (ASF) under one                                            </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3  * or more contributor license agreements.  See the NOTICE file                                          </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4  * distributed with this work for additional information                                                 </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5  * regarding copyright ownership.  The ASF licenses this file                                            </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6  * to you under the Apache License, Version 2.0 (the                                                     </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7  * &quot;License&quot;); you may not use this file except in compliance                                            </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8  * with the License.  You may obtain a copy of the License at                                            </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9  *                                                                                                       </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10  *     http://www.apache.org/licenses/LICENSE-2.0                                                        </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11  *                                                                                                       </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12  * Unless required by applicable law or agreed to in writing, software                                   </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                     </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                              </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15  * See the License for the specific language governing permissions and                                   </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16  * limitations under the License.                                                                        </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17  */                                                                                                      </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  18 package com.dtstack.flink.sql.side.redis;                                                                </span>
<span  style="">  19                                                                                                          </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  20 import com.dtstack.flink.sql.enums.ECacheContentType;                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21 import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                 </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22 import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                       </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  23 import com.dtstack.flink.sql.side.CacheMissVal;                                                          </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  24 import com.dtstack.flink.sql.side.FieldInfo;                                                             </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  25 import com.dtstack.flink.sql.side.JoinInfo;                                                              </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  26 import com.dtstack.flink.sql.side.cache.CacheObj;                                                        </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  27 import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                 </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  28 import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                           </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  29 import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                        </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="">  30 import com.dtstack.flink.sql.util.RowDataComplete;                                                       </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="">  31 import com.google.common.collect.Lists;                                                                  </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  32 import com.google.common.collect.Maps;                                                                   </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  33 import io.lettuce.core.RedisClient;                                                                      </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  34 import io.lettuce.core.RedisFuture;                                                                      </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  35 import io.lettuce.core.api.StatefulRedisConnection;                                                      </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  36 import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                 </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  37 import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                  </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  38 import io.lettuce.core.cluster.RedisClusterClient;                                                       </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  39 import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                       </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  40 import java.util.Collections;                                                                            </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  41 import java.util.List;                                                                                   </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  42 import java.util.Map;                                                                                    </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  43 import java.util.function.Consumer;                                                                      </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  44 import org.apache.commons.collections.MapUtils;                                                          </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  45 import org.apache.commons.lang.StringUtils;                                                              </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="">  46 import org.apache.flink.api.java.tuple.Tuple2;                                                           </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  47 import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                  </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  48 import org.apache.flink.configuration.Configuration;                                                     </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  49 import org.apache.flink.streaming.api.functions.async.ResultFuture;                                      </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="">  50 import org.apache.flink.table.dataformat.BaseRow;                                                        </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  51 import org.apache.flink.types.Row;                                                                       </span>
<span  style="">  52                                                                                                          </span>
<span  style="">  53                                                                                                          </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  54 /**                                                                                                      </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  55  * @author yanxi                                                                                         </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  56  */                                                                                                      </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  57 public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                  </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  58     private static final long serialVersionUID = -2079908694523987738L;                                  </span>
<span  style="">  59                                                                                                          </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  60     private RedisClient redisClient;                                                                     </span>
<span  style="">  61                                                                                                          </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  62     private StatefulRedisConnection&lt;String, String&gt; connection;                                          </span>
<span  style="">  63                                                                                                          </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  64     private RedisClusterClient clusterClient;                                                            </span>
<span  style="">  65                                                                                                          </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  66     private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                            </span>
<span  style="">  67                                                                                                          </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  68     private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                 </span>
<span  style="">  69                                                                                                          </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  70     private RedisSideTableInfo redisSideTableInfo;                                                       </span>
<span  style="">  71                                                                                                          </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  72     private RedisSideReqRow redisSideReqRow;                                                             </span>
<span  style="">  73                                                                                                          </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  74     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  74     public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList,ðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  75         super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));           </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  76         redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                           </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  77     }                                                                                                    </span>
<span  style="">  78                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  79     @Override                                                                                            </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  80     public void open(Configuration parameters) throws Exception {                                        </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  81         super.open(parameters);                                                                          </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  82         redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                           </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  83         buildRedisClient(redisSideTableInfo);                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  84     }                                                                                                    </span>
<span  style="">  85                                                                                                          </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  86     private void buildRedisClient(RedisSideTableInfo tableInfo){                                         </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  87         String url = redisSideTableInfo.getUrl();                                                        </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  88         String password = redisSideTableInfo.getPassword();                                              </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  89         if (password != null){                                                                           </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  90             password = password + &quot;@&quot;;                                                                   </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  91         } else {                                                                                         </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  92             password = &quot;&quot;;                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  93         }                                                                                                </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  94         String database = redisSideTableInfo.getDatabase();                                              </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  95         if (database == null){                                                                           </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  96             database = &quot;0&quot;;                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  97         }                                                                                                </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  98         switch (RedisType.parse(tableInfo.getRedisType())){                                              </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style="">  99             case STANDALONE:                                                                             </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 100                 StringBuilder redisUri = new StringBuilder();                                            </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 101                 redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);   </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 102                 redisClient = RedisClient.create(redisUri.toString());                                   </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 103                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 104                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 105                 break;                                                                                   </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 106             case SENTINEL:                                                                               </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 107                 StringBuilder sentinelUri = new StringBuilder();                                         </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 108                 sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                 </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 109                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 109                         .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.gðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 110                 redisClient = RedisClient.create(sentinelUri.toString());                                </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 111                 connection = redisClient.connect();                                                      </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 112                 async = connection.async();                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 113                 break;                                                                                   </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 114             case CLUSTER:                                                                                </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 115                 StringBuilder clusterUri = new StringBuilder();                                          </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 116                 clusterUri.append(&quot;redis://&quot;).append(password).append(url);                              </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 117                 clusterClient = RedisClusterClient.create(clusterUri.toString());                        </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 118                 clusterConnection = clusterClient.connect();                                             </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 119                 async = clusterConnection.async();                                                       </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 120             default:                                                                                     </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 121                 break;                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 122         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123     }                                                                                                    </span>
<span  style=""> 124                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 125     @Override                                                                                            </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 126     public Row fillData(Row input, Object sideInput) {                                                   </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 127         return redisSideReqRow.fillData(input, sideInput);                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128     }                                                                                                    </span>
<span  style=""> 129                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 130     @Override                                                                                            </span>
<span class="3547897215975148581" onmouseenter="enter('3547897215975148581');" onmouseout="out('3547897215975148581');" style=""><abbr title=" 131     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 131     public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resulðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 132         String key = buildCacheKey(inputParams);                                                         </span>
<span class="391086597940522415" onmouseenter="enter('391086597940522415');" onmouseout="out('391086597940522415');" style=""> 133         if (StringUtils.isBlank(key)) {                                                                  </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 134             return;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 135         }                                                                                                </span>
<span class="1977156455400636871" onmouseenter="enter('1977156455400636871');" onmouseout="out('1977156455400636871');" style=""> 136         RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) (async)).hgetall(key);       </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 137         future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 138             @Override                                                                                    </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 139             public void accept(Map&lt;String, String&gt; values) {                                             </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 140                 if (MapUtils.isNotEmpty(values)) {                                                       </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 141                     try {                                                                                </span>
<span class="1084775360844291959" onmouseenter="enter('1084775360844291959');" onmouseout="out('1084775360844291959');" style=""> 142                         Row row = fillData(input, values);                                               </span>
<span class="8909590001630271596" onmouseenter="enter('8909590001630271596');" onmouseout="out('8909590001630271596');" style=""> 143                         dealCacheData(key, CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));   </span>
<span class="-964628810921806489" onmouseenter="enter('-964628810921806489');" onmouseout="out('-964628810921806489');" style=""> 144                         RowDataComplete.completeRow(resultFuture, row);                                  </span>
<span class="-3589222456918676513" onmouseenter="enter('-3589222456918676513');" onmouseout="out('-3589222456918676513');" style=""> 145                     } catch (java.lang.Exception e) {                                                    </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 146                         dealFillDataError(input, resultFuture, e);                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 147                     }                                                                                    </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 148                 } else {                                                                                 </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 149                     dealMissKey(input, resultFuture);                                                    </span>
<span class="-6738088827010899194" onmouseenter="enter('-6738088827010899194');" onmouseout="out('-6738088827010899194');" style=""> 150                     dealCacheData(key, CacheMissVal.getMissKeyObj());                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 151                 }                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 152             }                                                                                            </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 153         });                                                                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154     }                                                                                                    </span>
<span  style=""> 155                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 156     @Override                                                                                            </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 157     public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                           </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style=""> 158         StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                 </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style=""> 159         List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                  </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style=""> 160         for(String primaryKey : primaryKeys){                                                            </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style=""> 161             if(!refData.containsKey(primaryKey)){                                                        </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 162                 return null;                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163             }                                                                                            </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style=""> 164             keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165         }                                                                                                </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style=""> 166         return keyBuilder.toString();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167     }                                                                                                    </span>
<span  style=""> 168                                                                                                          </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 169     @Override                                                                                            </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 170     public void close() throws Exception {                                                               </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 171         super.close();                                                                                   </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 172         if (connection != null){                                                                         </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 173             connection.close();                                                                          </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174         }                                                                                                </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 175         if (redisClient != null){                                                                        </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 176             redisClient.shutdown();                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 177         }                                                                                                </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 178         if (clusterConnection != null){                                                                  </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 179             clusterConnection.close();                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 180         }                                                                                                </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 181         if (clusterClient != null){                                                                      </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 182             clusterClient.shutdown();                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183         }                                                                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 184     }                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185 }                                                                                                        </span>












</pre></td>
                        </tr>
                    </table>
                </div>
                <div id="bottom">
                    <table style="margin:auto">
                        <tr>
                            <th>ours vs. base</th>
                            <th>theirs vs. base</th>
                        </tr>
                        <tr>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="-6421880674066127163" onmouseenter="enter('-6421880674066127163');" onmouseout="out('-6421880674066127163');" style="">  23  import io.lettuce.core.KeyValue;                                                                                  </span>
<span class="1428807642900314143" onmouseenter="enter('1428807642900314143');" onmouseout="out('1428807642900314143');" style="">  24  import io.lettuce.core.api.async.RedisStringAsyncCommands;                                                        </span>




<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  25  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  26  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  27  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="">  28  import org.apache.flink.table.runtime.types.CRow;                                                                 </span>

<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  29  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  30                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  31  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  32  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  33  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  34  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  35  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  36  import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                          </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  37  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  38  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  39  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  40  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  41  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  42  import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                          </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  43  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  44  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  45  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  46  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  47  import org.apache.commons.lang.StringUtils;                                                                       </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="">  48  import com.google.common.collect.Maps;                                                                            </span>
<span  style="">  49                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  50  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  51  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  52  import java.util.Map;                                                                                             </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  53  import java.util.function.Consumer;                                                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  54  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  55   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  56   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  57  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  58                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  59      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  60                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  61      private RedisClient redisClient;                                                                              </span>
<span  style="">  62                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  63      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  64                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  65      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  66                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  67      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  68                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  69      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  70                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  71      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  72                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  73      private RedisSideReqRow redisSideReqRow;                                                                      </span>
<span  style="">  74                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  75      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  75      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  76          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  77          redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  78      }                                                                                                             </span>
<span  style="">  79                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  80      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  81      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  82          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  83          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  84          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  85      }                                                                                                             </span>
<span  style="">  86                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  87      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  88          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  89          String password = redisSideTableInfo.getPassword();                                                       </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  90          if (password != null){                                                                                    </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  91              password = password + &quot;@&quot;;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  92          } else {                                                                                                  </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  93              password = &quot;&quot;;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  94          }                                                                                                         </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style="">  95          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style="">  96          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style="">  97              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  98          }                                                                                                         </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style="">  99          switch (RedisType.parse(tableInfo.getRedisType())){                                                       </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style=""> 100              case STANDALONE:                                                                                      </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 101                  StringBuilder redisUri = new StringBuilder();                                                     </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 102                  redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);            </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 103                  redisClient = RedisClient.create(redisUri.toString());                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 104                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 105                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 106                  break;                                                                                            </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 107              case SENTINEL:                                                                                        </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 108                  StringBuilder sentinelUri = new StringBuilder();                                                  </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 109                  sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                          </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 110                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 110                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterNðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 111                  redisClient = RedisClient.create(sentinelUri.toString());                                         </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 112                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 113                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 114                  break;                                                                                            </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 115              case CLUSTER:                                                                                         </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 116                  StringBuilder clusterUri = new StringBuilder();                                                   </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 117                  clusterUri.append(&quot;redis://&quot;).append(password).append(url);                                       </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 118                  clusterClient = RedisClusterClient.create(clusterUri.toString());                                 </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 119                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 120                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 121              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 122                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 123          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 124      }                                                                                                             </span>
<span  style=""> 125                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 126      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 127      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 128          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129      }                                                                                                             </span>
<span  style=""> 130                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 131      @Override                                                                                                     </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style=""><abbr title=" 132      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 132      public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) thðŸ”µ</abbr></span>

<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 133          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 134          if(StringUtils.isBlank(key)){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 135              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 136          }                                                                                                         </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 137          RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);                  </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 138          future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 139              @Override                                                                                             </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 140              public void accept(Map&lt;String, String&gt; values) {                                                      </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 141                  if (MapUtils.isNotEmpty(values)) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 142                      try {                                                                                         </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style=""> 143                          Row row = fillData(input.row(), values);                                                  </span>

<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 144 -                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));           </span>
<span class="6767512686112859775" onmouseenter="enter('6767512686112859775');" onmouseout="out('6767512686112859775');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 145 +                        dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.SingleLine, row));             </span>
<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style=""> 146                          resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>

<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 147                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 148                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 149                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 150                  } else {                                                                                          </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 151                      dealMissKey(input, resultFuture);                                                             </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 152                      dealCacheData(key,CacheMissVal.getMissKeyObj());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 153                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 154              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 155          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156      }                                                                                                             </span>
<span  style=""> 157                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 158      @Override                                                                                                     </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 159      public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                                    </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style=""> 160          StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                          </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style=""> 161          List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                           </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style=""> 162          for(String primaryKey : primaryKeys){                                                                     </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style=""> 163              if(!refData.containsKey(primaryKey)){                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 164                  return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 165              }                                                                                                     </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style=""> 166              keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 167          }                                                                                                         </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style=""> 168          return keyBuilder.toString();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 169      }                                                                                                             </span>
<span  style=""> 170                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 171      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 172      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 173          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 174          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 175              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 177          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 178              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 179          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 180          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 181              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 182          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 183          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 184              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 185          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186      }                                                                                                             </span>
<span  style=""> 187                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 188  }                                                                                                                 </span></pre></td>
                            <td><pre><span class="4534359625031764666" onmouseenter="enter('4534359625031764666');" onmouseout="out('4534359625031764666');" style="">   1  /*                                                                                                                </span>
<span class="3101153502889412828" onmouseenter="enter('3101153502889412828');" onmouseout="out('3101153502889412828');" style="">   2   * Licensed to the Apache Software Foundation (ASF) under one                                                     </span>
<span class="-6690800139350779170" onmouseenter="enter('-6690800139350779170');" onmouseout="out('-6690800139350779170');" style="">   3   * or more contributor license agreements.  See the NOTICE file                                                   </span>
<span class="4408648408749222780" onmouseenter="enter('4408648408749222780');" onmouseout="out('4408648408749222780');" style="">   4   * distributed with this work for additional information                                                          </span>
<span class="7440871955664702931" onmouseenter="enter('7440871955664702931');" onmouseout="out('7440871955664702931');" style="">   5   * regarding copyright ownership.  The ASF licenses this file                                                     </span>
<span class="-7748987699953482767" onmouseenter="enter('-7748987699953482767');" onmouseout="out('-7748987699953482767');" style="">   6   * to you under the Apache License, Version 2.0 (the                                                              </span>
<span class="-7532787339260984706" onmouseenter="enter('-7532787339260984706');" onmouseout="out('-7532787339260984706');" style="">   7   * &quot;License&quot;); you may not use this file except in compliance                                                     </span>
<span class="6072654417402056570" onmouseenter="enter('6072654417402056570');" onmouseout="out('6072654417402056570');" style="">   8   * with the License.  You may obtain a copy of the License at                                                     </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">   9   *                                                                                                                </span>
<span class="-6984878691993713389" onmouseenter="enter('-6984878691993713389');" onmouseout="out('-6984878691993713389');" style="">  10   *     http://www.apache.org/licenses/LICENSE-2.0                                                                 </span>
<span class="329605257831645060" onmouseenter="enter('329605257831645060');" onmouseout="out('329605257831645060');" style="">  11   *                                                                                                                </span>
<span class="2557607632756179983" onmouseenter="enter('2557607632756179983');" onmouseout="out('2557607632756179983');" style="">  12   * Unless required by applicable law or agreed to in writing, software                                            </span>
<span class="-9189129105512731955" onmouseenter="enter('-9189129105512731955');" onmouseout="out('-9189129105512731955');" style="">  13   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,                                              </span>
<span class="5781161717946418340" onmouseenter="enter('5781161717946418340');" onmouseout="out('5781161717946418340');" style="">  14   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                       </span>
<span class="1761562277992059393" onmouseenter="enter('1761562277992059393');" onmouseout="out('1761562277992059393');" style="">  15   * See the License for the specific language governing permissions and                                            </span>
<span class="7217408601297779962" onmouseenter="enter('7217408601297779962');" onmouseout="out('7217408601297779962');" style="">  16   * limitations under the License.                                                                                 </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  17   */                                                                                                               </span>
<span  style="">  18                                                                                                                    </span>
<span class="-4439577476304794754" onmouseenter="enter('-4439577476304794754');" onmouseout="out('-4439577476304794754');" style="">  19  package com.dtstack.flink.sql.side.redis;                                                                         </span>
<span  style="">  20                                                                                                                    </span>
<span class="-5430766829085710530" onmouseenter="enter('-5430766829085710530');" onmouseout="out('-5430766829085710530');" style="">  21  import com.dtstack.flink.sql.side.AbstractSideTableInfo;                                                          </span>
<span class="-1010634606182625441" onmouseenter="enter('-1010634606182625441');" onmouseout="out('-1010634606182625441');" style="">  22  import com.dtstack.flink.sql.side.BaseAsyncReqRow;                                                                </span>
<span class="-6421880674066127163" onmouseenter="enter('-6421880674066127163');" onmouseout="out('-6421880674066127163');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  23 -import io.lettuce.core.KeyValue;                                                                                  </span>
<span class="1428807642900314143" onmouseenter="enter('1428807642900314143');" onmouseout="out('1428807642900314143');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  24 -import io.lettuce.core.api.async.RedisStringAsyncCommands;                                                        </span>
<span class="-3551762499494176757" onmouseenter="enter('-3551762499494176757');" onmouseout="out('-3551762499494176757');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  25 +import com.dtstack.flink.sql.util.RowDataComplete;                                                                </span>
<span class="5160316076043229327" onmouseenter="enter('5160316076043229327');" onmouseout="out('5160316076043229327');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  26 +import com.google.common.collect.Lists;                                                                           </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  27 +import com.google.common.collect.Maps;                                                                            </span>
<span class="3718762954377501633" onmouseenter="enter('3718762954377501633');" onmouseout="out('3718762954377501633');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  28 +import org.apache.flink.api.java.tuple.Tuple2;                                                                    </span>
<span class="7106985530640289051" onmouseenter="enter('7106985530640289051');" onmouseout="out('7106985530640289051');" style="">  29  import org.apache.flink.api.java.typeutils.RowTypeInfo;                                                           </span>
<span class="87671769792320379" onmouseenter="enter('87671769792320379');" onmouseout="out('87671769792320379');" style="">  30  import org.apache.flink.configuration.Configuration;                                                              </span>
<span class="-2094289371926699111" onmouseenter="enter('-2094289371926699111');" onmouseout="out('-2094289371926699111');" style="">  31  import org.apache.flink.streaming.api.functions.async.ResultFuture;                                               </span>
<span class="3883198981410010526" onmouseenter="enter('3883198981410010526');" onmouseout="out('3883198981410010526');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  32 -import org.apache.flink.table.runtime.types.CRow;                                                                 </span>
<span class="-8515482078367964881" onmouseenter="enter('-8515482078367964881');" onmouseout="out('-8515482078367964881');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0">  33 +import org.apache.flink.table.dataformat.BaseRow;                                                                 </span>
<span class="2962496049409651976" onmouseenter="enter('2962496049409651976');" onmouseout="out('2962496049409651976');" style="">  34  import org.apache.flink.types.Row;                                                                                </span>
<span  style="">  35                                                                                                                    </span>
<span class="3774663631063558777" onmouseenter="enter('3774663631063558777');" onmouseout="out('3774663631063558777');" style="">  36  import com.dtstack.flink.sql.enums.ECacheContentType;                                                             </span>
<span class="3586780810941248070" onmouseenter="enter('3586780810941248070');" onmouseout="out('3586780810941248070');" style="">  37  import com.dtstack.flink.sql.side.CacheMissVal;                                                                   </span>
<span class="-5905762190260359492" onmouseenter="enter('-5905762190260359492');" onmouseout="out('-5905762190260359492');" style="">  38  import com.dtstack.flink.sql.side.FieldInfo;                                                                      </span>
<span class="4308167670354000439" onmouseenter="enter('4308167670354000439');" onmouseout="out('4308167670354000439');" style="">  39  import com.dtstack.flink.sql.side.JoinInfo;                                                                       </span>
<span class="423094574771867323" onmouseenter="enter('423094574771867323');" onmouseout="out('423094574771867323');" style="">  40  import com.dtstack.flink.sql.side.cache.CacheObj;                                                                 </span>
<span class="5186530073364004162" onmouseenter="enter('5186530073364004162');" onmouseout="out('5186530073364004162');" style="">  41  import com.dtstack.flink.sql.side.redis.enums.RedisType;                                                          </span>
<span class="2902033973055565861" onmouseenter="enter('2902033973055565861');" onmouseout="out('2902033973055565861');" style="">  42  import com.dtstack.flink.sql.side.redis.table.RedisSideReqRow;                                                    </span>
<span class="-2368462397074108087" onmouseenter="enter('-2368462397074108087');" onmouseout="out('-2368462397074108087');" style="">  43  import com.dtstack.flink.sql.side.redis.table.RedisSideTableInfo;                                                 </span>
<span class="9132698888379656288" onmouseenter="enter('9132698888379656288');" onmouseout="out('9132698888379656288');" style="">  44  import io.lettuce.core.RedisClient;                                                                               </span>
<span class="-1597402105474843468" onmouseenter="enter('-1597402105474843468');" onmouseout="out('-1597402105474843468');" style="">  45  import io.lettuce.core.RedisFuture;                                                                               </span>
<span class="3416473218750047572" onmouseenter="enter('3416473218750047572');" onmouseout="out('3416473218750047572');" style="">  46  import io.lettuce.core.api.StatefulRedisConnection;                                                               </span>
<span class="-2676668724129809786" onmouseenter="enter('-2676668724129809786');" onmouseout="out('-2676668724129809786');" style="">  47  import io.lettuce.core.api.async.RedisHashAsyncCommands;                                                          </span>
<span class="-3779126557888296518" onmouseenter="enter('-3779126557888296518');" onmouseout="out('-3779126557888296518');" style="">  48  import io.lettuce.core.api.async.RedisKeyAsyncCommands;                                                           </span>
<span class="-703105976340791333" onmouseenter="enter('-703105976340791333');" onmouseout="out('-703105976340791333');" style="">  49  import io.lettuce.core.cluster.RedisClusterClient;                                                                </span>
<span class="-6770126057088232361" onmouseenter="enter('-6770126057088232361');" onmouseout="out('-6770126057088232361');" style="">  50  import io.lettuce.core.cluster.api.StatefulRedisClusterConnection;                                                </span>
<span class="4020017653195254006" onmouseenter="enter('4020017653195254006');" onmouseout="out('4020017653195254006');" style="">  51  import org.apache.commons.collections.MapUtils;                                                                   </span>
<span class="7952073036463698968" onmouseenter="enter('7952073036463698968');" onmouseout="out('7952073036463698968');" style="">  52  import org.apache.commons.lang.StringUtils;                                                                       </span>
<span class="-4819102165053109383" onmouseenter="enter('-4819102165053109383');" onmouseout="out('-4819102165053109383');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0">  53 -import com.google.common.collect.Maps;                                                                            </span>
<span  style="">  54                                                                                                                    </span>
<span class="2187055016371707860" onmouseenter="enter('2187055016371707860');" onmouseout="out('2187055016371707860');" style="">  55  import java.util.Collections;                                                                                     </span>
<span class="-1786020958497218848" onmouseenter="enter('-1786020958497218848');" onmouseout="out('-1786020958497218848');" style="">  56  import java.util.List;                                                                                            </span>
<span class="6618655971923850695" onmouseenter="enter('6618655971923850695');" onmouseout="out('6618655971923850695');" style="">  57  import java.util.Map;                                                                                             </span>
<span class="-3879144094618106152" onmouseenter="enter('-3879144094618106152');" onmouseout="out('-3879144094618106152');" style="">  58  import java.util.function.Consumer;                                                                               </span>
<span class="1188357178855945174" onmouseenter="enter('1188357178855945174');" onmouseout="out('1188357178855945174');" style="">  59  /**                                                                                                               </span>
<span class="7767094491324231202" onmouseenter="enter('7767094491324231202');" onmouseout="out('7767094491324231202');" style="">  60   * @author yanxi                                                                                                  </span>
<span class="-3478703399357275674" onmouseenter="enter('-3478703399357275674');" onmouseout="out('-3478703399357275674');" style="">  61   */                                                                                                               </span>
<span class="-1879194138318014970" onmouseenter="enter('-1879194138318014970');" onmouseout="out('-1879194138318014970');" style="">  62  public class RedisAsyncReqRow extends BaseAsyncReqRow {                                                           </span>
<span  style="">  63                                                                                                                    </span>
<span class="-6174293531775965555" onmouseenter="enter('-6174293531775965555');" onmouseout="out('-6174293531775965555');" style="">  64      private static final long serialVersionUID = -2079908694523987738L;                                           </span>
<span  style="">  65                                                                                                                    </span>
<span class="6724353622045073816" onmouseenter="enter('6724353622045073816');" onmouseout="out('6724353622045073816');" style="">  66      private RedisClient redisClient;                                                                              </span>
<span  style="">  67                                                                                                                    </span>
<span class="9108888970052297399" onmouseenter="enter('9108888970052297399');" onmouseout="out('9108888970052297399');" style="">  68      private StatefulRedisConnection&lt;String, String&gt; connection;                                                   </span>
<span  style="">  69                                                                                                                    </span>
<span class="3316328836058051701" onmouseenter="enter('3316328836058051701');" onmouseout="out('3316328836058051701');" style="">  70      private RedisClusterClient clusterClient;                                                                     </span>
<span  style="">  71                                                                                                                    </span>
<span class="-7326189181481311492" onmouseenter="enter('-7326189181481311492');" onmouseout="out('-7326189181481311492');" style="">  72      private StatefulRedisClusterConnection&lt;String, String&gt; clusterConnection;                                     </span>
<span  style="">  73                                                                                                                    </span>
<span class="-2566927921346534821" onmouseenter="enter('-2566927921346534821');" onmouseout="out('-2566927921346534821');" style="">  74      private RedisKeyAsyncCommands&lt;String, String&gt; async;                                                          </span>
<span  style="">  75                                                                                                                    </span>
<span class="7663475568254970307" onmouseenter="enter('7663475568254970307');" onmouseout="out('7663475568254970307');" style="">  76      private RedisSideTableInfo redisSideTableInfo;                                                                </span>
<span  style="">  77                                                                                                                    </span>
<span class="-5064353294760337833" onmouseenter="enter('-5064353294760337833');" onmouseout="out('-5064353294760337833');" style="">  78      private RedisSideReqRow redisSideReqRow;                                                                      </span>
<span  style="">  79                                                                                                                    </span>
<span class="-1007808174315881265" onmouseenter="enter('-1007808174315881265');" onmouseout="out('-1007808174315881265');" style=""><abbr title="  80      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractSideTableInfo sideTableInfo) {">  80      public RedisAsyncReqRow(RowTypeInfo rowTypeInfo, JoinInfo joinInfo, List&lt;FieldInfo&gt; outFieldInfoList, AbstractðŸ”µ</abbr></span>
<span class="1343943209385485740" onmouseenter="enter('1343943209385485740');" onmouseout="out('1343943209385485740');" style="">  81          super(new RedisAsyncSideInfo(rowTypeInfo, joinInfo, outFieldInfoList, sideTableInfo));                    </span>
<span class="-3353459283373836850" onmouseenter="enter('-3353459283373836850');" onmouseout="out('-3353459283373836850');" style="">  82          redisSideReqRow = new RedisSideReqRow(super.sideInfo);                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  83      }                                                                                                             </span>
<span  style="">  84                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style="">  85      @Override                                                                                                     </span>
<span class="-8008343056571207451" onmouseenter="enter('-8008343056571207451');" onmouseout="out('-8008343056571207451');" style="">  86      public void open(Configuration parameters) throws Exception {                                                 </span>
<span class="8736254984801772910" onmouseenter="enter('8736254984801772910');" onmouseout="out('8736254984801772910');" style="">  87          super.open(parameters);                                                                                   </span>
<span class="-1580557190956330035" onmouseenter="enter('-1580557190956330035');" onmouseout="out('-1580557190956330035');" style="">  88          redisSideTableInfo = (RedisSideTableInfo) sideInfo.getSideTableInfo();                                    </span>
<span class="-1107946156210666160" onmouseenter="enter('-1107946156210666160');" onmouseout="out('-1107946156210666160');" style="">  89          buildRedisClient(redisSideTableInfo);                                                                     </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  90      }                                                                                                             </span>
<span  style="">  91                                                                                                                    </span>
<span class="-129242902103333165" onmouseenter="enter('-129242902103333165');" onmouseout="out('-129242902103333165');" style="">  92      private void buildRedisClient(RedisSideTableInfo tableInfo){                                                  </span>
<span class="-8614673081590141735" onmouseenter="enter('-8614673081590141735');" onmouseout="out('-8614673081590141735');" style="">  93          String url = redisSideTableInfo.getUrl();                                                                 </span>
<span class="7351357371271122258" onmouseenter="enter('7351357371271122258');" onmouseout="out('7351357371271122258');" style="">  94          String password = redisSideTableInfo.getPassword();                                                       </span>
<span class="-1659669534964701228" onmouseenter="enter('-1659669534964701228');" onmouseout="out('-1659669534964701228');" style="">  95          if (password != null){                                                                                    </span>
<span class="3595477182566481109" onmouseenter="enter('3595477182566481109');" onmouseout="out('3595477182566481109');" style="">  96              password = password + &quot;@&quot;;                                                                            </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style="">  97          } else {                                                                                                  </span>
<span class="4430734984267796663" onmouseenter="enter('4430734984267796663');" onmouseout="out('4430734984267796663');" style="">  98              password = &quot;&quot;;                                                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style="">  99          }                                                                                                         </span>
<span class="-5126207798310089453" onmouseenter="enter('-5126207798310089453');" onmouseout="out('-5126207798310089453');" style=""> 100          String database = redisSideTableInfo.getDatabase();                                                       </span>
<span class="8982372716233999411" onmouseenter="enter('8982372716233999411');" onmouseout="out('8982372716233999411');" style=""> 101          if (database == null){                                                                                    </span>
<span class="5040086720358838337" onmouseenter="enter('5040086720358838337');" onmouseout="out('5040086720358838337');" style=""> 102              database = &quot;0&quot;;                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 103          }                                                                                                         </span>
<span class="-4264616632982055939" onmouseenter="enter('-4264616632982055939');" onmouseout="out('-4264616632982055939');" style=""> 104          switch (RedisType.parse(tableInfo.getRedisType())){                                                       </span>
<span class="-2619809495447870500" onmouseenter="enter('-2619809495447870500');" onmouseout="out('-2619809495447870500');" style=""> 105              case STANDALONE:                                                                                      </span>
<span class="-4973702712857890094" onmouseenter="enter('-4973702712857890094');" onmouseout="out('-4973702712857890094');" style=""> 106                  StringBuilder redisUri = new StringBuilder();                                                     </span>
<span class="-3378402721570016976" onmouseenter="enter('-3378402721570016976');" onmouseout="out('-3378402721570016976');" style=""> 107                  redisUri.append(&quot;redis://&quot;).append(password).append(url).append(&quot;/&quot;).append(database);            </span>
<span class="-7645809081785686243" onmouseenter="enter('-7645809081785686243');" onmouseout="out('-7645809081785686243');" style=""> 108                  redisClient = RedisClient.create(redisUri.toString());                                            </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 109                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 110                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 111                  break;                                                                                            </span>
<span class="-895647124905309085" onmouseenter="enter('-895647124905309085');" onmouseout="out('-895647124905309085');" style=""> 112              case SENTINEL:                                                                                        </span>
<span class="-6363854113918253010" onmouseenter="enter('-6363854113918253010');" onmouseout="out('-6363854113918253010');" style=""> 113                  StringBuilder sentinelUri = new StringBuilder();                                                  </span>
<span class="-6358161233659173419" onmouseenter="enter('-6358161233659173419');" onmouseout="out('-6358161233659173419');" style=""> 114                  sentinelUri.append(&quot;redis-sentinel://&quot;).append(password)                                          </span>
<span class="-5394422612817042816" onmouseenter="enter('-5394422612817042816');" onmouseout="out('-5394422612817042816');" style=""><abbr title=" 115                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterName());"> 115                          .append(url).append(&quot;/&quot;).append(database).append(&quot;#&quot;).append(redisSideTableInfo.getMasterNðŸ”µ</abbr></span>
<span class="1639216295176439099" onmouseenter="enter('1639216295176439099');" onmouseout="out('1639216295176439099');" style=""> 116                  redisClient = RedisClient.create(sentinelUri.toString());                                         </span>
<span class="-1329721166023374965" onmouseenter="enter('-1329721166023374965');" onmouseout="out('-1329721166023374965');" style=""> 117                  connection = redisClient.connect();                                                               </span>
<span class="7516171120796588955" onmouseenter="enter('7516171120796588955');" onmouseout="out('7516171120796588955');" style=""> 118                  async = connection.async();                                                                       </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 119                  break;                                                                                            </span>
<span class="-1085813937698009242" onmouseenter="enter('-1085813937698009242');" onmouseout="out('-1085813937698009242');" style=""> 120              case CLUSTER:                                                                                         </span>
<span class="4629180190380999719" onmouseenter="enter('4629180190380999719');" onmouseout="out('4629180190380999719');" style=""> 121                  StringBuilder clusterUri = new StringBuilder();                                                   </span>
<span class="-3722948771151829632" onmouseenter="enter('-3722948771151829632');" onmouseout="out('-3722948771151829632');" style=""> 122                  clusterUri.append(&quot;redis://&quot;).append(password).append(url);                                       </span>
<span class="-9123604991589605467" onmouseenter="enter('-9123604991589605467');" onmouseout="out('-9123604991589605467');" style=""> 123                  clusterClient = RedisClusterClient.create(clusterUri.toString());                                 </span>
<span class="-7197492411989131201" onmouseenter="enter('-7197492411989131201');" onmouseout="out('-7197492411989131201');" style=""> 124                  clusterConnection = clusterClient.connect();                                                      </span>
<span class="-8787472482815426955" onmouseenter="enter('-8787472482815426955');" onmouseout="out('-8787472482815426955');" style=""> 125                  async = clusterConnection.async();                                                                </span>
<span class="-8178136317704390296" onmouseenter="enter('-8178136317704390296');" onmouseout="out('-8178136317704390296');" style=""> 126              default:                                                                                              </span>
<span class="-7917104194997868056" onmouseenter="enter('-7917104194997868056');" onmouseout="out('-7917104194997868056');" style=""> 127                  break;                                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 128          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 129      }                                                                                                             </span>
<span  style=""> 130                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 131      @Override                                                                                                     </span>
<span class="-1458639347103910534" onmouseenter="enter('-1458639347103910534');" onmouseout="out('-1458639347103910534');" style=""> 132      public Row fillData(Row input, Object sideInput) {                                                            </span>
<span class="619528746358924484" onmouseenter="enter('619528746358924484');" onmouseout="out('619528746358924484');" style=""> 133          return redisSideReqRow.fillData(input, sideInput);                                                        </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 134      }                                                                                                             </span>
<span  style=""> 135                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 136      @Override                                                                                                     </span>
<span class="-3645419592203298662" onmouseenter="enter('-3645419592203298662');" onmouseout="out('-3645419592203298662');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"><abbr title=" 137 -    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) throws Exception {"> 137 -    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, CRow input, ResultFuture&lt;CRow&gt; resultFuture) thðŸ”µ</abbr></span>
<span class="3547897215975148581" onmouseenter="enter('3547897215975148581');" onmouseout="out('3547897215975148581');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"><abbr title=" 138 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resultFuture) throws Exception {"> 138 +    public void handleAsyncInvoke(Map&lt;String, Object&gt; inputParams, Row input, ResultFuture&lt;BaseRow&gt; resultFuture) ðŸ”µ</abbr></span>
<span class="-1687696912388971385" onmouseenter="enter('-1687696912388971385');" onmouseout="out('-1687696912388971385');" style=""> 139          String key = buildCacheKey(inputParams);                                                                  </span>
<span class="-9159092848324995477" onmouseenter="enter('-9159092848324995477');" onmouseout="out('-9159092848324995477');" style=""> 140          if(StringUtils.isBlank(key)){                                                                             </span>
<span class="4043029072030362567" onmouseenter="enter('4043029072030362567');" onmouseout="out('4043029072030362567');" style=""> 141              return;                                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 142          }                                                                                                         </span>
<span class="-5314464920408179297" onmouseenter="enter('-5314464920408179297');" onmouseout="out('-5314464920408179297');" style=""> 143          RedisFuture&lt;Map&lt;String, String&gt;&gt; future = ((RedisHashAsyncCommands) async).hgetall(key);                  </span>
<span class="3219082842500939183" onmouseenter="enter('3219082842500939183');" onmouseout="out('3219082842500939183');" style=""> 144          future.thenAccept(new Consumer&lt;Map&lt;String, String&gt;&gt;() {                                                   </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 145              @Override                                                                                             </span>
<span class="1644547983007259517" onmouseenter="enter('1644547983007259517');" onmouseout="out('1644547983007259517');" style=""> 146              public void accept(Map&lt;String, String&gt; values) {                                                      </span>
<span class="872733541934059902" onmouseenter="enter('872733541934059902');" onmouseout="out('872733541934059902');" style=""> 147                  if (MapUtils.isNotEmpty(values)) {                                                                </span>
<span class="-2989978199866728989" onmouseenter="enter('-2989978199866728989');" onmouseout="out('-2989978199866728989');" style=""> 148                      try {                                                                                         </span>
<span class="-6766619259748058296" onmouseenter="enter('-6766619259748058296');" onmouseout="out('-6766619259748058296');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 149 -                        Row row = fillData(input.row(), values);                                                  </span>
<span class="1084775360844291959" onmouseenter="enter('1084775360844291959');" onmouseout="out('1084775360844291959');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 150 +                        Row row = fillData(input, values);                                                        </span>
<span class="8958675433317164238" onmouseenter="enter('8958675433317164238');" onmouseout="out('8958675433317164238');" style=""> 151                          dealCacheData(key,CacheObj.buildCacheObj(ECacheContentType.MultiLine, values));           </span>

<span class="-2977231710548321637" onmouseenter="enter('-2977231710548321637');" onmouseout="out('-2977231710548321637');" style="background-color: rgba(255, 0, 0, 0.2); margin: 0"> 152 -                        resultFuture.complete(Collections.singleton(new CRow(row, input.change())));              </span>
<span class="-964628810921806489" onmouseenter="enter('-964628810921806489');" onmouseout="out('-964628810921806489');" style="background-color: rgba(0, 255, 0, 0.2); margin: 0"> 153 +                        RowDataComplete.completeRow(resultFuture, row);                                           </span>
<span class="2627011698774241688" onmouseenter="enter('2627011698774241688');" onmouseout="out('2627011698774241688');" style=""> 154                      } catch (Exception e) {                                                                       </span>
<span class="-4063016474650225082" onmouseenter="enter('-4063016474650225082');" onmouseout="out('-4063016474650225082');" style=""> 155                          dealFillDataError(input, resultFuture, e);                                                </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 156                      }                                                                                             </span>
<span class="-6023928394739582014" onmouseenter="enter('-6023928394739582014');" onmouseout="out('-6023928394739582014');" style=""> 157                  } else {                                                                                          </span>
<span class="-5083140435457393877" onmouseenter="enter('-5083140435457393877');" onmouseout="out('-5083140435457393877');" style=""> 158                      dealMissKey(input, resultFuture);                                                             </span>
<span class="6200594255102072394" onmouseenter="enter('6200594255102072394');" onmouseout="out('6200594255102072394');" style=""> 159                      dealCacheData(key,CacheMissVal.getMissKeyObj());                                              </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 160                  }                                                                                                 </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 161              }                                                                                                     </span>
<span class="7938821646327104961" onmouseenter="enter('7938821646327104961');" onmouseout="out('7938821646327104961');" style=""> 162          });                                                                                                       </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 163      }                                                                                                             </span>
<span  style=""> 164                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 165      @Override                                                                                                     </span>
<span class="1246179427107127385" onmouseenter="enter('1246179427107127385');" onmouseout="out('1246179427107127385');" style=""> 166      public String buildCacheKey(Map&lt;String, Object&gt; refData) {                                                    </span>
<span class="6731562659640656222" onmouseenter="enter('6731562659640656222');" onmouseout="out('6731562659640656222');" style=""> 167          StringBuilder keyBuilder = new StringBuilder(redisSideTableInfo.getTableName());                          </span>
<span class="-5192758445352326858" onmouseenter="enter('-5192758445352326858');" onmouseout="out('-5192758445352326858');" style=""> 168          List&lt;String&gt; primaryKeys = redisSideTableInfo.getPrimaryKeys();                                           </span>
<span class="4931443654640781075" onmouseenter="enter('4931443654640781075');" onmouseout="out('4931443654640781075');" style=""> 169          for(String primaryKey : primaryKeys){                                                                     </span>
<span class="-6032560392904428335" onmouseenter="enter('-6032560392904428335');" onmouseout="out('-6032560392904428335');" style=""> 170              if(!refData.containsKey(primaryKey)){                                                                 </span>
<span class="-3732568077477539923" onmouseenter="enter('-3732568077477539923');" onmouseout="out('-3732568077477539923');" style=""> 171                  return null;                                                                                      </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 172              }                                                                                                     </span>
<span class="-7423244661122802666" onmouseenter="enter('-7423244661122802666');" onmouseout="out('-7423244661122802666');" style=""> 173              keyBuilder.append(&quot;_&quot;).append(refData.get(primaryKey));                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 174          }                                                                                                         </span>
<span class="-8220663148925062421" onmouseenter="enter('-8220663148925062421');" onmouseout="out('-8220663148925062421');" style=""> 175          return keyBuilder.toString();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 176      }                                                                                                             </span>
<span  style=""> 177                                                                                                                    </span>
<span class="5563255192340639251" onmouseenter="enter('5563255192340639251');" onmouseout="out('5563255192340639251');" style=""> 178      @Override                                                                                                     </span>
<span class="3412323497574912500" onmouseenter="enter('3412323497574912500');" onmouseout="out('3412323497574912500');" style=""> 179      public void close() throws Exception {                                                                        </span>
<span class="-2219391834669832598" onmouseenter="enter('-2219391834669832598');" onmouseout="out('-2219391834669832598');" style=""> 180          super.close();                                                                                            </span>
<span class="-7184026876346610625" onmouseenter="enter('-7184026876346610625');" onmouseout="out('-7184026876346610625');" style=""> 181          if (connection != null){                                                                                  </span>
<span class="9071602856049240163" onmouseenter="enter('9071602856049240163');" onmouseout="out('9071602856049240163');" style=""> 182              connection.close();                                                                                   </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 183          }                                                                                                         </span>
<span class="6164738879989582670" onmouseenter="enter('6164738879989582670');" onmouseout="out('6164738879989582670');" style=""> 184          if (redisClient != null){                                                                                 </span>
<span class="1042460770021542858" onmouseenter="enter('1042460770021542858');" onmouseout="out('1042460770021542858');" style=""> 185              redisClient.shutdown();                                                                               </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 186          }                                                                                                         </span>
<span class="2497754811874735258" onmouseenter="enter('2497754811874735258');" onmouseout="out('2497754811874735258');" style=""> 187          if (clusterConnection != null){                                                                           </span>
<span class="5319565162844380714" onmouseenter="enter('5319565162844380714');" onmouseout="out('5319565162844380714');" style=""> 188              clusterConnection.close();                                                                            </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 189          }                                                                                                         </span>
<span class="-6654045604789822312" onmouseenter="enter('-6654045604789822312');" onmouseout="out('-6654045604789822312');" style=""> 190          if (clusterClient != null){                                                                               </span>
<span class="3532968304561516431" onmouseenter="enter('3532968304561516431');" onmouseout="out('3532968304561516431');" style=""> 191              clusterClient.shutdown();                                                                             </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 192          }                                                                                                         </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 193      }                                                                                                             </span>
<span  style=""> 194                                                                                                                    </span>
<span class="-1659227874853751674" onmouseenter="enter('-1659227874853751674');" onmouseout="out('-1659227874853751674');" style=""> 195  }                                                                                                                 </span></pre></td>
                        </tr>
                    </table>
                </div>
              </body>
            </html>
            